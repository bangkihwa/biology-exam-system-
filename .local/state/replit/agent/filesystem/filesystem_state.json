{"file_contents":{"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1080,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/pages/admin-login.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { ShieldCheck, Lock } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nexport default function AdminLoginPage() {\n  const [, setLocation] = useLocation();\n  const [password, setPassword] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const { toast } = useToast();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!password) {\n      toast({\n        title: \"비밀번호를 입력하세요\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      const result = await apiRequest(\"POST\", \"/api/admin/login\", { password });\n      \n      if (result.success) {\n        sessionStorage.setItem(\"admin\", \"true\");\n        toast({\n          title: \"로그인 성공\",\n          description: \"관리자 페이지로 이동합니다.\",\n        });\n        setLocation(\"/admin\");\n      }\n    } catch (error: any) {\n      toast({\n        title: \"로그인 실패\",\n        description: error.message || \"비밀번호가 올바르지 않습니다.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-primary/5 to-accent/10 flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-md shadow-2xl border-2\">\n        <CardHeader className=\"text-center space-y-4\">\n          <div className=\"flex justify-center\">\n            <div className=\"w-20 h-20 rounded-full bg-primary/10 flex items-center justify-center\">\n              <ShieldCheck className=\"w-12 h-12 text-primary\" />\n            </div>\n          </div>\n          <CardTitle className=\"text-3xl font-bold\">관리자 로그인</CardTitle>\n          <CardDescription>\n            관리자 권한이 필요합니다\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\" className=\"flex items-center gap-2\">\n                <Lock className=\"w-4 h-4\" />\n                비밀번호\n              </Label>\n              <Input\n                id=\"password\"\n                type=\"password\"\n                placeholder=\"관리자 비밀번호를 입력하세요\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                disabled={isLoading}\n                className=\"text-lg\"\n                data-testid=\"input-admin-password\"\n                autoFocus\n              />\n            </div>\n            <Button\n              type=\"submit\"\n              className=\"w-full\"\n              size=\"lg\"\n              disabled={isLoading}\n              data-testid=\"button-admin-login\"\n            >\n              {isLoading ? \"확인 중...\" : \"로그인\"}\n            </Button>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":3344,"size_tokens":null},"client/src/pages/test.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useLocation, useParams } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { ChevronLeft, Send, AlertCircle, Camera, Upload } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Question, Exam, SubmitTest } from \"@shared/schema\";\n\nexport default function TestPage() {\n  const { examId } = useParams();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const examIdNum = examId ? parseInt(examId) : null;\n  \n  const studentData = sessionStorage.getItem(\"student\");\n  const student = studentData ? JSON.parse(studentData) : null;\n\n  const [answers, setAnswers] = useState<Record<number, string>>({});\n  const [isScanning, setIsScanning] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    if (!student) {\n      setLocation(\"/\");\n    }\n  }, [student, setLocation]);\n\n  const { data: exam, isLoading: examLoading } = useQuery<Exam>({\n    queryKey: [`/api/exams/${examIdNum}`],\n    enabled: !!examIdNum && !!student,\n  });\n\n  const { data: questions, isLoading: questionsLoading } = useQuery<Question[]>({\n    queryKey: [`/api/exams/${examIdNum}/questions`],\n    enabled: !!examIdNum && !!student,\n  });\n\n  const submitMutation = useMutation({\n    mutationFn: async (data: SubmitTest) => {\n      return await apiRequest(\"POST\", \"/api/test/submit\", data);\n    },\n    onSuccess: (result: any) => {\n      queryClient.invalidateQueries();\n      sessionStorage.setItem(\"testResult\", JSON.stringify(result));\n      \n      // 구글 시트 연동 상태 확인\n      if (result.googleSheets && !result.googleSheets.success) {\n        toast({\n          title: \"⚠️ 구글 시트 연동 실패\",\n          description: result.googleSheets.error || \"시험 결과는 저장되었으나 구글 시트 업로드에 실패했습니다.\",\n          variant: \"destructive\",\n        });\n      }\n      \n      setLocation(\"/result\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"제출 실패\",\n        description: error.message || \"시험 제출 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const multipleChoiceQuestions = questions?.filter(q => q.type === \"객관식\") || [];\n  const answeredCount = Object.keys(answers).length;\n  const totalQuestions = multipleChoiceQuestions.length;\n  const progress = totalQuestions > 0 ? (answeredCount / totalQuestions) * 100 : 0;\n\n  const handleAnswer = (questionNumber: number, option: string) => {\n    const currentAnswer = answers[questionNumber] || \"\";\n    \n    // Toggle option in comma-separated list for multiple answers\n    const answerList = currentAnswer ? currentAnswer.split(',').map(a => a.trim()) : [];\n    const optionIndex = answerList.indexOf(option);\n    \n    if (optionIndex >= 0) {\n      answerList.splice(optionIndex, 1);\n    } else {\n      answerList.push(option);\n    }\n    \n    if (answerList.length > 0) {\n      setAnswers(prev => ({ ...prev, [questionNumber]: answerList.join(',') }));\n    } else {\n      const { [questionNumber]: _, ...rest } = answers;\n      setAnswers(rest);\n    }\n  };\n\n  const isOptionSelected = (questionNumber: number, option: string) => {\n    const currentAnswer = answers[questionNumber] || \"\";\n    const answerList = currentAnswer.split(',').map(a => a.trim());\n    return answerList.includes(option);\n  };\n\n  const handleOMRScan = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // 파일 크기 체크 (10MB)\n    if (file.size > 10 * 1024 * 1024) {\n      toast({\n        title: \"파일 크기 초과\",\n        description: \"10MB 이하의 이미지만 업로드 가능합니다.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsScanning(true);\n\n    try {\n      const formData = new FormData();\n      formData.append(\"image\", file);\n      if (examIdNum) {\n        formData.append(\"examId\", examIdNum.toString());\n      }\n\n      const response = await fetch(\"/api/omr/scan\", {\n        method: \"POST\",\n        body: formData,\n      });\n\n      const result = await response.json();\n\n      if (!result.success) {\n        throw new Error(result.message || \"OMR 스캔에 실패했습니다\");\n      }\n\n      // 스캔된 답안을 기존 답안과 병합 (기존 수동 입력 유지)\n      // 숫자 형식(\"1\", \"2\")을 원 숫자 형식(\"①\", \"②\")으로 변환\n      const convertToCircledNumber = (num: string): string => {\n        const map: Record<string, string> = { \"1\": \"①\", \"2\": \"②\", \"3\": \"③\", \"4\": \"④\", \"5\": \"⑤\" };\n        return map[num] || num;\n      };\n\n      const scannedAnswers: Record<number, string> = {};\n      result.answers.forEach((answer: { questionNumber: number; answer: string }) => {\n        // 쉼표로 구분된 복수 답안 처리 (\"2,3\" → \"②,③\")\n        const convertedAnswer = answer.answer\n          .split(',')\n          .map(a => convertToCircledNumber(a.trim()))\n          .join(',');\n        scannedAnswers[answer.questionNumber] = convertedAnswer;\n      });\n\n      // 기존 답안과 merge (스캔된 답안이 우선하지만 기존 답안도 유지)\n      setAnswers(prev => ({ ...prev, ...scannedAnswers }));\n\n      toast({\n        title: \"OMR 스캔 완료\",\n        description: result.message || `${Object.keys(scannedAnswers).length}개 답안이 인식되었습니다`,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"OMR 스캔 실패\",\n        description: error.message || \"이미지 처리 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsScanning(false);\n      // 파일 입력 초기화\n      if (fileInputRef.current) {\n        fileInputRef.current.value = \"\";\n      }\n    }\n  };\n\n  const handleSubmit = () => {\n    if (answeredCount === 0) {\n      toast({\n        title: \"답안 없음\",\n        description: \"최소 1개 이상의 문제에 답해주세요.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const submitData: SubmitTest = {\n      studentId: student.studentId,\n      studentName: student.studentName,\n      examId: examIdNum!,\n      answers: Object.entries(answers).map(([questionNumber, answer]) => ({\n        questionNumber: parseInt(questionNumber),\n        answer,\n      })),\n    };\n\n    submitMutation.mutate(submitData);\n  };\n\n  if (!student || !examIdNum) {\n    return null;\n  }\n\n  if (examLoading || questionsLoading) {\n    return (\n      <div className=\"min-h-screen bg-background p-4\">\n        <div className=\"container mx-auto max-w-6xl space-y-6\">\n          <Skeleton className=\"h-16 w-full\" />\n          <Skeleton className=\"h-96 w-full\" />\n        </div>\n      </div>\n    );\n  }\n\n  if (multipleChoiceQuestions.length === 0) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n        <Card className=\"max-w-md\">\n          <CardContent className=\"pt-6 text-center space-y-4\">\n            <p>문제를 불러올 수 없습니다.</p>\n            <Button onClick={() => setLocation(\"/units\")}>단원 선택으로 돌아가기</Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"sticky top-0 z-50 border-b bg-card/95 backdrop-blur\">\n        <div className=\"container mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"flex items-center gap-3\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setLocation(`/exams/${exam?.schoolId}`)}\n                data-testid=\"button-back\"\n              >\n                <ChevronLeft className=\"w-4 h-4 mr-2\" />\n                시험 선택\n              </Button>\n              <div>\n                <h1 className=\"text-sm font-bold\">목동에이원과학학원</h1>\n                <p className=\"text-xs font-semibold text-primary\">프리미엄 학습관리 시스템</p>\n              </div>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Badge variant=\"outline\" className=\"font-mono\">\n                {student.studentName}\n              </Badge>\n            </div>\n          </div>\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center justify-between text-sm\">\n              <span className=\"font-medium\">\n                {exam?.schoolName} {exam?.year}년 {exam?.semester}\n              </span>\n              <span className=\"text-muted-foreground font-mono\">\n                {answeredCount} / {totalQuestions}\n              </span>\n            </div>\n            <Progress value={progress} className=\"h-2\" />\n          </div>\n        </div>\n      </header>\n\n      <main className=\"container mx-auto px-4 py-8\">\n        <div className=\"max-w-5xl mx-auto space-y-8\">\n          <Card className=\"bg-amber-50 dark:bg-amber-950/20 border-amber-200 dark:border-amber-800\">\n            <CardContent className=\"p-4 flex items-start gap-3\">\n              <AlertCircle className=\"w-5 h-5 text-amber-600 dark:text-amber-500 mt-0.5\" />\n              <div className=\"text-sm text-amber-900 dark:text-amber-100\">\n                <p className=\"font-medium mb-1\">부분 제출 가능</p>\n                <p className=\"text-amber-800 dark:text-amber-200\">\n                  모든 문제를 풀지 않아도 제출할 수 있습니다. 답하지 않은 문제는 0점 처리됩니다.\n                  복수 정답 문제는 여러 개를 선택할 수 있습니다.\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"shadow-lg\">\n            <CardContent className=\"p-8\">\n              <div className=\"text-center space-y-4 mb-8\">\n                <h1 className=\"text-3xl font-bold\">OMR 답안지</h1>\n                <p className=\"text-muted-foreground\">\n                  객관식 문제의 정답을 선택하세요\n                </p>\n                \n                {/* OMR 스캔 버튼 */}\n                <div className=\"flex flex-col sm:flex-row items-center justify-center gap-3 pt-2\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleOMRScan}\n                    className=\"hidden\"\n                    data-testid=\"input-omr-file\"\n                  />\n                  <Button\n                    variant=\"outline\"\n                    size=\"default\"\n                    onClick={() => fileInputRef.current?.click()}\n                    disabled={isScanning}\n                    className=\"gap-2\"\n                    data-testid=\"button-omr-scan\"\n                  >\n                    {isScanning ? (\n                      <>\n                        <div className=\"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\n                        처리 중...\n                      </>\n                    ) : (\n                      <>\n                        <Camera className=\"w-4 h-4\" />\n                        OMR 사진 찍기\n                      </>\n                    )}\n                  </Button>\n                  <p className=\"text-xs text-muted-foreground\">\n                    종이 답안지를 사진으로 찍어 자동으로 입력하세요\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"space-y-6\">\n                {Array.from({ length: Math.ceil(multipleChoiceQuestions.length / 2) }).map((_, rowIndex) => {\n                  const leftIndex = rowIndex * 2;\n                  const rightIndex = rowIndex * 2 + 1;\n                  const leftQuestion = multipleChoiceQuestions[leftIndex];\n                  const rightQuestion = multipleChoiceQuestions[rightIndex];\n\n                  return (\n                    <div key={rowIndex} className=\"grid md:grid-cols-2 gap-8\">\n                      {leftQuestion && (\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                            <span className=\"font-bold text-lg text-foreground\">\n                              {leftQuestion.questionNumber}번\n                            </span>\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              {leftQuestion.category}\n                            </Badge>\n                            <span className=\"text-xs\">{leftQuestion.unit}</span>\n                          </div>\n                          <div className=\"flex gap-2\">\n                            {['①', '②', '③', '④', '⑤'].map((option, idx) => {\n                              const optionValue = (idx + 1).toString();\n                              const isSelected = isOptionSelected(leftQuestion.questionNumber, option);\n                              return (\n                                <button\n                                  key={option}\n                                  onClick={() => handleAnswer(leftQuestion.questionNumber, option)}\n                                  className={`w-12 h-12 rounded-full border-2 font-medium transition-all hover-elevate ${\n                                    isSelected\n                                      ? \"bg-primary text-primary-foreground border-primary\"\n                                      : \"border-border hover:border-primary/50\"\n                                  }`}\n                                  data-testid={`answer-${leftQuestion.questionNumber}-${optionValue}`}\n                                >\n                                  {option}\n                                </button>\n                              );\n                            })}\n                          </div>\n                        </div>\n                      )}\n\n                      {rightQuestion && (\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                            <span className=\"font-bold text-lg text-foreground\">\n                              {rightQuestion.questionNumber}번\n                            </span>\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              {rightQuestion.category}\n                            </Badge>\n                            <span className=\"text-xs\">{rightQuestion.unit}</span>\n                          </div>\n                          <div className=\"flex gap-2\">\n                            {['①', '②', '③', '④', '⑤'].map((option, idx) => {\n                              const optionValue = (idx + 1).toString();\n                              const isSelected = isOptionSelected(rightQuestion.questionNumber, option);\n                              return (\n                                <button\n                                  key={option}\n                                  onClick={() => handleAnswer(rightQuestion.questionNumber, option)}\n                                  className={`w-12 h-12 rounded-full border-2 font-medium transition-all hover-elevate ${\n                                    isSelected\n                                      ? \"bg-primary text-primary-foreground border-primary\"\n                                      : \"border-border hover:border-primary/50\"\n                                  }`}\n                                  data-testid={`answer-${rightQuestion.questionNumber}-${optionValue}`}\n                                >\n                                  {option}\n                                </button>\n                              );\n                            })}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            </CardContent>\n          </Card>\n\n          <div className=\"flex justify-center\">\n            <Button\n              size=\"lg\"\n              onClick={handleSubmit}\n              disabled={submitMutation.isPending || answeredCount === 0}\n              className=\"px-12\"\n              data-testid=\"button-submit\"\n            >\n              <Send className=\"w-5 h-5 mr-2\" />\n              {submitMutation.isPending ? \"제출 중...\" : `제출하기 (${answeredCount}/${totalQuestions})`}\n            </Button>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":17002,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"design_guidelines.md":{"content":"# Design Guidelines: Mokdong A1 Science Academy Assessment System\n\n## Design Approach\n**System-Based Approach**: Material Design principles adapted for educational clarity, with enhanced data visualization for analytics. Drawing inspiration from Google Classroom's organizational structure and Khan Academy's assessment patterns.\n\n## Core Design Principles\n- **Clarity First**: Information hierarchy prioritizes student task completion and data comprehension\n- **Efficient Navigation**: Minimize clicks between login → unit selection → assessment → results\n- **Data Celebration**: Analytics dashboards use bold visual treatments to highlight achievement\n\n## Typography System\n- **Primary Font**: Inter (via Google Fonts) for UI elements, forms, and navigation\n- **Data Font**: JetBrains Mono for numerical displays, scores, and student IDs\n- **Hierarchy**:\n  - Page titles: text-3xl font-bold\n  - Section headers: text-xl font-semibold\n  - Body text: text-base\n  - Labels/metadata: text-sm\n  - Numerical data: text-2xl font-mono for emphasis\n\n## Layout System\n**Spacing Primitives**: Use Tailwind units of 4, 6, 8, 12, 16 (p-4, gap-6, mb-8, py-12, mt-16)\n- Container: max-w-7xl mx-auto px-4\n- Cards/Panels: p-6 to p-8\n- Form spacing: gap-4 between fields, gap-6 between sections\n- Grid layouts: gap-6 for card grids\n\n## Component Library\n\n### Authentication (Login)\n- Centered card layout (max-w-md mx-auto)\n- School logo/name at top\n- Two input fields: Student ID, Name\n- Large primary button for login\n- Minimal, focused interface\n\n### Unit Selection Dashboard\n- Grid layout: grid-cols-1 md:grid-cols-2 lg:grid-cols-3\n- Unit cards with:\n  - Unit name (prominent heading)\n  - Question count badge\n  - Progress indicator (if applicable)\n  - \"Start Assessment\" button\n- Header showing: Student name, current textbook (물리학 프리미엄)\n\n### OMR Answer Input Interface\n- Split layout:\n  - **Left panel** (sticky): Question navigation grid showing all question numbers (clickable bubbles indicating answered/unanswered status)\n  - **Right panel** (scrollable): Current question display with:\n    - Question number badge\n    - 5-option radio button grid (1-5) styled as large touch-friendly bubbles\n    - \"Skip\" indicator for subjective questions\n    - Next/Previous navigation\n- Progress bar at top showing completion percentage\n- Submit button (prominent) when all multiple choice answered\n\n### Results & Feedback Screen\n- Hero metric card: Large score display with achievement percentage\n- Breakdown section:\n  - Correct/Incorrect count\n  - Questions by unit visualization\n- Answer review: Expandable list showing each question with student answer vs correct answer (icon-based: checkmark/x)\n- Action buttons: \"View Detailed Report\", \"Return to Units\"\n\n### Analytics Dashboard (Reports)\n- Multi-section layout:\n  - **Header**: Student profile card (ID, name, grade)\n  - **Performance Overview**: Large cards showing overall stats (grid-cols-1 md:grid-cols-3)\n  - **Unit Performance**: Horizontal bar chart comparing achievement across units\n  - **Trend Analysis**: Line graph showing performance over time\n  - **Detailed Table**: Sortable data table with all assessment records\n- Filter controls: Dropdown selectors for textbook and unit\n- Export/print functionality in top-right\n\n### Universal Components\n- **Buttons**: \n  - Primary: Solid fill, px-6 py-3, rounded-lg, font-semibold\n  - Secondary: Border style, same padding\n  - Icon buttons: p-2, rounded-full for actions\n- **Cards**: Rounded-xl, shadow-md, border, p-6\n- **Badges**: Rounded-full, px-3 py-1, text-sm for status indicators\n- **Input Fields**: Rounded-lg border, px-4 py-3, focus ring treatment\n- **Data Tables**: Striped rows, hover states, sticky header\n\n## Navigation Pattern\n- Top navigation bar (sticky):\n  - School name/logo (left)\n  - Student name and ID (right)\n  - Logout button\n- Breadcrumb trail for multi-step processes (Unit Selection > Assessment > Results)\n\n## Data Visualization Standards\n- **Charts**: Use Chart.js or similar library\n- Bar charts for unit comparisons (horizontal orientation)\n- Line charts for temporal trends\n- Donut charts for score breakdowns\n- Maintain consistent aspect ratios: 16:9 for main charts, square for summary widgets\n\n## Responsive Behavior\n- Mobile (< 768px): Single column, stacked cards, hamburger navigation\n- Tablet (768-1024px): 2-column grids, maintained spacing\n- Desktop (> 1024px): Full 3-column grids, split panels for OMR interface\n\n## Icons\nUse Heroicons (outline style) via CDN:\n- Academic cap for education\n- Chart bar for analytics\n- Check/X circle for answers\n- Clock for timestamps\n- User for profile\n- Document text for assessments\n\n## Images\nNo hero images required. Focus on functional interface with icon-based visual communication. Optional: School logo in header (240x60px recommended).","path":null,"size_bytes":4837,"size_tokens":null},"client/src/pages/reports.tsx":{"content":"import { useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ChevronLeft, Calendar, FileText, TrendingUp } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport type { Submission, Exam, UnitResult } from \"@shared/schema\";\n\ninterface EnrichedSubmission extends Omit<Submission, 'unitResults'> {\n  exam: Exam;\n  unitResults: UnitResult[];\n}\n\nexport default function ReportsPage() {\n  const [, setLocation] = useLocation();\n  const studentData = sessionStorage.getItem(\"student\");\n  const student = studentData ? JSON.parse(studentData) : null;\n\n  useEffect(() => {\n    if (!student) {\n      setLocation(\"/\");\n    }\n  }, [student, setLocation]);\n\n  const { data: submissions, isLoading } = useQuery<EnrichedSubmission[]>({\n    queryKey: [`/api/submissions/${student?.studentId}`],\n    enabled: !!student,\n  });\n\n  if (!student) {\n    return null;\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background p-4\">\n        <div className=\"container mx-auto max-w-7xl space-y-6\">\n          <Skeleton className=\"h-16 w-full\" />\n          <div className=\"grid md:grid-cols-3 gap-6\">\n            <Skeleton className=\"h-40\" />\n            <Skeleton className=\"h-40\" />\n            <Skeleton className=\"h-40\" />\n          </div>\n          <Skeleton className=\"h-96\" />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-primary/5 to-accent/10\">\n      <header className=\"sticky top-0 z-50 border-b bg-card/95 backdrop-blur\">\n        <div className=\"container mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setLocation(\"/units\")}\n                data-testid=\"button-back-to-units\"\n              >\n                <ChevronLeft className=\"w-4 h-4 mr-2\" />\n                단원 선택\n              </Button>\n              <div>\n                <h1 className=\"text-sm font-bold\">목동에이원과학학원</h1>\n                <p className=\"text-xs font-semibold text-primary\">프리미엄 학습관리 시스템</p>\n              </div>\n            </div>\n            <div className=\"text-right\">\n              <p className=\"text-sm font-medium\">{student.studentName}</p>\n              <p className=\"text-xs text-muted-foreground font-mono\">{student.studentId}</p>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"container mx-auto px-4 py-8 max-w-7xl\">\n        <div className=\"space-y-8\">\n          <div className=\"text-center space-y-2\">\n            <h1 className=\"text-3xl font-bold\">성적 기록</h1>\n            <p className=\"text-muted-foreground\">\n              지금까지 제출한 모든 시험 결과를 확인할 수 있습니다\n            </p>\n          </div>\n\n          {submissions && submissions.length > 0 ? (\n            <div className=\"grid gap-6\">\n              {submissions.map((submission) => {\n                const date = new Date(submission.submittedAt);\n                const getGradeColor = (rate: number) => {\n                  if (rate >= 90) return \"text-green-600 bg-green-500/20 border-green-500\";\n                  if (rate >= 70) return \"text-blue-600 bg-blue-500/20 border-blue-500\";\n                  if (rate >= 50) return \"text-orange-600 bg-orange-500/20 border-orange-500\";\n                  return \"text-red-600 bg-red-500/20 border-red-500\";\n                };\n\n                return (\n                  <Card key={submission.id} className=\"hover-elevate transition-all\">\n                    <CardHeader>\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"space-y-1\">\n                          <CardTitle className=\"text-xl flex items-center gap-2\">\n                            <FileText className=\"w-5 h-5\" />\n                            {submission.exam.schoolName}\n                          </CardTitle>\n                          <p className=\"text-sm text-muted-foreground flex items-center gap-2\">\n                            <Calendar className=\"w-4 h-4\" />\n                            {submission.exam.year}년 {submission.exam.semester} · {format(date, 'yyyy-MM-dd HH:mm')}\n                          </p>\n                        </div>\n                        <div className={`text-center p-4 rounded-lg border-2 ${getGradeColor(submission.achievementRate)}`}>\n                          <div className=\"text-3xl font-bold\">\n                            {submission.achievementRate}\n                          </div>\n                          <div className=\"text-xs\">점</div>\n                        </div>\n                      </div>\n                    </CardHeader>\n                    <CardContent className=\"space-y-4\">\n                      <div className=\"grid grid-cols-3 gap-4\">\n                        <div className=\"text-center p-3 bg-muted rounded-lg\">\n                          <div className=\"text-2xl font-bold\">{submission.correctAnswers}</div>\n                          <div className=\"text-xs text-muted-foreground\">정답</div>\n                        </div>\n                        <div className=\"text-center p-3 bg-muted rounded-lg\">\n                          <div className=\"text-2xl font-bold\">{submission.answeredQuestions}</div>\n                          <div className=\"text-xs text-muted-foreground\">응답</div>\n                        </div>\n                        <div className=\"text-center p-3 bg-muted rounded-lg\">\n                          <div className=\"text-2xl font-bold\">{submission.totalQuestions}</div>\n                          <div className=\"text-xs text-muted-foreground\">전체</div>\n                        </div>\n                      </div>\n\n                      {submission.unitResults && submission.unitResults.length > 0 && (\n                        <div>\n                          <h4 className=\"font-semibold text-sm mb-2 flex items-center gap-2\">\n                            <TrendingUp className=\"w-4 h-4\" />\n                            단원별 성취도\n                          </h4>\n                          <div className=\"flex flex-wrap gap-2\">\n                            {submission.unitResults.map((unit, i) => (\n                              <Badge\n                                key={i}\n                                variant={unit.achievementRate >= 70 ? \"default\" : \"secondary\"}\n                                className=\"text-xs\"\n                              >\n                                {unit.unit}: {unit.achievementRate}%\n                              </Badge>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n                    </CardContent>\n                  </Card>\n                );\n              })}\n            </div>\n          ) : (\n            <Card>\n              <CardContent className=\"pt-12 pb-12 text-center\">\n                <p className=\"text-muted-foreground text-lg mb-4\">\n                  아직 제출한 시험이 없습니다\n                </p>\n                <Button onClick={() => setLocation(\"/schools\")} data-testid=\"button-start-test\">\n                  시험 시작하기\n                </Button>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":7759,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 210 4% 98%;\n  --foreground: 210 6% 12%;\n  --border: 210 4% 90%;\n  --card: 210 4% 96%;\n  --card-foreground: 210 6% 14%;\n  --card-border: 210 4% 92%;\n  --sidebar: 210 4% 94%;\n  --sidebar-foreground: 210 6% 16%;\n  --sidebar-border: 210 4% 88%;\n  --sidebar-primary: 217 91% 48%;\n  --sidebar-primary-foreground: 217 91% 98%;\n  --sidebar-accent: 210 6% 86%;\n  --sidebar-accent-foreground: 210 8% 20%;\n  --sidebar-ring: 217 91% 48%;\n  --popover: 210 4% 92%;\n  --popover-foreground: 210 6% 18%;\n  --popover-border: 210 4% 86%;\n  --primary: 217 91% 48%;\n  --primary-foreground: 217 91% 98%;\n  --secondary: 210 6% 84%;\n  --secondary-foreground: 210 8% 22%;\n  --muted: 210 6% 88%;\n  --muted-foreground: 210 8% 38%;\n  --accent: 210 8% 86%;\n  --accent-foreground: 210 10% 24%;\n  --destructive: 0 84% 48%;\n  --destructive-foreground: 0 84% 98%;\n  --input: 210 8% 75%;\n  --ring: 217 91% 48%;\n  --chart-1: 217 91% 42%;\n  --chart-2: 195 88% 38%;\n  --chart-3: 142 76% 36%;\n  --chart-4: 280 82% 42%;\n  --chart-5: 24 95% 40%;\n  --font-sans: Open Sans, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: .5rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(210 10% 50% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(210 10% 50% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(210 10% 50% / 0.00), 0px 1px 2px -1px hsl(210 10% 50% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(210 10% 50% / 0.00), 0px 1px 2px -1px hsl(210 10% 50% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(210 10% 50% / 0.00), 0px 2px 4px -1px hsl(210 10% 50% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(210 10% 50% / 0.00), 0px 4px 6px -1px hsl(210 10% 50% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(210 10% 50% / 0.00), 0px 8px 10px -1px hsl(210 10% 50% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(210 10% 50% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 210 6% 8%;\n  --foreground: 210 6% 94%;\n  --border: 210 6% 18%;\n  --card: 210 6% 10%;\n  --card-foreground: 210 6% 92%;\n  --card-border: 210 6% 14%;\n  --sidebar: 210 6% 12%;\n  --sidebar-foreground: 210 6% 90%;\n  --sidebar-border: 210 6% 16%;\n  --sidebar-primary: 217 91% 58%;\n  --sidebar-primary-foreground: 217 91% 98%;\n  --sidebar-accent: 210 8% 20%;\n  --sidebar-accent-foreground: 210 8% 88%;\n  --sidebar-ring: 217 91% 58%;\n  --popover: 210 6% 14%;\n  --popover-foreground: 210 6% 88%;\n  --popover-border: 210 6% 20%;\n  --primary: 217 91% 52%;\n  --primary-foreground: 217 91% 98%;\n  --secondary: 210 8% 22%;\n  --secondary-foreground: 210 8% 86%;\n  --muted: 210 8% 18%;\n  --muted-foreground: 210 8% 68%;\n  --accent: 210 10% 20%;\n  --accent-foreground: 210 10% 84%;\n  --destructive: 0 84% 48%;\n  --destructive-foreground: 0 84% 98%;\n  --input: 210 10% 32%;\n  --ring: 217 91% 58%;\n  --chart-1: 217 91% 68%;\n  --chart-2: 195 88% 65%;\n  --chart-3: 142 76% 62%;\n  --chart-4: 280 82% 68%;\n  --chart-5: 24 95% 64%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(210 10% 10% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(210 10% 10% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(210 10% 10% / 0.00), 0px 1px 2px -1px hsl(210 10% 10% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(210 10% 10% / 0.00), 0px 1px 2px -1px hsl(210 10% 10% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(210 10% 10% / 0.00), 0px 2px 4px -1px hsl(210 10% 10% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(210 10% 10% / 0.00), 0px 4px 6px -1px hsl(210 10% 10% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(210 10% 10% / 0.00), 0px 8px 10px -1px hsl(210 10% 10% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(210 10% 10% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","path":null,"size_bytes":10738,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":2263,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"server/db.ts":{"content":"import { drizzle } from 'drizzle-orm/node-postgres';\nimport pg from 'pg';\nimport * as schema from \"@shared/schema\";\n\nconst { Pool } = pg;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ \n  connectionString: process.env.DATABASE_URL,\n  ssl: {\n    rejectUnauthorized: false\n  }\n});\n\nexport const db = drizzle(pool, { schema });\n","path":null,"size_bytes":443,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":844,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","path":null,"size_bytes":2210,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5741,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport LoginPage from \"@/pages/login\";\nimport SchoolsPage from \"@/pages/schools\";\nimport ExamsPage from \"@/pages/exams\";\nimport TestPage from \"@/pages/test\";\nimport UnitTestPage from \"@/pages/unit-test\";\nimport ResultPage from \"@/pages/result\";\nimport ReportsPage from \"@/pages/reports\";\nimport UnitsPage from \"@/pages/units\";\nimport AdminLoginPage from \"@/pages/admin-login\";\nimport AdminPage from \"@/pages/admin\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={LoginPage} />\n      <Route path=\"/units\" component={UnitsPage} />\n      <Route path=\"/test/unit/:unit\" component={UnitTestPage} />\n      <Route path=\"/schools\" component={SchoolsPage} />\n      <Route path=\"/exams/:schoolId\" component={ExamsPage} />\n      <Route path=\"/test/:examId\" component={TestPage} />\n      <Route path=\"/result\" component={ResultPage} />\n      <Route path=\"/reports\" component={ReportsPage} />\n      <Route path=\"/admin/login\" component={AdminLoginPage} />\n      <Route path=\"/admin\" component={AdminPage} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nexport default function App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Router />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n","path":null,"size_bytes":1599,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2359,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1202,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { GraduationCap } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport type { Login } from \"@shared/schema\";\n\nexport default function LoginPage() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [formData, setFormData] = useState({\n    studentId: \"\",\n    studentName: \"\",\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (data: Login) => {\n      return await apiRequest<{ success: boolean; student: any }>(\n        \"POST\",\n        \"/api/auth/login\",\n        data\n      );\n    },\n    onSuccess: (data) => {\n      if (data.success) {\n        sessionStorage.setItem(\"student\", JSON.stringify(data.student));\n        queryClient.invalidateQueries();\n        toast({\n          title: \"로그인 성공\",\n          description: `${data.student.studentName}님, 환영합니다!`,\n        });\n        setLocation(\"/units\");\n      }\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"로그인 실패\",\n        description: error.message || \"학생 ID와 이름을 확인해주세요.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!formData.studentId.trim() || !formData.studentName.trim()) {\n      toast({\n        title: \"입력 오류\",\n        description: \"학생 ID와 이름을 모두 입력해주세요.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    loginMutation.mutate(formData);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-primary/5 via-background to-accent/5 flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-md shadow-xl\">\n        <CardHeader className=\"space-y-6 text-center pb-8\">\n          <div className=\"flex justify-center\">\n            <div className=\"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center\">\n              <GraduationCap className=\"w-9 h-9 text-primary\" />\n            </div>\n          </div>\n          <div className=\"space-y-2\">\n            <CardTitle className=\"text-3xl font-bold\">목동에이원과학학원</CardTitle>\n            <CardDescription className=\"text-base font-semibold text-primary\">\n              프리미엄 학습관리 시스템\n            </CardDescription>\n            <CardDescription className=\"text-sm\">\n              중등 통합과학 선행 - 런지 교재\n            </CardDescription>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"studentId\" className=\"text-base font-medium\">\n                  학생 ID\n                </Label>\n                <Input\n                  id=\"studentId\"\n                  data-testid=\"input-student-id\"\n                  type=\"text\"\n                  placeholder=\"예: h01001\"\n                  value={formData.studentId}\n                  onChange={(e) =>\n                    setFormData({ ...formData, studentId: e.target.value })\n                  }\n                  className=\"h-12 text-base\"\n                  disabled={loginMutation.isPending}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"studentName\" className=\"text-base font-medium\">\n                  이름\n                </Label>\n                <Input\n                  id=\"studentName\"\n                  data-testid=\"input-student-name\"\n                  type=\"text\"\n                  placeholder=\"예: 홍길동\"\n                  value={formData.studentName}\n                  onChange={(e) =>\n                    setFormData({ ...formData, studentName: e.target.value })\n                  }\n                  className=\"h-12 text-base\"\n                  disabled={loginMutation.isPending}\n                />\n              </div>\n            </div>\n\n            <Button\n              type=\"submit\"\n              data-testid=\"button-login\"\n              className=\"w-full h-12 text-base font-semibold\"\n              disabled={loginMutation.isPending}\n            >\n              {loginMutation.isPending ? \"로그인 중...\" : \"로그인\"}\n            </Button>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":4775,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { loginSchema, submitTestSchema, submitUnitTestSchema, type UnitResult } from \"@shared/schema\";\nimport { readExamDataFromSheet, writeExamDataToSheet, writeStudentResultToSheet, readResultsFromSheet, readAllResultsFromSheet } from \"./googleSheets\";\nimport multer from \"multer\";\nimport { spawn } from \"child_process\";\nimport path from \"path\";\nimport fs from \"fs\";\n\nconst SPREADSHEET_ID = \"1Mi70D_RLWqSCqmlCl2t_yUfdiByF1ExXkLrn7SQcv7k\";\n\n// 원문자를 숫자로 변환하는 함수\nfunction circleToNumber(answer: string): string {\n  const circleMap: { [key: string]: string } = {\n    \"①\": \"1\", \"②\": \"2\", \"③\": \"3\", \"④\": \"4\", \"⑤\": \"5\",\n    \"⑥\": \"6\", \"⑦\": \"7\", \"⑧\": \"8\", \"⑨\": \"9\", \"⑩\": \"10\",\n  };\n  return circleMap[answer] || answer;\n}\n\n// 답안 비교를 위한 정규화 함수\nfunction normalizeAnswer(answer: string | undefined | null): string {\n  if (!answer) return \"\";\n  // 원문자를 숫자로 변환\n  let normalized = circleToNumber(answer.trim());\n  // 앞뒤 공백 제거\n  return normalized;\n}\n\n// Multer 설정 - OMR 이미지 업로드용\nconst upload = multer({\n  dest: \"uploads/\",\n  limits: {\n    fileSize: 10 * 1024 * 1024, // 10MB 제한\n  },\n  fileFilter: (req, file, cb) => {\n    // 이미지 파일만 허용\n    if (file.mimetype.startsWith(\"image/\")) {\n      cb(null, true);\n    } else {\n      cb(new Error(\"이미지 파일만 업로드 가능합니다\"));\n    }\n  },\n});\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Login endpoint\n  app.post(\"/api/auth/login\", async (req, res) => {\n    try {\n      const { studentId, studentName } = loginSchema.parse(req.body);\n      \n      const student = await storage.getStudentByCredentials(studentId, studentName);\n      \n      if (!student) {\n        return res.status(401).json({\n          success: false,\n          message: \"학생 ID 또는 이름이 일치하지 않습니다.\",\n        });\n      }\n\n      return res.json({\n        success: true,\n        student: {\n          studentId: student.studentId,\n          studentName: student.studentName,\n          grade: student.grade,\n          phone: student.phone,\n        },\n      });\n    } catch (error: any) {\n      return res.status(400).json({\n        success: false,\n        message: error.message || \"로그인 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Get all schools\n  app.get(\"/api/schools\", async (req, res) => {\n    try {\n      const schools = await storage.getAllSchools();\n      return res.json(schools);\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"학교 목록을 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Get exams by school\n  app.get(\"/api/schools/:schoolId/exams\", async (req, res) => {\n    try {\n      const schoolId = parseInt(req.params.schoolId);\n      const exams = await storage.getExamsBySchool(schoolId);\n      return res.json(exams);\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"시험 목록을 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Get all exams\n  app.get(\"/api/exams\", async (req, res) => {\n    try {\n      const exams = await storage.getAllExams();\n      return res.json(exams);\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"시험 목록을 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Get exam by id\n  app.get(\"/api/exams/:examId\", async (req, res) => {\n    try {\n      const examId = parseInt(req.params.examId);\n      const exam = await storage.getExamById(examId);\n      \n      if (!exam) {\n        return res.status(404).json({\n          message: \"시험을 찾을 수 없습니다.\",\n        });\n      }\n      \n      return res.json(exam);\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"시험을 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Get questions by exam\n  app.get(\"/api/exams/:examId/questions\", async (req, res) => {\n    try {\n      const examId = parseInt(req.params.examId);\n      const questions = await storage.getQuestionsByExam(examId);\n      return res.json(questions);\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"문제를 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Get questions by unit\n  app.get(\"/api/units/:unit/questions\", async (req, res) => {\n    try {\n      const unit = decodeURIComponent(req.params.unit);\n      const questions = await storage.getQuestionsByUnit(unit);\n      return res.json(questions);\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"문제를 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Get question counts by unit\n  app.get(\"/api/questions/counts\", async (req, res) => {\n    try {\n      const allQuestions = await storage.getAllQuestions();\n      const counts: Record<string, number> = {};\n      for (const q of allQuestions) {\n        if (q.unit) {\n          counts[q.unit] = (counts[q.unit] || 0) + 1;\n        }\n      }\n      return res.json(counts);\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"문제 수를 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // OMR 이미지 스캔 엔드포인트\n  app.post(\"/api/omr/scan\", upload.single(\"image\"), async (req, res) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({\n          success: false,\n          message: \"이미지 파일이 업로드되지 않았습니다\",\n        });\n      }\n\n      const examId = req.body.examId ? parseInt(req.body.examId) : null;\n      let totalQuestions = 30; // 기본값\n\n      // 시험 ID가 제공된 경우 실제 문제 수 확인\n      if (examId) {\n        const questions = await storage.getQuestionsByExam(examId);\n        const multipleChoiceQuestions = questions.filter(q => q.type === \"객관식\");\n        totalQuestions = multipleChoiceQuestions.length;\n      }\n\n      const imagePath = req.file.path;\n\n      // Python 스크립트 실행\n      const pythonProcess = spawn(\"python3\", [\n        path.join(process.cwd(), \"server\", \"omr_process.py\"),\n        imagePath,\n        totalQuestions.toString(),\n      ]);\n\n      let outputData = \"\";\n      let errorData = \"\";\n\n      pythonProcess.stdout.on(\"data\", (data) => {\n        outputData += data.toString();\n      });\n\n      pythonProcess.stderr.on(\"data\", (data) => {\n        errorData += data.toString();\n      });\n\n      // Python 프로세스 실행 에러 처리\n      pythonProcess.on(\"error\", (error) => {\n        console.error(\"Python 프로세스 실행 실패:\", error);\n        \n        // 임시 파일 삭제\n        fs.unlink(imagePath, (err) => {\n          if (err) console.error(\"임시 파일 삭제 실패:\", err);\n        });\n\n        return res.status(500).json({\n          success: false,\n          message: \"OMR 처리 프로그램을 실행할 수 없습니다\",\n          error: error.message,\n        });\n      });\n\n      pythonProcess.on(\"close\", (code) => {\n        // 임시 파일 삭제\n        fs.unlink(imagePath, (err) => {\n          if (err) console.error(\"임시 파일 삭제 실패:\", err);\n        });\n\n        if (code !== 0) {\n          console.error(\"Python 스크립트 오류:\", errorData);\n          return res.status(500).json({\n            success: false,\n            message: \"OMR 이미지 처리 중 오류가 발생했습니다\",\n            error: errorData,\n          });\n        }\n\n        try {\n          const result = JSON.parse(outputData);\n          \n          if (!result.success) {\n            return res.status(400).json({\n              success: false,\n              message: result.message || \"OMR 인식에 실패했습니다\",\n              error: result.error,\n            });\n          }\n\n          // 답안 형식 변환: {1: \"2\", 2: \"3,4\"} -> [{questionNumber: 1, answer: \"2\"}, ...]\n          const answers = Object.entries(result.answers).map(([questionNumber, answer]) => ({\n            questionNumber: parseInt(questionNumber),\n            answer: answer as string,\n          }));\n\n          return res.json({\n            success: true,\n            answers,\n            message: result.message,\n          });\n        } catch (parseError: any) {\n          console.error(\"JSON 파싱 오류:\", parseError);\n          return res.status(500).json({\n            success: false,\n            message: \"결과 처리 중 오류가 발생했습니다\",\n            error: parseError.message,\n          });\n        }\n      });\n    } catch (error: any) {\n      // 에러 발생 시 업로드된 파일 삭제\n      if (req.file) {\n        fs.unlink(req.file.path, (err) => {\n          if (err) console.error(\"파일 삭제 실패:\", err);\n        });\n      }\n\n      return res.status(500).json({\n        success: false,\n        message: error.message || \"OMR 스캔 중 오류가 발생했습니다\",\n      });\n    }\n  });\n\n  // Submit test\n  app.post(\"/api/test/submit\", async (req, res) => {\n    try {\n      const { studentId, studentName, examId, answers } = submitTestSchema.parse(req.body);\n      \n      const questions = await storage.getQuestionsByExam(examId);\n      const exam = await storage.getExamById(examId);\n      \n      if (!exam) {\n        return res.status(404).json({\n          message: \"시험을 찾을 수 없습니다.\",\n        });\n      }\n\n      const multipleChoiceQuestions = questions.filter(q => q.type === \"객관식\");\n      const totalQuestions = multipleChoiceQuestions.length;\n      const answeredQuestions = answers.length;\n      \n      let correctAnswers = 0;\n      const unitMap = new Map<string, UnitResult>();\n\n      // Initialize unit results\n      multipleChoiceQuestions.forEach(q => {\n        const key = `${q.category}|${q.unit}`;\n        if (!unitMap.has(key)) {\n          unitMap.set(key, {\n            category: q.category,\n            unit: q.unit,\n            total: 0,\n            correct: 0,\n            wrong: 0,\n            unanswered: 0,\n            achievementRate: 0,\n          });\n        }\n        const unitResult = unitMap.get(key)!;\n        unitResult.total++;\n      });\n\n      // Process answers\n      const details = multipleChoiceQuestions.map(question => {\n        const studentAnswer = answers.find(a => a.questionNumber === question.questionNumber);\n        let isCorrect = false;\n\n        if (studentAnswer) {\n          // Parse correct answer from database (handle both JSON array and plain string formats)\n          let correctAnswerArray: string[];\n          try {\n            // Try parsing as JSON first\n            const parsed = JSON.parse(question.answer);\n            // Only use parsed result if it's an array, otherwise treat as plain string\n            correctAnswerArray = Array.isArray(parsed) ? parsed.map(String) : [String(parsed)];\n          } catch {\n            // If parsing fails, treat as plain string (e.g., \"③\")\n            correctAnswerArray = [question.answer];\n          }\n          \n          // Handle multiple answers\n          if (question.isMultipleAnswer) {\n            const studentAnswerList = studentAnswer.answer.split(',').map(a => normalizeAnswer(a)).sort();\n            const correctAnswerList = correctAnswerArray.map(a => normalizeAnswer(a)).sort();\n            isCorrect = JSON.stringify(studentAnswerList) === JSON.stringify(correctAnswerList);\n          } else {\n            // Single answer: compare first element of correct answer array with student answer (normalize both)\n            isCorrect = normalizeAnswer(correctAnswerArray[0]) === normalizeAnswer(studentAnswer.answer);\n          }\n\n          if (isCorrect) {\n            correctAnswers++;\n          }\n        }\n\n        // Update unit results\n        const key = `${question.category}|${question.unit}`;\n        const unitResult = unitMap.get(key)!;\n        \n        if (studentAnswer) {\n          if (isCorrect) {\n            unitResult.correct++;\n          } else {\n            unitResult.wrong++;\n          }\n        } else {\n          unitResult.unanswered++;\n        }\n\n        return {\n          questionNumber: question.questionNumber,\n          studentAnswer: studentAnswer?.answer || \"\",\n          correctAnswer: question.answer,\n          isCorrect,\n          isMultipleAnswer: question.isMultipleAnswer,\n        };\n      });\n\n      // Calculate achievement rates for units (based on answered questions only)\n      // Filter out units with no answered questions\n      const unitResults: UnitResult[] = Array.from(unitMap.values())\n        .filter(unit => {\n          const unitAnswered = unit.correct + unit.wrong;\n          return unitAnswered > 0;\n        })\n        .map(unit => {\n          const unitAnswered = unit.correct + unit.wrong;\n          return {\n            ...unit,\n            achievementRate: Math.round((unit.correct * 100) / unitAnswered),\n          };\n        });\n\n      // Calculate overall achievement rate and score (based on answered questions only)\n      const achievementRate = answeredQuestions > 0 \n        ? Math.round((correctAnswers * 100) / answeredQuestions)\n        : 0;\n\n      const score = answeredQuestions > 0\n        ? Math.round((correctAnswers * 100) / answeredQuestions)\n        : 0;\n\n      const submission = await storage.createSubmission({\n        studentId,\n        studentName,\n        examId,\n        answers: JSON.stringify(answers),\n        score,\n        totalQuestions,\n        answeredQuestions,\n        correctAnswers,\n        achievementRate,\n        unitResults: JSON.stringify(unitResults),\n      });\n\n      // Write result to Google Sheets (시트2, 시트3)\n      let googleSheetsSuccess = false;\n      let googleSheetsError = null;\n      \n      try {\n        await writeStudentResultToSheet(SPREADSHEET_ID, {\n          studentId,\n          studentName,\n          exam,\n          score,\n          achievementRate,\n          unitResults,\n          submittedAt: submission.submittedAt,\n        });\n        console.log('✅ Wrote student result to Google Sheets (시트2, 시트3)');\n        googleSheetsSuccess = true;\n      } catch (sheetError: any) {\n        console.error('❌ Failed to write to Google Sheets:', sheetError);\n        googleSheetsError = sheetError.message || '구글 시트 연동 실패';\n        // Continue even if Google Sheets fails\n      }\n\n      return res.json({\n        submissionId: submission.id,\n        examId,\n        score,\n        totalQuestions,\n        answeredQuestions,\n        correctAnswers,\n        achievementRate,\n        unitResults,\n        details,\n        googleSheets: {\n          success: googleSheetsSuccess,\n          error: googleSheetsError,\n        },\n      });\n    } catch (error: any) {\n      console.error('Submit test error:', error);\n      return res.status(400).json({\n        message: error.message || \"시험 제출 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Unit test submission (단원별 과제 제출)\n  app.post(\"/api/unit-tests/submit\", async (req, res) => {\n    try {\n      const { studentId, studentName, unitName, answers } = submitUnitTestSchema.parse(req.body);\n      \n      const questions = await storage.getQuestionsByUnit(unitName);\n      \n      if (questions.length === 0) {\n        return res.status(404).json({\n          message: \"해당 단원의 문제를 찾을 수 없습니다.\",\n        });\n      }\n\n      const multipleChoiceQuestions = questions.filter(q => q.type === \"객관식\");\n      const totalQuestions = multipleChoiceQuestions.length;\n      const answeredQuestions = answers.length;\n      \n      let correctAnswers = 0;\n      const unitMap = new Map<string, UnitResult>();\n\n      unitMap.set(unitName, {\n        category: questions[0]?.category || \"\",\n        unit: unitName,\n        total: totalQuestions,\n        correct: 0,\n        wrong: 0,\n        unanswered: 0,\n        achievementRate: 0,\n      });\n\n      const details = multipleChoiceQuestions.map(question => {\n        const studentAnswer = answers.find((a: { questionNumber: number; answer: string }) => a.questionNumber === question.questionNumber);\n        let isCorrect = false;\n\n        if (studentAnswer) {\n          let correctAnswerArray: string[];\n          try {\n            const parsed = JSON.parse(question.answer);\n            // Only use parsed result if it's an array, otherwise treat as plain string\n            correctAnswerArray = Array.isArray(parsed) ? parsed.map(String) : [String(parsed)];\n          } catch {\n            correctAnswerArray = [question.answer];\n          }\n          \n          const normalizedStudentAnswer = normalizeAnswer(studentAnswer.answer);\n          const normalizedCorrectAnswer = normalizeAnswer(correctAnswerArray[0]);\n          \n          if (question.isMultipleAnswer) {\n            const studentAnswerList = studentAnswer.answer.split(',').map((a: string) => normalizeAnswer(a)).sort();\n            const correctAnswerList = correctAnswerArray.map((a: string) => normalizeAnswer(a)).sort();\n            isCorrect = JSON.stringify(studentAnswerList) === JSON.stringify(correctAnswerList);\n          } else {\n            isCorrect = normalizedCorrectAnswer === normalizedStudentAnswer;\n          }\n\n          if (isCorrect) {\n            correctAnswers++;\n          }\n        }\n\n        const unitResult = unitMap.get(unitName)!;\n        if (studentAnswer) {\n          if (isCorrect) {\n            unitResult.correct++;\n          } else {\n            unitResult.wrong++;\n          }\n        } else {\n          unitResult.unanswered++;\n        }\n\n        return {\n          questionNumber: question.questionNumber,\n          studentAnswer: studentAnswer?.answer || \"\",\n          correctAnswer: question.answer,\n          isCorrect,\n          isMultipleAnswer: question.isMultipleAnswer,\n        };\n      });\n\n      const unitResults: UnitResult[] = Array.from(unitMap.values()).map(unit => ({\n        ...unit,\n        achievementRate: answeredQuestions > 0 ? Math.round((unit.correct * 100) / answeredQuestions) : 0,\n      }));\n\n      const achievementRate = answeredQuestions > 0 \n        ? Math.round((correctAnswers * 100) / answeredQuestions)\n        : 0;\n\n      const score = achievementRate;\n\n      const allExams = await storage.getAllExams();\n      const runjiExam = allExams.find(e => e.subject === '중등 통합과학 선행');\n      const examId = runjiExam?.id || 0;\n\n      const submission = await storage.createSubmission({\n        studentId,\n        studentName,\n        examId,\n        answers: JSON.stringify(answers),\n        score,\n        totalQuestions,\n        answeredQuestions,\n        correctAnswers,\n        achievementRate,\n        unitResults: JSON.stringify(unitResults),\n      });\n\n      return res.json({\n        submissionId: submission.id,\n        unitName,\n        score,\n        totalQuestions,\n        answeredQuestions,\n        correctAnswers,\n        achievementRate,\n        unitResults,\n        details,\n      });\n    } catch (error: any) {\n      console.error('Unit test submit error:', error);\n      return res.status(400).json({\n        message: error.message || \"과제 제출 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Get student submissions\n  app.get(\"/api/submissions/:studentId\", async (req, res) => {\n    try {\n      const { studentId } = req.params;\n      const submissions = await storage.getSubmissionsByStudent(studentId);\n      \n      // Enhance with exam details\n      const enrichedSubmissions = await Promise.all(\n        submissions.map(async (submission) => {\n          const exam = await storage.getExamById(submission.examId);\n          return {\n            ...submission,\n            exam,\n            unitResults: JSON.parse(submission.unitResults) as UnitResult[],\n          };\n        })\n      );\n      \n      return res.json(enrichedSubmissions);\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"제출 기록을 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Get unit statistics for an exam (평균 및 최고 성적)\n  app.get(\"/api/exams/:examId/unit-stats\", async (req, res) => {\n    try {\n      const examId = parseInt(req.params.examId);\n      const submissions = await storage.getSubmissionsByExam(examId);\n      \n      if (submissions.length === 0) {\n        return res.json([]);\n      }\n\n      // Parse all unit results\n      const allUnitResults = submissions.flatMap(sub => \n        JSON.parse(sub.unitResults) as UnitResult[]\n      );\n\n      // Group by category and unit\n      const unitMap = new Map<string, { \n        category: string; \n        unit: string; \n        scores: number[];\n      }>();\n\n      allUnitResults.forEach(unitResult => {\n        const key = `${unitResult.category}|${unitResult.unit}`;\n        if (!unitMap.has(key)) {\n          unitMap.set(key, {\n            category: unitResult.category,\n            unit: unitResult.unit,\n            scores: []\n          });\n        }\n        unitMap.get(key)!.scores.push(unitResult.achievementRate);\n      });\n\n      // Calculate statistics\n      const stats = Array.from(unitMap.values()).map(({ category, unit, scores }) => {\n        const average = scores.length > 0 \n          ? Math.round(scores.reduce((a, b) => a + b, 0) / scores.length)\n          : 0;\n        const highest = scores.length > 0 ? Math.max(...scores) : 0;\n        \n        return {\n          category,\n          unit,\n          average,\n          highest,\n          studentCount: scores.length\n        };\n      });\n\n      return res.json(stats);\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"단원별 통계를 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Initialize data for 중등 통합과학 선행 (런지 교재)\n  app.post(\"/api/init-data\", async (req, res) => {\n    try {\n      const { force } = req.body || {};\n      \n      const existingExams = await storage.getAllExams();\n      if (existingExams.length > 0 && !force) {\n        return res.json({\n          message: \"데이터가 이미 존재합니다. force: true를 전송하면 기존 데이터를 삭제하고 새로 초기화합니다.\",\n          examCount: existingExams.length,\n        });\n      }\n\n      // force 모드일 경우 기존 데이터 삭제\n      if (force) {\n        await storage.deleteAllSubmissions();\n        await storage.deleteAllQuestions();\n        await storage.deleteAllExams();\n        await storage.deleteAllSchools();\n      }\n\n      // 런지 교재 정답 데이터 (중등 통합과학 선행)\n      const runjiAnswers: { questionNumber: number; unit: string; type: string; answer: string }[] = [\n        // 1~37번: 물질의 규칙성과 결합\n        { questionNumber: 1, unit: '물질의 규칙성과 결합', type: '객관식', answer: '2' },\n        { questionNumber: 2, unit: '물질의 규칙성과 결합', type: '객관식', answer: '4' },\n        { questionNumber: 3, unit: '물질의 규칙성과 결합', type: '객관식', answer: '4' },\n        { questionNumber: 4, unit: '물질의 규칙성과 결합', type: '객관식', answer: '4' },\n        { questionNumber: 5, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 6, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 7, unit: '물질의 규칙성과 결합', type: '객관식', answer: '3' },\n        { questionNumber: 8, unit: '물질의 규칙성과 결합', type: '객관식', answer: '4' },\n        { questionNumber: 9, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 10, unit: '물질의 규칙성과 결합', type: '객관식', answer: '3' },\n        { questionNumber: 11, unit: '물질의 규칙성과 결합', type: '객관식', answer: '3' },\n        { questionNumber: 12, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 13, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 14, unit: '물질의 규칙성과 결합', type: '객관식', answer: '1' },\n        { questionNumber: 15, unit: '물질의 규칙성과 결합', type: '객관식', answer: '4' },\n        { questionNumber: 16, unit: '물질의 규칙성과 결합', type: '객관식', answer: '3' },\n        { questionNumber: 17, unit: '물질의 규칙성과 결합', type: '객관식', answer: '4' },\n        { questionNumber: 18, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 19, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 20, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 21, unit: '물질의 규칙성과 결합', type: '객관식', answer: '3' },\n        { questionNumber: 22, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 23, unit: '물질의 규칙성과 결합', type: '객관식', answer: '3' },\n        { questionNumber: 24, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 25, unit: '물질의 규칙성과 결합', type: '객관식', answer: '3' },\n        { questionNumber: 26, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 27, unit: '물질의 규칙성과 결합', type: '객관식', answer: '2' },\n        { questionNumber: 28, unit: '물질의 규칙성과 결합', type: '객관식', answer: '4' },\n        { questionNumber: 29, unit: '물질의 규칙성과 결합', type: '객관식', answer: '3' },\n        { questionNumber: 30, unit: '물질의 규칙성과 결합', type: '객관식', answer: '2' },\n        { questionNumber: 31, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 32, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 33, unit: '물질의 규칙성과 결합', type: '객관식', answer: '4' },\n        { questionNumber: 34, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 35, unit: '물질의 규칙성과 결합', type: '객관식', answer: '4' },\n        { questionNumber: 36, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        { questionNumber: 37, unit: '물질의 규칙성과 결합', type: '객관식', answer: '5' },\n        // 38~55번: 생명체 구성 물질\n        { questionNumber: 38, unit: '생명체 구성 물질', type: '객관식', answer: '5' },\n        { questionNumber: 39, unit: '생명체 구성 물질', type: '객관식', answer: '4' },\n        { questionNumber: 40, unit: '생명체 구성 물질', type: '객관식', answer: '5' },\n        { questionNumber: 41, unit: '생명체 구성 물질', type: '객관식', answer: '5' },\n        { questionNumber: 42, unit: '생명체 구성 물질', type: '객관식', answer: '3' },\n        { questionNumber: 43, unit: '생명체 구성 물질', type: '객관식', answer: '4' },\n        { questionNumber: 44, unit: '생명체 구성 물질', type: '객관식', answer: '5' },\n        { questionNumber: 45, unit: '생명체 구성 물질', type: '객관식', answer: '4' },\n        { questionNumber: 46, unit: '생명체 구성 물질', type: '객관식', answer: '5' },\n        { questionNumber: 47, unit: '생명체 구성 물질', type: '객관식', answer: '4' },\n        { questionNumber: 48, unit: '생명체 구성 물질', type: '객관식', answer: '5' },\n        { questionNumber: 49, unit: '생명체 구성 물질', type: '객관식', answer: '5' },\n        { questionNumber: 50, unit: '생명체 구성 물질', type: '객관식', answer: '4' },\n        { questionNumber: 51, unit: '생명체 구성 물질', type: '객관식', answer: '4' },\n        { questionNumber: 52, unit: '생명체 구성 물질', type: '객관식', answer: '5' },\n        { questionNumber: 53, unit: '생명체 구성 물질', type: '객관식', answer: '5' },\n        { questionNumber: 54, unit: '생명체 구성 물질', type: '객관식', answer: '3' },\n        { questionNumber: 55, unit: '생명체 구성 물질', type: '객관식', answer: '3' },\n        // 56~77번: 물질의 전기적 성질\n        { questionNumber: 56, unit: '물질의 전기적 성질', type: '객관식', answer: '3' },\n        { questionNumber: 57, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 58, unit: '물질의 전기적 성질', type: '객관식', answer: '4' },\n        { questionNumber: 59, unit: '물질의 전기적 성질', type: '객관식', answer: '4' },\n        { questionNumber: 60, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 61, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 62, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 63, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 64, unit: '물질의 전기적 성질', type: '객관식', answer: '3' },\n        { questionNumber: 65, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 66, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 67, unit: '물질의 전기적 성질', type: '객관식', answer: '4' },\n        { questionNumber: 68, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 69, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 70, unit: '물질의 전기적 성질', type: '객관식', answer: '3' },\n        { questionNumber: 71, unit: '물질의 전기적 성질', type: '객관식', answer: '3' },\n        { questionNumber: 72, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 73, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 74, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 75, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        { questionNumber: 76, unit: '물질의 전기적 성질', type: '객관식', answer: '4' },\n        { questionNumber: 77, unit: '물질의 전기적 성질', type: '객관식', answer: '5' },\n        // 78~97번: 역학적 시스템 (91번 주관식 제외)\n        { questionNumber: 78, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 79, unit: '역학적 시스템', type: '객관식', answer: '4' },\n        { questionNumber: 80, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 81, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 82, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 83, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 84, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 85, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 86, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 87, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 88, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 89, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 90, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 92, unit: '역학적 시스템', type: '객관식', answer: '1' },\n        { questionNumber: 93, unit: '역학적 시스템', type: '객관식', answer: '2' },\n        { questionNumber: 94, unit: '역학적 시스템', type: '객관식', answer: '3' },\n        { questionNumber: 95, unit: '역학적 시스템', type: '객관식', answer: '1' },\n        { questionNumber: 96, unit: '역학적 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 97, unit: '역학적 시스템', type: '객관식', answer: '1' },\n        // 98~115번: 생명 시스템\n        { questionNumber: 98, unit: '생명 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 99, unit: '생명 시스템', type: '객관식', answer: '3' },\n        { questionNumber: 100, unit: '생명 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 101, unit: '생명 시스템', type: '객관식', answer: '3' },\n        { questionNumber: 102, unit: '생명 시스템', type: '객관식', answer: '3' },\n        { questionNumber: 103, unit: '생명 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 104, unit: '생명 시스템', type: '객관식', answer: '4' },\n        { questionNumber: 105, unit: '생명 시스템', type: '객관식', answer: '4' },\n        { questionNumber: 106, unit: '생명 시스템', type: '객관식', answer: '3' },\n        { questionNumber: 107, unit: '생명 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 108, unit: '생명 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 109, unit: '생명 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 110, unit: '생명 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 111, unit: '생명 시스템', type: '객관식', answer: '4' },\n        { questionNumber: 112, unit: '생명 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 113, unit: '생명 시스템', type: '객관식', answer: '3' },\n        { questionNumber: 114, unit: '생명 시스템', type: '객관식', answer: '5' },\n        { questionNumber: 115, unit: '생명 시스템', type: '객관식', answer: '5' },\n        // 116~146번: 화학 변화 (산화 환원)\n        { questionNumber: 116, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '4' },\n        { questionNumber: 117, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '1,3' },\n        { questionNumber: 118, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 119, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 120, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '2' },\n        { questionNumber: 121, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '3' },\n        { questionNumber: 122, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 123, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 124, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 125, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '2' },\n        { questionNumber: 126, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '2' },\n        { questionNumber: 127, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 128, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '3' },\n        { questionNumber: 129, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '3' },\n        { questionNumber: 130, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 131, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '4' },\n        { questionNumber: 132, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 133, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 134, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '3' },\n        { questionNumber: 135, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 136, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '4' },\n        { questionNumber: 137, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 138, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 139, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '3' },\n        { questionNumber: 140, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 141, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 142, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        { questionNumber: 143, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '3' },\n        { questionNumber: 144, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '3' },\n        { questionNumber: 145, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '4' },\n        { questionNumber: 146, unit: '화학 변화 (산화 환원)', type: '객관식', answer: '5' },\n        // 147~188번: 화학 변화 (산과 염기)\n        { questionNumber: 147, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '1' },\n        { questionNumber: 148, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 149, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 150, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 151, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 152, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 153, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 154, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 155, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 156, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 157, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 158, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 159, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '3' },\n        { questionNumber: 160, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 161, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 162, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 163, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 164, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 165, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '1' },\n        { questionNumber: 166, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 167, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '3' },\n        { questionNumber: 168, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '3' },\n        { questionNumber: 169, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 170, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 171, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 172, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 173, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 174, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 175, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 176, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 177, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 178, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '3' },\n        { questionNumber: 179, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '1' },\n        { questionNumber: 180, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 181, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 182, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 183, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '3' },\n        { questionNumber: 184, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '3' },\n        { questionNumber: 185, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 186, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 187, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        { questionNumber: 188, unit: '화학 변화 (산과 염기)', type: '객관식', answer: '5' },\n        // 189~214번: 발전과 신재생 에너지 (태양 에너지)\n        { questionNumber: 189, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 190, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '3' },\n        { questionNumber: 191, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '2,4' },\n        { questionNumber: 192, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 193, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 194, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '3' },\n        { questionNumber: 195, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '4' },\n        { questionNumber: 196, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '3' },\n        { questionNumber: 197, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 198, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 199, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 200, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 201, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 202, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 203, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 204, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 205, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '2' },\n        { questionNumber: 206, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '4' },\n        { questionNumber: 207, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 208, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        { questionNumber: 209, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '1' },\n        { questionNumber: 210, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '3' },\n        { questionNumber: 211, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '4' },\n        { questionNumber: 212, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '1' },\n        { questionNumber: 213, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '1' },\n        { questionNumber: 214, unit: '발전과 신재생 에너지 (태양 에너지)', type: '객관식', answer: '5' },\n        // 215~248번: 발전과 신재생 에너지 (전자기 유도)\n        { questionNumber: 215, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '1' },\n        { questionNumber: 216, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 217, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '4' },\n        { questionNumber: 218, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '1' },\n        { questionNumber: 219, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 220, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '3' },\n        { questionNumber: 221, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 222, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '3' },\n        { questionNumber: 223, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '1' },\n        { questionNumber: 224, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '2' },\n        { questionNumber: 225, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 226, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 227, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 228, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 229, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '1' },\n        { questionNumber: 230, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 231, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '3' },\n        { questionNumber: 232, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 233, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 234, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 235, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '2' },\n        { questionNumber: 236, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '1' },\n        { questionNumber: 237, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 238, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 239, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 240, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 241, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 242, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '1' },\n        { questionNumber: 243, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '3' },\n        { questionNumber: 244, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '3' },\n        { questionNumber: 245, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 246, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '1' },\n        { questionNumber: 247, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '5' },\n        { questionNumber: 248, unit: '발전과 신재생 에너지 (전자기 유도)', type: '객관식', answer: '4' },\n        // 249~312번: 발전과 신재생 에너지 (에너지 전환 및 신재생)\n        { questionNumber: 249, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '1' },\n        { questionNumber: 250, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '3' },\n        { questionNumber: 251, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '3' },\n        { questionNumber: 252, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '3' },\n        { questionNumber: 253, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 254, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 255, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 256, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 257, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '1' },\n        { questionNumber: 258, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 259, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 260, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 261, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 262, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 263, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 264, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '2' },\n        { questionNumber: 265, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 266, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 267, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 268, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 269, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '2' },\n        { questionNumber: 270, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 271, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 272, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 273, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '2' },\n        { questionNumber: 274, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '1' },\n        { questionNumber: 275, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 276, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 277, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '3' },\n        { questionNumber: 278, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 279, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '2' },\n        { questionNumber: 280, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 281, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '1' },\n        { questionNumber: 282, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 283, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '3' },\n        { questionNumber: 284, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 285, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 286, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 287, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '3' },\n        { questionNumber: 288, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 289, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 290, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 291, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '1' },\n        { questionNumber: 292, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '3' },\n        { questionNumber: 293, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '4' },\n        { questionNumber: 294, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 295, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '3,5' },\n        { questionNumber: 296, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '2' },\n        { questionNumber: 297, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 298, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 299, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 300, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '4' },\n        { questionNumber: 301, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 302, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 303, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '3' },\n        { questionNumber: 304, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 305, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '2,5' },\n        { questionNumber: 306, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '3' },\n        { questionNumber: 307, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 308, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 309, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 310, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '3' },\n        { questionNumber: 311, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n        { questionNumber: 312, unit: '발전과 신재생 에너지 (에너지 전환 및 신재생)', type: '객관식', answer: '5' },\n      ];\n\n      // 단원별 카테고리 매핑\n      const unitCategoryMap: Record<string, string> = {\n        '물질의 규칙성과 결합': '물질',\n        '생명체 구성 물질': '생명',\n        '물질의 전기적 성질': '물질',\n        '역학적 시스템': '에너지',\n        '생명 시스템': '생명',\n        '화학 변화 (산화 환원)': '물질',\n        '화학 변화 (산과 염기)': '물질',\n        '발전과 신재생 에너지 (태양 에너지)': '에너지',\n        '발전과 신재생 에너지 (전자기 유도)': '에너지',\n        '발전과 신재생 에너지 (에너지 전환 및 신재생)': '에너지',\n      };\n\n      // 학교 생성 (런지 교재용)\n      const school = await storage.createSchool({ name: '통합과학 런지' });\n      \n      // 시험 생성\n      const exam = await storage.createExam({\n        schoolId: school.id,\n        schoolName: school.name,\n        year: 2025,\n        semester: '런지 교재',\n        subject: '중등 통합과학 선행',\n      });\n\n      // 문제 생성\n      const questionsToCreate = runjiAnswers.map(q => {\n        const isMultipleAnswer = q.answer.includes(',');\n        let answer = q.answer;\n        if (isMultipleAnswer) {\n          const answers = q.answer.split(',').map(a => a.trim()).sort();\n          answer = JSON.stringify(answers);\n        }\n        \n        return {\n          examId: exam.id,\n          questionNumber: q.questionNumber,\n          type: q.type,\n          category: unitCategoryMap[q.unit] || '물질',\n          unit: q.unit,\n          answer,\n          isMultipleAnswer,\n        };\n      });\n\n      await storage.createManyQuestions(questionsToCreate);\n\n      const questions = await storage.getAllQuestions();\n\n      return res.json({\n        message: \"런지 교재 데이터 초기화 완료\",\n        examCount: 1,\n        questionCount: questions.length,\n      });\n    } catch (error: any) {\n      console.error('Init data error:', error);\n      return res.status(500).json({\n        message: error.message || \"데이터 초기화 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Reset and reinitialize data\n  app.post(\"/api/reset-data\", async (req, res) => {\n    try {\n      // 기존 데이터 삭제\n      await storage.deleteAllSubmissions();\n      await storage.deleteAllQuestions();\n      await storage.deleteAllExams();\n      await storage.deleteAllSchools();\n\n      return res.json({\n        message: \"데이터 초기화 완료. /api/init-data를 호출하여 새 데이터를 로드하세요.\",\n      });\n    } catch (error: any) {\n      console.error('Reset data error:', error);\n      return res.status(500).json({\n        message: error.message || \"데이터 초기화 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Upload current data to Google Sheets\n  app.post(\"/api/upload-to-sheets\", async (req, res) => {\n    try {\n      const { spreadsheetId } = req.body;\n      \n      if (!spreadsheetId) {\n        return res.status(400).json({\n          message: \"스프레드시트 ID가 필요합니다.\",\n        });\n      }\n\n      console.log(`Uploading data to Google Sheets: ${spreadsheetId}`);\n\n      const allExams = await storage.getAllExams();\n      const exportData: any[] = [];\n\n      for (const exam of allExams) {\n        const questions = await storage.getQuestionsByExam(exam.id);\n        \n        for (const question of questions) {\n          // Parse answer if it's JSON (multiple answers)\n          let answer = question.answer;\n          let isMultipleAnswer = question.isMultipleAnswer;\n          \n          if (question.isMultipleAnswer) {\n            try {\n              const parsed = JSON.parse(question.answer);\n              if (Array.isArray(parsed)) {\n                answer = parsed.join(',');\n              }\n            } catch {\n              // If parsing fails, use as is\n            }\n          }\n\n          exportData.push({\n            schoolName: exam.schoolName,\n            year: exam.year,\n            semester: exam.semester,\n            questionNumber: question.questionNumber,\n            category: question.category,\n            unit: question.unit,\n            answer,\n            isMultipleAnswer,\n          });\n        }\n      }\n\n      await writeExamDataToSheet(spreadsheetId, exportData);\n\n      return res.json({\n        message: \"구글 시트 업로드 완료\",\n        questionCount: exportData.length,\n      });\n    } catch (error: any) {\n      console.error('Upload to sheets error:', error);\n      return res.status(500).json({\n        message: error.message || \"구글 시트 업로드 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Load data from Google Sheets\n  app.post(\"/api/load-from-sheets\", async (req, res) => {\n    try {\n      const { spreadsheetId } = req.body;\n      \n      if (!spreadsheetId) {\n        return res.status(400).json({\n          message: \"스프레드시트 ID가 필요합니다.\",\n        });\n      }\n\n      console.log(`Loading exam data from Google Sheets: ${spreadsheetId}`);\n      \n      const sheetData = await readExamDataFromSheet(spreadsheetId);\n      \n      console.log(`Found ${sheetData.length} questions in Google Sheets`);\n\n      // Group by school and exam\n      const examMap = new Map<string, Map<string, any[]>>();\n      \n      for (const row of sheetData) {\n        if (!row.schoolName || !row.year || !row.semester) {\n          continue;\n        }\n\n        const schoolKey = row.schoolName;\n        const examKey = `${row.year}_${row.semester}`;\n        \n        if (!examMap.has(schoolKey)) {\n          examMap.set(schoolKey, new Map());\n        }\n        \n        const schoolExams = examMap.get(schoolKey)!;\n        if (!schoolExams.has(examKey)) {\n          schoolExams.set(examKey, []);\n        }\n\n        // Normalize answer format for multiple answers\n        let answer = row.answer;\n        if (row.isMultipleAnswer) {\n          const answers = answer.split(',').map((a: string) => a.trim()).filter((a: string) => a).sort();\n          answer = JSON.stringify(answers);\n        }\n        \n        schoolExams.get(examKey)!.push({\n          questionNumber: row.questionNumber,\n          type: '객관식',\n          category: row.category,\n          unit: row.unit,\n          answer,\n          isMultipleAnswer: row.isMultipleAnswer,\n        });\n      }\n\n      // Create schools and exams\n      let schoolCount = 0;\n      let questionCount = 0;\n\n      for (const [schoolName, examData] of Array.from(examMap.entries())) {\n        // Check if school already exists\n        let school = (await storage.getAllSchools()).find(s => s.name === schoolName);\n        \n        if (!school) {\n          school = await storage.createSchool({ name: schoolName });\n          schoolCount++;\n        }\n        \n        for (const [examKey, examQuestions] of Array.from(examData.entries())) {\n          const [year, semester] = examKey.split('_');\n          \n          // Check if exam already exists\n          const existingExams = await storage.getExamsBySchool(school.id);\n          let exam = existingExams.find(e => \n            e.year === parseInt(year) && e.semester === semester\n          );\n          \n          if (!exam) {\n            exam = await storage.createExam({\n              schoolId: school.id,\n              schoolName: school.name,\n              year: parseInt(year),\n              semester,\n              subject: \"통합과학\",\n            });\n          }\n\n          if (examQuestions.length > 0) {\n            await storage.createManyQuestions(examQuestions.map((q: any) => ({\n              ...q,\n              examId: exam.id,\n            })));\n            questionCount += examQuestions.length;\n          }\n        }\n      }\n\n      const schools = await storage.getAllSchools();\n      const questions = await storage.getAllQuestions();\n\n      return res.json({\n        message: \"구글 시트 데이터 로드 완료\",\n        schoolCount: schools.length,\n        newSchools: schoolCount,\n        questionCount: questions.length,\n        newQuestions: questionCount,\n      });\n    } catch (error: any) {\n      console.error('Load from sheets error:', error);\n      return res.status(500).json({\n        message: error.message || \"구글 시트 데이터 로드 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Admin endpoints\n  const ADMIN_PASSWORD = \"3721\";\n\n  app.post(\"/api/admin/login\", async (req, res) => {\n    try {\n      const { password } = req.body;\n      if (password === ADMIN_PASSWORD) {\n        return res.json({ success: true });\n      } else {\n        return res.status(401).json({ success: false, message: \"비밀번호가 올바르지 않습니다.\" });\n      }\n    } catch (error: any) {\n      return res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.get(\"/api/admin/students\", async (req, res) => {\n    try {\n      const students = await storage.getAllStudents();\n      return res.json(students);\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"학생 데이터를 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  app.get(\"/api/admin/submissions\", async (req, res) => {\n    try {\n      const submissions = await storage.getAllSubmissions();\n      \n      const enrichedSubmissions = await Promise.all(\n        submissions.map(async (submission) => {\n          const exam = await storage.getExamById(submission.examId);\n          return {\n            ...submission,\n            exam,\n            unitResults: JSON.parse(submission.unitResults) as UnitResult[],\n          };\n        })\n      );\n      \n      return res.json(enrichedSubmissions);\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"제출 기록을 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  app.get(\"/api/admin/all-results\", async (req, res) => {\n    try {\n      const setting = await storage.getSetting(\"spreadsheet-id\");\n      const spreadsheetId = setting?.value;\n      \n      if (!spreadsheetId) {\n        return res.json([]);\n      }\n\n      console.log(`[Admin] Reading results from Google Sheets (시트3)...`);\n      const results = await readAllResultsFromSheet(spreadsheetId);\n      console.log(`[Admin] Found ${results.length} results in 시트3`);\n      \n      const formattedResults = results.map(result => ({\n        studentId: result.studentId,\n        studentName: result.studentName,\n        textbook: result.exam,\n        unit: result.unit,\n        submittedAt: result.submittedAt,\n        achievementRate: result.achievementRate,\n        feedback: '',\n      }));\n      \n      return res.json(formattedResults);\n    } catch (error: any) {\n      console.error('Error reading results from Google Sheets:', error);\n      return res.status(500).json({\n        message: error.message || \"구글 시트에서 성적을 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Get spreadsheet ID setting\n  app.get(\"/api/admin/settings/spreadsheet-id\", async (req, res) => {\n    try {\n      const setting = await storage.getSetting(\"spreadsheet-id\");\n      return res.json({ value: setting?.value || \"\" });\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"설정을 불러오는 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  // Update spreadsheet ID setting\n  app.post(\"/api/admin/settings/spreadsheet-id\", async (req, res) => {\n    try {\n      const { value } = req.body;\n      \n      if (!value || typeof value !== \"string\") {\n        return res.status(400).json({\n          message: \"구글 시트 ID를 입력해주세요.\",\n        });\n      }\n\n      await storage.setSetting(\"spreadsheet-id\", value);\n      \n      return res.json({ \n        success: true,\n        value,\n      });\n    } catch (error: any) {\n      return res.status(500).json({\n        message: error.message || \"설정 저장 중 오류가 발생했습니다.\",\n      });\n    }\n  });\n\n  const httpServer = createServer(app);\n\n  return httpServer;\n}\n\n// Helper function to parse exam data\nfunction parseExamData(content: string): Record<string, Record<string, any[]>> {\n  const result: Record<string, Record<string, any[]>> = {};\n  const lines = content.split('\\n');\n  \n  let currentSchool = '';\n  let currentYear = 0;\n  let currentSemester = '';\n  let currentType = ''; // '선택형' or '서답형'\n  \n  const categoryMap: Record<string, string> = {\n    '⚡️': '에너지',\n    '🧪': '화학',\n    '🌍': '생태계',\n    '🌎': '지구',\n    '🧬': '생명',\n    '⚛️': '화학',\n    '💡': '신소재',\n  };\n\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i].trim();\n    \n    // Parse school and year/semester\n    const schoolMatch = line.match(/^### (\\d+)\\.\\s+(.+?고등학교)\\s+\\((\\d+)년\\s+(.+?)\\)$/);\n    if (schoolMatch) {\n      currentSchool = schoolMatch[2];\n      currentYear = parseInt(schoolMatch[3]);\n      currentSemester = schoolMatch[4];\n      \n      if (!result[currentSchool]) {\n        result[currentSchool] = {};\n      }\n      const examKey = `${currentYear}_${currentSemester}`;\n      if (!result[currentSchool][examKey]) {\n        result[currentSchool][examKey] = [];\n      }\n      continue;\n    }\n\n    // Parse question type section\n    if (line === '#### 선택형') {\n      currentType = '객관식';\n      continue;\n    }\n    if (line === '#### 서답형') {\n      currentType = '주관식';\n      continue;\n    }\n\n    // Parse questions\n    if (currentSchool && currentType === '객관식') {\n      const questionMatch = line.match(/^\\*\\s+(\\d+)번\\s+([⚡️🧪🌍🌎🧬⚛️💡])(.+?)\\s+정답\\s+(.+)$/);\n      if (questionMatch) {\n        const questionNumber = parseInt(questionMatch[1]);\n        const categoryEmoji = questionMatch[2];\n        const unitText = questionMatch[3];\n        const answerText = questionMatch[4].trim();\n        \n        const category = categoryMap[categoryEmoji] || '기타';\n        const unitMatch = unitText.match(/\\(([^)]+)\\)/);\n        const unit = unitMatch ? unitMatch[1] : unitText.trim();\n        \n        // Handle multiple answers - normalize to sorted JSON arrays\n        const isMultipleAnswer = answerText.includes(',') || answerText.includes('복수');\n        let answer: string;\n        \n        if (isMultipleAnswer) {\n          const answers = answerText\n            .replace(/\\(복수 정답\\)/g, '')\n            .split(',')\n            .map(a => a.trim())\n            .filter(a => a)\n            .sort(); // Sort for consistent comparison\n          answer = JSON.stringify(answers);\n        } else {\n          answer = answerText;\n        }\n\n        const examKey = `${currentYear}_${currentSemester}`;\n        result[currentSchool][examKey].push({\n          questionNumber,\n          type: currentType,\n          category,\n          unit,\n          answer,\n          isMultipleAnswer,\n        });\n      }\n    }\n\n    // Handle subjective questions if needed\n    if (currentSchool && currentType === '주관식') {\n      const subjectiveMatch = line.match(/^\\*\\s+\\*\\*서답형\\s+(\\d+)번\\*\\*\\s+([⚡️🧪🌍🌎🧬⚛️💡])(.+?)$/);\n      if (subjectiveMatch) {\n        // For now, we'll skip subjective questions\n        // They can be added later if needed\n        continue;\n      }\n    }\n  }\n  \n  return result;\n}\n","path":null,"size_bytes":73929,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"replit.md":{"content":"# Mokdong A1 Science Academy Assessment System\n\n## Overview\n\nThis is an OMR (Optical Mark Recognition) assessment system for Mokdong A1 Science Academy, specifically designed for **중등 통합과학 선행 (Middle School Integrated Science Pre-learning)** using the **런지 (Runji) textbook**.\n\nThe application enables students to:\n\n- Log in using their student ID and name\n- Select from 10 integrated science units based on the Runji textbook\n- Complete assessments by submitting answers (312 questions total)\n- View detailed results with performance analytics\n- Track progress across multiple test attempts\n\nThe system automatically grades submissions against stored answer keys and provides immediate feedback with achievement rates, scores, and detailed answer comparisons.\n\n### Curriculum Units (런지 교재)\n1. 물질의 규칙성과 결합 (Questions 1-37)\n2. 생명체 구성 물질 (Questions 38-55)\n3. 물질의 전기적 성질 (Questions 56-77)\n4. 역학적 시스템 (Questions 78-97, excluding Q91)\n5. 생명 시스템 (Questions 98-115)\n6. 화학 변화 (산화 환원) (Questions 116-146)\n7. 화학 변화 (산과 염기) (Questions 147-188)\n8. 발전과 신재생 에너지 (태양 에너지) (Questions 189-214)\n9. 발전과 신재생 에너지 (전자기 유도) (Questions 215-248)\n10. 발전과 신재생 에너지 (에너지 전환 및 신재생) (Questions 249-312)\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework**: React with TypeScript using Vite as the build tool\n\n**UI Component System**: \n- Shadcn/ui component library with Radix UI primitives\n- Tailwind CSS for styling with a custom design system based on Material Design principles\n- Design emphasizes clarity and efficient navigation for educational contexts\n- Typography system uses Inter for UI elements and JetBrains Mono for numerical data displays\n\n**Routing**: Wouter for client-side routing with the following pages:\n- Login page (/)\n- Units selection page (/units)\n- Test taking page (/test/:unit)\n- Results display page (/result)\n- Reports/analytics page (/reports)\n\n**State Management**: \n- TanStack Query (React Query) for server state management\n- Session storage for maintaining student authentication state and test results between page navigations\n- No global state management library (relies on React Query cache and session storage)\n\n**Data Visualization**: Recharts library for displaying student performance analytics with bar charts and line charts\n\n### Backend Architecture\n\n**Server Framework**: Express.js with TypeScript running on Node.js\n\n**API Design**: RESTful JSON API with the following endpoints:\n- POST /api/auth/login - Student authentication\n- GET /api/questions/unit/:unit - Retrieve questions by curriculum unit\n- POST /api/test/submit - Submit test answers for grading\n- GET /api/results/:studentId - Retrieve student test history\n\n**Session Management**: Currently using session storage on client-side; no server-side sessions implemented\n\n**Error Handling**: Centralized error handling with structured JSON error responses\n\n### Data Storage\n\n**Database**: PostgreSQL (Neon serverless) accessed via connection pooling\n\n**ORM**: Drizzle ORM for type-safe database operations\n\n**Schema Design**:\n- `students` table: Stores student credentials (ID, name, grade, phone)\n- `questions` table: Answer key repository with question metadata (unit, type, correct answer, textbook)\n- `test_results` table: Complete test submission records including student answers (JSON), scores, achievement rates, and timestamps\n\n**Migrations**: Drizzle Kit for schema migrations stored in `/migrations` directory\n\n### Authentication & Authorization\n\n**Authentication Method**: Simple credential-based authentication using student ID and name lookup\n\n**Security Considerations**:\n- No password-based authentication (intentional design for educational context)\n- Student identity verified through database lookup matching both ID and name\n- Session maintained client-side in sessionStorage\n- No JWT or token-based authentication implemented\n\n**Access Control**: Students can only view/access their own test results (enforced through studentId filtering)\n\n### External Dependencies\n\n**Google Sheets Integration**:\n- Google Sheets API v4 for reading student data and potentially writing results\n- OAuth2 authentication using Replit Connectors system\n- Functions: `getUncachableGoogleSheetClient()`, `readStudentsFromSheet()`\n- Access token management with automatic refresh when expired\n\n**Neon Database**:\n- Serverless PostgreSQL database hosting\n- WebSocket support for serverless environments\n- Connection pooling via `@neondatabase/serverless` package\n\n**Replit Platform Services**:\n- Replit Connectors for managing Google OAuth credentials\n- Vite plugins for Replit development environment (cartographer, dev banner, runtime error overlay)\n- Environment-based identity tokens (REPL_IDENTITY, WEB_REPL_RENEWAL)\n\n**Third-party Libraries**:\n- React Hook Form with Zod resolvers for form validation\n- date-fns for date formatting and manipulation\n- Lucide React for iconography\n- class-variance-authority and clsx for conditional styling","path":null,"size_bytes":5232,"size_tokens":null},"server/storage.ts":{"content":"import { \n  schools, \n  exams, \n  questions, \n  students, \n  submissions, \n  settings,\n  type School,\n  type InsertSchool,\n  type Exam,\n  type InsertExam,\n  type Question,\n  type InsertQuestion,\n  type Student,\n  type InsertStudent,\n  type Submission,\n  type InsertSubmission,\n  type Setting,\n  type InsertSetting,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, desc } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // School operations\n  getAllSchools(): Promise<School[]>;\n  getSchoolById(id: number): Promise<School | undefined>;\n  createSchool(school: InsertSchool): Promise<School>;\n  \n  // Exam operations\n  getAllExams(): Promise<Exam[]>;\n  getExamById(id: number): Promise<Exam | undefined>;\n  getExamsBySchool(schoolId: number): Promise<Exam[]>;\n  createExam(exam: InsertExam): Promise<Exam>;\n  \n  // Question operations\n  getQuestionsByExam(examId: number): Promise<Question[]>;\n  getQuestionsByUnit(unit: string): Promise<Question[]>;\n  getAllQuestions(): Promise<Question[]>;\n  createQuestion(question: InsertQuestion): Promise<Question>;\n  createManyQuestions(questions: InsertQuestion[]): Promise<void>;\n  \n  // Student operations\n  getStudentByCredentials(studentId: string, studentName: string): Promise<Student | undefined>;\n  getStudentById(studentId: string): Promise<Student | undefined>;\n  getAllStudents(): Promise<Student[]>;\n  createStudent(student: InsertStudent): Promise<Student>;\n  \n  // Submission operations\n  createSubmission(submission: InsertSubmission): Promise<Submission>;\n  getSubmissionsByStudent(studentId: string): Promise<Submission[]>;\n  getSubmissionsByExam(examId: number): Promise<Submission[]>;\n  getAllSubmissions(): Promise<Submission[]>;\n  \n  // Settings operations\n  getSetting(key: string): Promise<Setting | undefined>;\n  setSetting(key: string, value: string): Promise<Setting>;\n  getAllSettings(): Promise<Setting[]>;\n  \n  // Delete operations\n  deleteAllSubmissions(): Promise<void>;\n  deleteAllQuestions(): Promise<void>;\n  deleteAllExams(): Promise<void>;\n  deleteAllSchools(): Promise<void>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // School operations\n  async getAllSchools(): Promise<School[]> {\n    return await db.select().from(schools);\n  }\n\n  async getSchoolById(id: number): Promise<School | undefined> {\n    const [school] = await db\n      .select()\n      .from(schools)\n      .where(eq(schools.id, id));\n    return school || undefined;\n  }\n\n  async createSchool(insertSchool: InsertSchool): Promise<School> {\n    const [school] = await db\n      .insert(schools)\n      .values(insertSchool)\n      .returning();\n    return school;\n  }\n\n  // Exam operations\n  async getAllExams(): Promise<Exam[]> {\n    return await db.select().from(exams);\n  }\n\n  async getExamById(id: number): Promise<Exam | undefined> {\n    const [exam] = await db\n      .select()\n      .from(exams)\n      .where(eq(exams.id, id));\n    return exam || undefined;\n  }\n\n  async getExamsBySchool(schoolId: number): Promise<Exam[]> {\n    return await db\n      .select()\n      .from(exams)\n      .where(eq(exams.schoolId, schoolId));\n  }\n\n  async createExam(insertExam: InsertExam): Promise<Exam> {\n    const [exam] = await db\n      .insert(exams)\n      .values(insertExam)\n      .returning();\n    return exam;\n  }\n\n  // Question operations\n  async getQuestionsByExam(examId: number): Promise<Question[]> {\n    return await db\n      .select()\n      .from(questions)\n      .where(eq(questions.examId, examId))\n      .orderBy(questions.questionNumber);\n  }\n\n  async getQuestionsByUnit(unit: string): Promise<Question[]> {\n    return await db\n      .select()\n      .from(questions)\n      .where(eq(questions.unit, unit))\n      .orderBy(questions.questionNumber);\n  }\n\n  async getAllQuestions(): Promise<Question[]> {\n    return await db.select().from(questions);\n  }\n\n  async createQuestion(insertQuestion: InsertQuestion): Promise<Question> {\n    const [question] = await db\n      .insert(questions)\n      .values(insertQuestion)\n      .returning();\n    return question;\n  }\n\n  async createManyQuestions(insertQuestions: InsertQuestion[]): Promise<void> {\n    if (insertQuestions.length > 0) {\n      await db.insert(questions).values(insertQuestions);\n    }\n  }\n\n  // Student operations\n  async getStudentByCredentials(studentId: string, studentName: string): Promise<Student | undefined> {\n    const [student] = await db\n      .select()\n      .from(students)\n      .where(and(eq(students.studentId, studentId), eq(students.studentName, studentName)));\n    return student || undefined;\n  }\n\n  async getStudentById(studentId: string): Promise<Student | undefined> {\n    const [student] = await db\n      .select()\n      .from(students)\n      .where(eq(students.studentId, studentId));\n    return student || undefined;\n  }\n\n  async getAllStudents(): Promise<Student[]> {\n    return await db.select().from(students);\n  }\n\n  async createStudent(insertStudent: InsertStudent): Promise<Student> {\n    const [student] = await db\n      .insert(students)\n      .values(insertStudent)\n      .returning();\n    return student;\n  }\n\n  // Submission operations\n  async createSubmission(insertSubmission: InsertSubmission): Promise<Submission> {\n    const [submission] = await db\n      .insert(submissions)\n      .values(insertSubmission)\n      .returning();\n    return submission;\n  }\n\n  async getSubmissionsByStudent(studentId: string): Promise<Submission[]> {\n    return await db\n      .select()\n      .from(submissions)\n      .where(eq(submissions.studentId, studentId))\n      .orderBy(desc(submissions.submittedAt));\n  }\n\n  async getSubmissionsByExam(examId: number): Promise<Submission[]> {\n    return await db\n      .select()\n      .from(submissions)\n      .where(eq(submissions.examId, examId))\n      .orderBy(desc(submissions.submittedAt));\n  }\n\n  async getAllSubmissions(): Promise<Submission[]> {\n    return await db\n      .select()\n      .from(submissions)\n      .orderBy(desc(submissions.submittedAt));\n  }\n\n  // Settings operations\n  async getSetting(key: string): Promise<Setting | undefined> {\n    const [setting] = await db\n      .select()\n      .from(settings)\n      .where(eq(settings.key, key));\n    return setting || undefined;\n  }\n\n  async setSetting(key: string, value: string): Promise<Setting> {\n    const existing = await this.getSetting(key);\n    \n    if (existing) {\n      const [updated] = await db\n        .update(settings)\n        .set({ value, updatedAt: new Date() })\n        .where(eq(settings.key, key))\n        .returning();\n      return updated;\n    } else {\n      const [created] = await db\n        .insert(settings)\n        .values({ key, value })\n        .returning();\n      return created;\n    }\n  }\n\n  async getAllSettings(): Promise<Setting[]> {\n    return await db.select().from(settings);\n  }\n\n  // Delete operations\n  async deleteAllSubmissions(): Promise<void> {\n    await db.delete(submissions);\n  }\n\n  async deleteAllQuestions(): Promise<void> {\n    await db.delete(questions);\n  }\n\n  async deleteAllExams(): Promise<void> {\n    await db.delete(exams);\n  }\n\n  async deleteAllSchools(): Promise<void> {\n    await db.delete(schools);\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","path":null,"size_bytes":7187,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","path":null,"size_bytes":1904,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest<T = any>(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<T> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return await res.json();\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1398,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"client/src/pages/units.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { BookOpen, ChevronRight, LogOut, BarChart3 } from \"lucide-react\";\nimport { units } from \"@shared/schema\";\nimport { useEffect } from \"react\";\n\nexport default function UnitsPage() {\n  const [, setLocation] = useLocation();\n  const studentData = sessionStorage.getItem(\"student\");\n  const student = studentData ? JSON.parse(studentData) : null;\n\n  useEffect(() => {\n    if (!student) {\n      setLocation(\"/\");\n    }\n  }, [student, setLocation]);\n\n  const { data: questionCounts, isLoading } = useQuery({\n    queryKey: [\"/api/questions/counts\"],\n    enabled: !!student,\n  });\n\n  const handleLogout = () => {\n    sessionStorage.removeItem(\"student\");\n    setLocation(\"/\");\n  };\n\n  const handleUnitSelect = (unit: string) => {\n    setLocation(`/test/unit/${encodeURIComponent(unit)}`);\n  };\n\n  const handleViewReports = () => {\n    setLocation(\"/reports\");\n  };\n\n  if (!student) {\n    return null;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"sticky top-0 z-50 border-b bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60\">\n        <div className=\"container mx-auto px-4 py-4 flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center\">\n              <BookOpen className=\"w-5 h-5 text-primary\" />\n            </div>\n            <div>\n              <h1 className=\"text-lg font-bold\">목동에이원과학학원</h1>\n              <p className=\"text-sm text-muted-foreground\">중등 통합과학 선행</p>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <div className=\"text-right hidden sm:block\">\n              <p className=\"text-sm font-medium\">{student.studentName}</p>\n              <p className=\"text-xs text-muted-foreground font-mono\">{student.studentId}</p>\n            </div>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              data-testid=\"button-view-reports\"\n              onClick={handleViewReports}\n            >\n              <BarChart3 className=\"w-4 h-4 mr-2\" />\n              성적 확인\n            </Button>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              data-testid=\"button-logout\"\n              onClick={handleLogout}\n            >\n              <LogOut className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"container mx-auto px-4 py-8\">\n        <div className=\"max-w-5xl mx-auto space-y-8\">\n          <div className=\"text-center space-y-2\">\n            <h2 className=\"text-3xl font-bold\">과제 점검시작</h2>\n            <p className=\"text-muted-foreground\">\n              점검할 단원을 선택해주세요\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {units.map((unit, index) => {\n              const counts = questionCounts as Record<string, number> | undefined;\n              const count = counts?.[unit] || 0;\n              \n              return (\n                <Card\n                  key={unit}\n                  className=\"hover-elevate active-elevate-2 transition-all cursor-pointer group\"\n                  onClick={() => handleUnitSelect(unit)}\n                  data-testid={`card-unit-${index}`}\n                >\n                  <CardHeader className=\"space-y-4\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <Badge variant=\"secondary\" className=\"font-mono\">\n                        {index + 1}단원\n                      </Badge>\n                      {isLoading ? (\n                        <Skeleton className=\"h-5 w-16\" />\n                      ) : (\n                        <Badge variant=\"outline\" className=\"font-mono\">\n                          {count}문항\n                        </Badge>\n                      )}\n                    </div>\n                    <CardTitle className=\"text-xl leading-tight\">\n                      {unit}\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <Button\n                      className=\"w-full group-hover:bg-primary/90\"\n                      data-testid={`button-start-${index}`}\n                    >\n                      과제 점검 시작\n                      <ChevronRight className=\"w-4 h-4 ml-2\" />\n                    </Button>\n                  </CardContent>\n                </Card>\n              );\n            })}\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":5014,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4420,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"server/googleSheets.ts":{"content":"import { google } from 'googleapis';\n\nlet connectionSettings: any;\n\nasync function getAccessToken() {\n  if (connectionSettings && connectionSettings.settings.expires_at && new Date(connectionSettings.settings.expires_at).getTime() > Date.now()) {\n    return connectionSettings.settings.access_token;\n  }\n  \n  const hostname = process.env.REPLIT_CONNECTORS_HOSTNAME;\n  const xReplitToken = process.env.REPL_IDENTITY \n    ? 'repl ' + process.env.REPL_IDENTITY \n    : process.env.WEB_REPL_RENEWAL \n    ? 'depl ' + process.env.WEB_REPL_RENEWAL \n    : null;\n\n  if (!xReplitToken) {\n    throw new Error('X_REPLIT_TOKEN not found for repl/depl');\n  }\n\n  connectionSettings = await fetch(\n    'https://' + hostname + '/api/v2/connection?include_secrets=true&connector_names=google-sheet',\n    {\n      headers: {\n        'Accept': 'application/json',\n        'X_REPLIT_TOKEN': xReplitToken\n      }\n    }\n  ).then(res => res.json()).then(data => data.items?.[0]);\n\n  const accessToken = connectionSettings?.settings?.access_token || connectionSettings.settings?.oauth?.credentials?.access_token;\n\n  if (!connectionSettings || !accessToken) {\n    throw new Error('Google Sheet not connected');\n  }\n  return accessToken;\n}\n\nexport async function getUncachableGoogleSheetClient() {\n  const accessToken = await getAccessToken();\n\n  const oauth2Client = new google.auth.OAuth2();\n  oauth2Client.setCredentials({\n    access_token: accessToken\n  });\n\n  return google.sheets({ version: 'v4', auth: oauth2Client });\n}\n\nexport async function readStudentsFromSheet(spreadsheetId: string) {\n  try {\n    const sheets = await getUncachableGoogleSheetClient();\n    const response = await sheets.spreadsheets.values.get({\n      spreadsheetId,\n      range: '학생정보!A2:D', // Assuming first row is header\n    });\n\n    const rows = response.data.values || [];\n    return rows.map(row => ({\n      studentId: row[0] || '',\n      studentName: row[1] || '',\n      grade: row[2] || '',\n      phone: row[3] || '',\n    }));\n  } catch (error) {\n    console.error('Error reading students from Google Sheets:', error);\n    return [];\n  }\n}\n\nexport async function writeResultToSheet(spreadsheetId: string, result: any) {\n  try {\n    const sheets = await getUncachableGoogleSheetClient();\n    const timestamp = new Date(result.submittedAt).toLocaleString('ko-KR');\n    \n    console.log(`[Google Sheets] Writing result for ${result.studentId} (${result.unit})`);\n    \n    // 1. 시험결과 탭에 요약 저장\n    console.log(`[Google Sheets] Writing summary to 시험결과 tab...`);\n    await sheets.spreadsheets.values.append({\n      spreadsheetId,\n      range: '시험결과!A:G',\n      valueInputOption: 'USER_ENTERED',\n      requestBody: {\n        values: [[\n          result.studentId,\n          result.studentName,\n          result.textbook,\n          result.unit,\n          timestamp,\n          `${result.achievementRate}%`,\n          result.feedback || ''\n        ]],\n      },\n    });\n    console.log(`[Google Sheets] ✓ Summary written successfully`);\n\n    // 2. 문항통계 탭에 집계 데이터 업데이트\n    console.log(`[Google Sheets] Updating question statistics...`);\n    await updateQuestionStats(spreadsheetId, result.unit, JSON.parse(result.answers));\n    console.log(`[Google Sheets] ✓ Question statistics updated`);\n\n    console.log(`[Google Sheets] ✅ All data written successfully for ${result.studentId}`);\n    return true;\n  } catch (error: any) {\n    console.error('❌ [Google Sheets] Error writing result:', error.message);\n    console.error('Full error:', error);\n    throw error; // Re-throw so caller knows it failed\n  }\n}\n\nexport async function readResultsFromSheet(spreadsheetId: string) {\n  try {\n    const sheets = await getUncachableGoogleSheetClient();\n    const response = await sheets.spreadsheets.values.get({\n      spreadsheetId,\n      range: '시험결과!A2:G', // Skip header row\n    });\n\n    const rows = response.data.values || [];\n    return rows.map(row => ({\n      studentId: row[0] || '',\n      studentName: row[1] || '',\n      textbook: row[2] || '',\n      unit: row[3] || '',\n      submittedAt: row[4] || '',\n      achievementRate: parseInt(row[5]?.replace('%', '') || '0'),\n      feedback: row[6] || '',\n    }));\n  } catch (error) {\n    console.error('Error reading results from Google Sheets:', error);\n    return [];\n  }\n}\n\nasync function ensureSheetExists(spreadsheetId: string, sheetName: string) {\n  try {\n    const sheets = await getUncachableGoogleSheetClient();\n    \n    // 시트 목록 가져오기\n    const metadata = await sheets.spreadsheets.get({\n      spreadsheetId,\n    });\n\n    const sheetExists = metadata.data.sheets?.some(\n      sheet => sheet.properties?.title === sheetName\n    );\n\n    // 시트가 없으면 생성\n    if (!sheetExists) {\n      await sheets.spreadsheets.batchUpdate({\n        spreadsheetId,\n        requestBody: {\n          requests: [{\n            addSheet: {\n              properties: {\n                title: sheetName,\n              },\n            },\n          }],\n        },\n      });\n\n      // 헤더 추가\n      if (sheetName === '문항통계') {\n        await sheets.spreadsheets.values.update({\n          spreadsheetId,\n          range: `'${sheetName}'!A1:K1`,\n          valueInputOption: 'USER_ENTERED',\n          requestBody: {\n            values: [['단원', '문제번호', '정답', '총응시수', '오답수', '1번선택', '2번선택', '3번선택', '4번선택', '5번선택', '최종수정일시']],\n          },\n        });\n      }\n    }\n  } catch (error) {\n    console.error(`Error ensuring sheet ${sheetName} exists:`, error);\n  }\n}\n\n// 문항 통계 업데이트 (집계 방식)\nasync function updateQuestionStats(spreadsheetId: string, unit: string, studentAnswers: any[]) {\n  try {\n    // 문항통계 시트 확인 및 생성\n    await ensureSheetExists(spreadsheetId, '문항통계');\n    \n    const sheets = await getUncachableGoogleSheetClient();\n    const timestamp = new Date().toLocaleString('ko-KR');\n    \n    // 기존 통계 읽기\n    const response = await sheets.spreadsheets.values.get({\n      spreadsheetId,\n      range: \"'문항통계'!A2:K\",\n    });\n\n    const existingRows = response.data.values || [];\n    const statsMap = new Map<string, any>();\n    \n    // 기존 데이터를 맵으로 변환\n    existingRows.forEach((row, index) => {\n      const key = `${row[0]}_${row[1]}`; // 단원_문제번호\n      statsMap.set(key, {\n        rowIndex: index + 2, // 시트는 1-based, 헤더 제외\n        unit: row[0],\n        questionId: row[1],\n        correctAnswer: row[2],\n        totalAttempts: parseInt(row[3]) || 0,\n        wrongAttempts: parseInt(row[4]) || 0,\n        answer1: parseInt(row[5]) || 0,\n        answer2: parseInt(row[6]) || 0,\n        answer3: parseInt(row[7]) || 0,\n        answer4: parseInt(row[8]) || 0,\n        answer5: parseInt(row[9]) || 0,\n      });\n    });\n\n    // 새 답안으로 통계 업데이트\n    const updatedRows: any[] = [];\n    const newRows: any[] = [];\n\n    studentAnswers.forEach((ans: any) => {\n      const key = `${unit}_${ans.questionId}`;\n      const existing = statsMap.get(key);\n      \n      if (existing) {\n        // 기존 통계 업데이트\n        existing.totalAttempts++;\n        if (ans.answer !== ans.correctAnswer) {\n          existing.wrongAttempts++;\n        }\n        existing[`answer${ans.answer}`] = (existing[`answer${ans.answer}`] || 0) + 1;\n        \n        updatedRows.push({\n          range: `'문항통계'!A${existing.rowIndex}:K${existing.rowIndex}`,\n          values: [[\n            existing.unit,\n            existing.questionId,\n            existing.correctAnswer,\n            existing.totalAttempts,\n            existing.wrongAttempts,\n            existing.answer1,\n            existing.answer2,\n            existing.answer3,\n            existing.answer4,\n            existing.answer5,\n            timestamp\n          ]]\n        });\n      } else {\n        // 새 문제 통계 추가\n        const stats = {\n          unit,\n          questionId: ans.questionId,\n          correctAnswer: ans.correctAnswer || '',\n          totalAttempts: 1,\n          wrongAttempts: ans.answer !== ans.correctAnswer ? 1 : 0,\n          answer1: ans.answer === '1' ? 1 : 0,\n          answer2: ans.answer === '2' ? 1 : 0,\n          answer3: ans.answer === '3' ? 1 : 0,\n          answer4: ans.answer === '4' ? 1 : 0,\n          answer5: ans.answer === '5' ? 1 : 0,\n        };\n        \n        newRows.push([\n          stats.unit,\n          stats.questionId,\n          stats.correctAnswer,\n          stats.totalAttempts,\n          stats.wrongAttempts,\n          stats.answer1,\n          stats.answer2,\n          stats.answer3,\n          stats.answer4,\n          stats.answer5,\n          timestamp\n        ]);\n        \n        statsMap.set(key, stats);\n      }\n    });\n\n    // 배치 업데이트\n    if (updatedRows.length > 0) {\n      await sheets.spreadsheets.values.batchUpdate({\n        spreadsheetId,\n        requestBody: {\n          valueInputOption: 'USER_ENTERED',\n          data: updatedRows,\n        },\n      });\n      console.log(`[Google Sheets] Updated ${updatedRows.length} existing question stats`);\n    }\n\n    // 새 행 추가\n    if (newRows.length > 0) {\n      await sheets.spreadsheets.values.append({\n        spreadsheetId,\n        range: \"'문항통계'!A:K\",\n        valueInputOption: 'USER_ENTERED',\n        requestBody: {\n          values: newRows,\n        },\n      });\n      console.log(`[Google Sheets] Added ${newRows.length} new question stats`);\n    }\n\n    return true;\n  } catch (error) {\n    console.error('Error updating question statistics:', error);\n    throw error;\n  }\n}\n\n// 문항 통계 읽기\nexport async function readQuestionStats(spreadsheetId: string, unit?: string) {\n  try {\n    await ensureSheetExists(spreadsheetId, '문항통계');\n    \n    const sheets = await getUncachableGoogleSheetClient();\n    const response = await sheets.spreadsheets.values.get({\n      spreadsheetId,\n      range: \"'문항통계'!A2:K\",\n    });\n\n    const rows = response.data.values || [];\n    const stats = rows.map(row => ({\n      unit: row[0] || '',\n      questionId: row[1] || '',\n      correctAnswer: row[2] || '',\n      totalAttempts: parseInt(row[3]) || 0,\n      wrongAttempts: parseInt(row[4]) || 0,\n      answerDistribution: {\n        '1': parseInt(row[5]) || 0,\n        '2': parseInt(row[6]) || 0,\n        '3': parseInt(row[7]) || 0,\n        '4': parseInt(row[8]) || 0,\n        '5': parseInt(row[9]) || 0,\n      },\n      lastUpdated: row[10] || '',\n    }));\n\n    // 단원 필터링\n    if (unit) {\n      return stats.filter(s => s.unit === unit);\n    }\n    \n    return stats;\n  } catch (error) {\n    console.error('Error reading question statistics:', error);\n    return [];\n  }\n}\n\nexport async function readExamDataFromSheet(spreadsheetId: string) {\n  try {\n    const sheets = await getUncachableGoogleSheetClient();\n    \n    const response = await sheets.spreadsheets.values.get({\n      spreadsheetId,\n      range: '기출문제!A2:H',\n    });\n\n    const rows = response.data.values || [];\n    \n    const examData = rows.map(row => ({\n      schoolName: row[0] || '',\n      year: parseInt(row[1]) || 0,\n      semester: row[2] || '',\n      questionNumber: parseInt(row[3]) || 0,\n      category: row[4] || '',\n      unit: row[5] || '',\n      answer: row[6] || '',\n      isMultipleAnswer: (row[7] || 'N').toUpperCase() === 'Y',\n    }));\n\n    return examData;\n  } catch (error) {\n    console.error('Error reading exam data from Google Sheets:', error);\n    throw error;\n  }\n}\n\nexport async function writeExamDataToSheet(spreadsheetId: string, examData: any[]) {\n  try {\n    const sheets = await getUncachableGoogleSheetClient();\n    \n    // Ensure \"기출문제\" sheet exists\n    await ensureSheetExists(spreadsheetId, '기출문제');\n    \n    // Clear existing data first\n    await sheets.spreadsheets.values.clear({\n      spreadsheetId,\n      range: '기출문제!A:H',\n    });\n\n    // Prepare header\n    const header = ['학교명', '년도', '학기', '문항번호', '분류', '단원', '정답', '복수정답'];\n    \n    // Prepare rows\n    const rows = examData.map(item => [\n      item.schoolName,\n      item.year,\n      item.semester,\n      item.questionNumber,\n      item.category,\n      item.unit,\n      item.answer,\n      item.isMultipleAnswer ? 'Y' : 'N',\n    ]);\n\n    // Write data\n    await sheets.spreadsheets.values.update({\n      spreadsheetId,\n      range: '기출문제!A1:H',\n      valueInputOption: 'USER_ENTERED',\n      requestBody: {\n        values: [header, ...rows],\n      },\n    });\n\n    console.log(`✅ Wrote ${rows.length} questions to Google Sheets (기출문제 tab)`);\n    return true;\n  } catch (error) {\n    console.error('Error writing exam data to Google Sheets:', error);\n    throw error;\n  }\n}\n\nexport async function writeStudentResultToSheet(spreadsheetId: string, result: any) {\n  try {\n    const sheets = await getUncachableGoogleSheetClient();\n    \n    // Ensure sheets exist\n    await ensureSheetExists(spreadsheetId, '시트2');\n    await ensureSheetExists(spreadsheetId, '시트3');\n    \n    const timestamp = new Date(result.submittedAt).toLocaleString('ko-KR');\n    \n    // 시트2: 학생용 요약 결과\n    const sheet2Header = ['학생ID', '이름', '학교', '시험', '점수', '성취도', '제출일시'];\n    \n    // Check if header exists, if not add it\n    const sheet2Data = await sheets.spreadsheets.values.get({\n      spreadsheetId,\n      range: '시트2!A1:G1',\n    });\n    \n    if (!sheet2Data.data.values || sheet2Data.data.values.length === 0) {\n      await sheets.spreadsheets.values.update({\n        spreadsheetId,\n        range: '시트2!A1:G1',\n        valueInputOption: 'USER_ENTERED',\n        requestBody: {\n          values: [sheet2Header],\n        },\n      });\n    }\n    \n    // Append student result to 시트2\n    await sheets.spreadsheets.values.append({\n      spreadsheetId,\n      range: '시트2!A:G',\n      valueInputOption: 'USER_ENTERED',\n      requestBody: {\n        values: [[\n          result.studentId,\n          result.studentName,\n          result.exam.schoolName,\n          `${result.exam.year}년 ${result.exam.semester}`,\n          `${result.score}점`,\n          `${result.achievementRate}%`,\n          timestamp,\n        ]],\n      },\n    });\n    \n    // 시트3: 상세 분석 (단원별)\n    const sheet3Header = ['학생ID', '이름', '시험', '단원', '정답수', '오답수', '미응시', '성취도', '제출일시'];\n    \n    const sheet3Data = await sheets.spreadsheets.values.get({\n      spreadsheetId,\n      range: '시트3!A1:I1',\n    });\n    \n    if (!sheet3Data.data.values || sheet3Data.data.values.length === 0) {\n      await sheets.spreadsheets.values.update({\n        spreadsheetId,\n        range: '시트3!A1:I1',\n        valueInputOption: 'USER_ENTERED',\n        requestBody: {\n          values: [sheet3Header],\n        },\n      });\n    }\n    \n    // Append unit results to 시트3\n    const unitRows = result.unitResults.map((unit: any) => [\n      result.studentId,\n      result.studentName,\n      `${result.exam.year}년 ${result.exam.semester}`,\n      unit.unit,\n      unit.correct,\n      unit.wrong,\n      unit.unanswered,\n      `${unit.achievementRate}%`,\n      timestamp,\n    ]);\n    \n    if (unitRows.length > 0) {\n      await sheets.spreadsheets.values.append({\n        spreadsheetId,\n        range: '시트3!A:I',\n        valueInputOption: 'USER_ENTERED',\n        requestBody: {\n          values: unitRows,\n        },\n      });\n    }\n    \n    console.log(`✅ Wrote student result to Google Sheets (시트2, 시트3)`);\n    return true;\n  } catch (error) {\n    console.error('Error writing student result to Google Sheets:', error);\n    throw error;\n  }\n}\n\nexport async function readAllResultsFromSheet(spreadsheetId: string) {\n  try {\n    const sheets = await getUncachableGoogleSheetClient();\n    \n    await ensureSheetExists(spreadsheetId, '시트3');\n    \n    const response = await sheets.spreadsheets.values.get({\n      spreadsheetId,\n      range: '시트3!A2:I',\n    });\n\n    const rows = response.data.values || [];\n    \n    return rows.map(row => ({\n      studentId: row[0] || '',\n      studentName: row[1] || '',\n      exam: row[2] || '',\n      unit: row[3] || '',\n      correct: parseInt(row[4] || '0'),\n      wrong: parseInt(row[5] || '0'),\n      unanswered: parseInt(row[6] || '0'),\n      achievementRate: parseInt(row[7]?.replace('%', '') || '0'),\n      submittedAt: row[8] || '',\n    }));\n  } catch (error) {\n    console.error('Error reading all results from Google Sheets (시트3):', error);\n    return [];\n  }\n}\n","path":null,"size_bytes":16663,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/student-report-view.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { TrendingUp, TrendingDown, Award, Calendar, Target, Sparkles, BookOpen, Brain, Zap, Star, Trophy, Eye, CheckCircle, XCircle } from \"lucide-react\";\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, LineChart, Line, Legend, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar, Cell, PieChart, Pie } from \"recharts\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { TestResult } from \"@shared/schema\";\n\ninterface StudentReportViewProps {\n  results: TestResult[];\n  studentName?: string;\n  studentId?: string;\n  showBackButton?: boolean;\n  onBack?: () => void;\n}\n\nexport function StudentReportView({ results, studentName, studentId, showBackButton = false, onBack }: StudentReportViewProps) {\n  const [selectedResult, setSelectedResult] = useState<TestResult | null>(null);\n\n  const sortedResults = [...results].sort(\n    (a, b) => new Date(b.submittedAt).getTime() - new Date(a.submittedAt).getTime()\n  );\n\n  // 선택된 시험 결과의 문제 데이터 가져오기\n  const { data: questions } = useQuery<any[]>({\n    queryKey: ['/api/questions/unit', selectedResult?.unit],\n    enabled: !!selectedResult,\n  });\n\n  const getGradeInfo = (score: number) => {\n    if (score >= 95) return { grade: \"S\", color: \"bg-purple-600\", message: \"완벽합니다!\" };\n    if (score >= 90) return { grade: \"A+\", color: \"bg-green-600\", message: \"매우 우수합니다!\" };\n    if (score >= 85) return { grade: \"A\", color: \"bg-green-500\", message: \"우수합니다!\" };\n    if (score >= 80) return { grade: \"B+\", color: \"bg-blue-600\", message: \"잘했습니다!\" };\n    if (score >= 75) return { grade: \"B\", color: \"bg-blue-500\", message: \"좋습니다!\" };\n    if (score >= 70) return { grade: \"C\", color: \"bg-yellow-600\", message: \"조금 더 노력하세요!\" };\n    return { grade: \"D\", color: \"bg-red-600\", message: \"더 공부가 필요합니다!\" };\n  };\n\n  const renderResultDetail = () => {\n    if (!selectedResult || !questions) return null;\n\n    const studentAnswers = JSON.parse(selectedResult.answers || \"[]\");\n    const gradeInfo = getGradeInfo(selectedResult.achievementRate);\n\n    // 오답 문제 필터링\n    const wrongAnswers = studentAnswers.filter((ans: any) => {\n      const question = questions.find(q => q.questionId === ans.questionId);\n      return question && question.answer !== ans.answer;\n    });\n\n    return (\n      <Dialog open={!!selectedResult} onOpenChange={() => setSelectedResult(null)}>\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"text-2xl flex items-center gap-3\">\n              <Brain className=\"w-8 h-8 text-primary\" />\n              시험 결과 상세\n            </DialogTitle>\n            <DialogDescription>\n              {selectedResult.unit} · {new Date(selectedResult.submittedAt).toLocaleString(\"ko-KR\")}\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-6 py-4\">\n            {/* 점수 및 등급 */}\n            <div className=\"text-center p-8 bg-gradient-to-br from-primary/10 to-accent/10 rounded-2xl\">\n              <div className={`inline-block px-12 py-6 rounded-2xl text-white ${gradeInfo.color} shadow-xl mb-4`}>\n                <div className=\"text-6xl font-bold mb-2\">{selectedResult.achievementRate}점</div>\n                <div className=\"text-4xl font-black tracking-wider\">{gradeInfo.grade}</div>\n              </div>\n              <p className=\"text-xl font-semibold mt-4\">{gradeInfo.message}</p>\n              <div className=\"grid grid-cols-2 gap-4 mt-6 max-w-md mx-auto\">\n                <div className=\"p-4 bg-card rounded-xl border\">\n                  <p className=\"text-sm text-muted-foreground mb-1\">정답</p>\n                  <p className=\"text-3xl font-bold text-green-600\">{selectedResult.correctAnswers}</p>\n                </div>\n                <div className=\"p-4 bg-card rounded-xl border\">\n                  <p className=\"text-sm text-muted-foreground mb-1\">오답</p>\n                  <p className=\"text-3xl font-bold text-red-600\">{wrongAnswers.length}</p>\n                </div>\n              </div>\n            </div>\n\n            {/* 피드백 */}\n            {selectedResult.feedback && (\n              <Card className=\"border-2 border-primary/20\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Sparkles className=\"w-5 h-5 text-primary\" />\n                    선생님 피드백\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-lg\">{selectedResult.feedback}</p>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* 오답 문제 */}\n            {wrongAnswers.length > 0 && (\n              <Card className=\"border-2 border-red-500/20\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <XCircle className=\"w-5 h-5 text-red-600\" />\n                    틀린 문제 ({wrongAnswers.length}개)\n                  </CardTitle>\n                  <CardDescription>\n                    다시 한 번 확인하고 복습하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {wrongAnswers.map((ans: any, idx: number) => {\n                      const question = questions.find(q => q.questionId === ans.questionId);\n                      if (!question) return null;\n\n                      return (\n                        <div key={idx} className=\"p-4 rounded-xl bg-red-500/5 border-2 border-red-500/20\">\n                          <div className=\"flex items-start justify-between mb-3\">\n                            <h4 className=\"text-lg font-bold\">문제 {question.questionId}번</h4>\n                            <Badge variant=\"outline\" className=\"border-red-600 text-red-700\">\n                              오답\n                            </Badge>\n                          </div>\n                          <div className=\"grid md:grid-cols-2 gap-4 mt-3\">\n                            <div className=\"p-3 rounded-lg bg-green-500/10 border border-green-500/30\">\n                              <p className=\"text-sm text-muted-foreground mb-1 flex items-center gap-1\">\n                                <CheckCircle className=\"w-4 h-4 text-green-600\" />\n                                정답\n                              </p>\n                              <p className=\"text-2xl font-bold text-green-700\">{question.answer}번</p>\n                            </div>\n                            <div className=\"p-3 rounded-lg bg-red-500/10 border border-red-500/30\">\n                              <p className=\"text-sm text-muted-foreground mb-1 flex items-center gap-1\">\n                                <XCircle className=\"w-4 h-4 text-red-600\" />\n                                내 답\n                              </p>\n                              <p className=\"text-2xl font-bold text-red-700\">{ans.answer}번</p>\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* 정답 문제 */}\n            {selectedResult.correctAnswers > 0 && (\n              <Card className=\"border-2 border-green-500/20\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <CheckCircle className=\"w-5 h-5 text-green-600\" />\n                    맞힌 문제 ({selectedResult.correctAnswers}개)\n                  </CardTitle>\n                  <CardDescription>\n                    잘했습니다! 이 실력을 유지하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-5 sm:grid-cols-10 gap-2\">\n                    {studentAnswers\n                      .filter((ans: any) => {\n                        const question = questions.find(q => q.questionId === ans.questionId);\n                        return question && question.answer === ans.answer;\n                      })\n                      .map((ans: any, idx: number) => (\n                        <div\n                          key={idx}\n                          className=\"aspect-square flex items-center justify-center bg-green-500/10 border-2 border-green-500/30 rounded-lg font-bold text-green-700\"\n                        >\n                          {ans.questionId}\n                        </div>\n                      ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        </DialogContent>\n      </Dialog>\n    );\n  };\n\n  const totalTests = sortedResults.length;\n  const averageScore = totalTests > 0\n    ? Math.round(sortedResults.reduce((sum, r) => sum + r.achievementRate, 0) / totalTests)\n    : 0;\n  const bestScore = totalTests > 0\n    ? Math.max(...sortedResults.map(r => r.achievementRate))\n    : 0;\n\n  // 최근 3개와 이전 3개 비교 (성적 향상도)\n  const recentAvg = sortedResults.length >= 3\n    ? Math.round(sortedResults.slice(0, 3).reduce((sum, r) => sum + r.achievementRate, 0) / 3)\n    : averageScore;\n  const previousAvg = sortedResults.length >= 6\n    ? Math.round(sortedResults.slice(3, 6).reduce((sum, r) => sum + r.achievementRate, 0) / 3)\n    : averageScore;\n  const improvement = recentAvg - previousAvg;\n\n  // 단원별 데이터\n  const unitData = sortedResults.reduce((acc, result) => {\n    if (!acc[result.unit]) {\n      acc[result.unit] = {\n        unit: result.unit,\n        count: 0,\n        totalScore: 0,\n        scores: [],\n        results: [],\n      };\n    }\n    acc[result.unit].count++;\n    acc[result.unit].totalScore += result.achievementRate;\n    acc[result.unit].scores.push(result.achievementRate);\n    acc[result.unit].results.push(result);\n    return acc;\n  }, {} as Record<string, { unit: string; count: number; totalScore: number; scores: number[]; results: TestResult[] }>);\n\n  const chartData = Object.values(unitData)\n    .map(item => ({\n      name: item.unit.length > 10 ? item.unit.substring(0, 10) + \"...\" : item.unit,\n      fullName: item.unit,\n      평균점수: Math.round(item.totalScore / item.count),\n      응시횟수: item.count,\n    }))\n    .sort((a, b) => b.평균점수 - a.평균점수);\n\n  // 강점/약점 단원\n  const strongestUnit = chartData[0];\n  const weakestUnit = chartData[chartData.length - 1];\n\n  // 레이더 차트 데이터 (상위 6개 단원)\n  const radarData = chartData.slice(0, 6).map(item => ({\n    subject: item.name,\n    score: item.평균점수,\n  }));\n\n  // 성적 분포 (파이 차트)\n  const scoreDistribution = [\n    { name: \"90-100점\", value: sortedResults.filter(r => r.achievementRate >= 90).length, color: \"#10b981\" },\n    { name: \"80-89점\", value: sortedResults.filter(r => r.achievementRate >= 80 && r.achievementRate < 90).length, color: \"#3b82f6\" },\n    { name: \"70-79점\", value: sortedResults.filter(r => r.achievementRate >= 70 && r.achievementRate < 80).length, color: \"#f59e0b\" },\n    { name: \"60-69점\", value: sortedResults.filter(r => r.achievementRate >= 60 && r.achievementRate < 70).length, color: \"#ef4444\" },\n    { name: \"60점 미만\", value: sortedResults.filter(r => r.achievementRate < 60).length, color: \"#991b1b\" },\n  ].filter(item => item.value > 0);\n\n  // 타임라인 데이터\n  const timelineData = sortedResults.slice(0, 15).reverse().map((result, index) => ({\n    name: `${index + 1}`,\n    성취율: result.achievementRate,\n    단원: result.unit,\n    date: new Date(result.submittedAt).toLocaleDateString(\"ko-KR\", { month: \"short\", day: \"numeric\" }),\n  }));\n\n  // 배지/업적 시스템\n  const achievements = [];\n  if (sortedResults.some(r => r.achievementRate === 100)) {\n    achievements.push({ icon: Sparkles, name: \"완벽주의자\", description: \"100점을 받았어요!\", color: \"text-yellow-600\", bgColor: \"bg-yellow-500/20\" });\n  }\n  if (totalTests >= 10) {\n    achievements.push({ icon: Target, name: \"열심히 공부\", description: \"10회 이상 응시\", color: \"text-blue-600\", bgColor: \"bg-blue-500/20\" });\n  }\n  if (averageScore >= 90) {\n    achievements.push({ icon: Star, name: \"최우등생\", description: \"평균 90점 이상\", color: \"text-purple-600\", bgColor: \"bg-purple-500/20\" });\n  }\n  if (improvement > 10) {\n    achievements.push({ icon: TrendingUp, name: \"성장형 인재\", description: \"최근 성적 향상\", color: \"text-green-600\", bgColor: \"bg-green-500/20\" });\n  }\n  if (sortedResults.length >= 5 && sortedResults.slice(0, 5).every(r => r.achievementRate >= 80)) {\n    achievements.push({ icon: Zap, name: \"연속 고득점\", description: \"최근 5회 80점 이상\", color: \"text-orange-600\", bgColor: \"bg-orange-500/20\" });\n  }\n\n  return (\n    <div className=\"space-y-8\">\n      {/* 헤더 */}\n      <div className=\"text-center space-y-3\">\n        <div className=\"flex items-center justify-center gap-3\">\n          {showBackButton && onBack && (\n            <Button variant=\"outline\" onClick={onBack} className=\"mr-auto\">\n              뒤로\n            </Button>\n          )}\n          <Brain className=\"w-10 h-10 text-primary\" />\n          <h1 className=\"text-4xl font-bold\">학습 성과 분석</h1>\n        </div>\n        {studentName && (\n          <p className=\"text-lg text-muted-foreground\">\n            {studentName} {studentId && `(${studentId})`}\n          </p>\n        )}\n      </div>\n\n      {/* 주요 통계 */}\n      <div className=\"grid md:grid-cols-4 gap-6\">\n        <Card className=\"border-2 border-primary/20 shadow-lg hover-elevate\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">총 응시 횟수</CardTitle>\n            <Calendar className=\"h-5 w-5 text-primary\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-4xl font-bold font-mono text-primary\">{totalTests}</div>\n            <p className=\"text-xs text-muted-foreground mt-2\">누적 시험 응시</p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-2 border-blue-500/20 shadow-lg hover-elevate\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">평균 성취율</CardTitle>\n            <TrendingUp className=\"h-5 w-5 text-blue-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-4xl font-bold font-mono text-blue-600\">{averageScore}%</div>\n            <Progress value={averageScore} className=\"mt-2 h-2\" />\n            <p className=\"text-xs text-muted-foreground mt-1\">전체 평균 점수</p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-2 border-green-500/20 shadow-lg hover-elevate\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">최고 점수</CardTitle>\n            <Award className=\"h-5 w-5 text-green-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-4xl font-bold font-mono text-green-600\">{bestScore}%</div>\n            <p className=\"text-xs text-muted-foreground mt-2\">역대 최고 기록</p>\n          </CardContent>\n        </Card>\n\n        <Card className={`border-2 shadow-lg hover-elevate ${\n          improvement > 0 ? \"border-green-500/20\" : improvement < 0 ? \"border-red-500/20\" : \"border-gray-500/20\"\n        }`}>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">최근 향상도</CardTitle>\n            {improvement > 0 ? (\n              <TrendingUp className=\"h-5 w-5 text-green-600\" />\n            ) : improvement < 0 ? (\n              <TrendingDown className=\"h-5 w-5 text-red-600\" />\n            ) : (\n              <Target className=\"h-5 w-5 text-gray-600\" />\n            )}\n          </CardHeader>\n          <CardContent>\n            <div className={`text-4xl font-bold font-mono ${\n              improvement > 0 ? \"text-green-600\" : improvement < 0 ? \"text-red-600\" : \"text-gray-600\"\n            }`}>\n              {improvement > 0 ? \"+\" : \"\"}{improvement}%\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-2\">\n              {improvement > 0 ? \"상승 중!\" : improvement < 0 ? \"하락 중...\" : \"유지 중\"}\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* 탭 메뉴 */}\n      <Tabs defaultValue=\"overall\" className=\"space-y-6\">\n        <TabsList className=\"grid w-full grid-cols-2\">\n          <TabsTrigger value=\"overall\">전체 성적 분석</TabsTrigger>\n          <TabsTrigger value=\"units\">단원별 성적표</TabsTrigger>\n        </TabsList>\n\n        {/* 전체 성적 분석 탭 */}\n        <TabsContent value=\"overall\" className=\"space-y-6\">\n          {/* 업적 배지 */}\n          {achievements.length > 0 && (\n            <Card className=\"shadow-lg border-2\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Trophy className=\"w-6 h-6 text-yellow-600\" />\n                  획득한 업적\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4\">\n                  {achievements.map((achievement, idx) => (\n                    <div\n                      key={idx}\n                      className={`p-4 rounded-xl border-2 text-center ${achievement.bgColor} border-opacity-30 hover-elevate`}\n                    >\n                      <achievement.icon className={`w-8 h-8 mx-auto mb-2 ${achievement.color}`} />\n                      <p className=\"font-semibold text-sm mb-1\">{achievement.name}</p>\n                      <p className=\"text-xs text-muted-foreground\">{achievement.description}</p>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* 강점/약점 분석 */}\n          {chartData.length > 1 && (\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              <Card className=\"shadow-lg border-2 border-green-500/20\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-green-700\">\n                    <Star className=\"w-5 h-5\" />\n                    가장 강한 단원\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"text-center p-6 bg-green-500/10 rounded-xl\">\n                    <BookOpen className=\"w-12 h-12 mx-auto mb-3 text-green-600\" />\n                    <p className=\"text-2xl font-bold mb-2\">{strongestUnit?.fullName}</p>\n                    <Badge className=\"text-xl px-4 py-1 bg-green-600\">\n                      평균 {strongestUnit?.평균점수}점\n                    </Badge>\n                    <p className=\"text-sm text-muted-foreground mt-3\">\n                      {strongestUnit?.응시횟수}회 응시 · 이 실력을 유지하세요!\n                    </p>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"shadow-lg border-2 border-orange-500/20\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-orange-700\">\n                    <Target className=\"w-5 h-5\" />\n                    보완이 필요한 단원\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"text-center p-6 bg-orange-500/10 rounded-xl\">\n                    <BookOpen className=\"w-12 h-12 mx-auto mb-3 text-orange-600\" />\n                    <p className=\"text-2xl font-bold mb-2\">{weakestUnit?.fullName}</p>\n                    <Badge className=\"text-xl px-4 py-1 bg-orange-600\">\n                      평균 {weakestUnit?.평균점수}점\n                    </Badge>\n                    <p className=\"text-sm text-muted-foreground mt-3\">\n                      {weakestUnit?.응시횟수}회 응시 · 집중 학습이 필요합니다\n                    </p>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          {/* 차트 섹션 */}\n          <div className=\"grid lg:grid-cols-2 gap-6\">\n            {/* 레이더 차트 */}\n            {radarData.length >= 3 && (\n              <Card className=\"shadow-lg\">\n                <CardHeader>\n                  <CardTitle>단원별 역량 분석</CardTitle>\n                  <CardDescription>\n                    각 단원의 균형잡힌 이해도를 확인하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <ResponsiveContainer width=\"100%\" height={300}>\n                    <RadarChart data={radarData}>\n                      <PolarGrid stroke=\"hsl(var(--border))\" />\n                      <PolarAngleAxis dataKey=\"subject\" className=\"text-xs\" />\n                      <PolarRadiusAxis angle={90} domain={[0, 100]} />\n                      <Radar\n                        name=\"평균 점수\"\n                        dataKey=\"score\"\n                        stroke=\"hsl(var(--primary))\"\n                        fill=\"hsl(var(--primary))\"\n                        fillOpacity={0.6}\n                      />\n                      <Tooltip />\n                    </RadarChart>\n                  </ResponsiveContainer>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* 성적 분포 파이 차트 */}\n            {scoreDistribution.length > 0 && (\n              <Card className=\"shadow-lg\">\n                <CardHeader>\n                  <CardTitle>성적 분포</CardTitle>\n                  <CardDescription>\n                    점수대별 시험 결과 비율\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <ResponsiveContainer width=\"100%\" height={300}>\n                    <PieChart>\n                      <Pie\n                        data={scoreDistribution}\n                        cx=\"50%\"\n                        cy=\"50%\"\n                        labelLine={false}\n                        label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}\n                        outerRadius={90}\n                        fill=\"#8884d8\"\n                        dataKey=\"value\"\n                      >\n                        {scoreDistribution.map((entry, index) => (\n                          <Cell key={`cell-${index}`} fill={entry.color} />\n                        ))}\n                      </Pie>\n                      <Tooltip />\n                    </PieChart>\n                  </ResponsiveContainer>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n\n          {/* 단원별 성취율 바 차트 */}\n          {chartData.length > 0 && (\n            <Card className=\"shadow-lg\">\n              <CardHeader>\n                <CardTitle>단원별 평균 성취율</CardTitle>\n                <CardDescription>\n                  각 단원의 평균 점수와 응시 횟수\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <ResponsiveContainer width=\"100%\" height={400}>\n                  <BarChart data={chartData} layout=\"vertical\">\n                    <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                    <XAxis type=\"number\" domain={[0, 100]} />\n                    <YAxis dataKey=\"name\" type=\"category\" width={100} className=\"text-xs\" />\n                    <Tooltip />\n                    <Bar dataKey=\"평균점수\" fill=\"hsl(var(--primary))\" radius={[0, 8, 8, 0]} />\n                  </BarChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* 성적 추이 라인 차트 */}\n          {timelineData.length > 0 && (\n            <Card className=\"shadow-lg\">\n              <CardHeader>\n                <CardTitle>성적 변화 추이</CardTitle>\n                <CardDescription>\n                  최근 시험의 성취율 변화를 확인하세요\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <ResponsiveContainer width=\"100%\" height={350}>\n                  <LineChart data={timelineData}>\n                    <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n                    <XAxis dataKey=\"name\" />\n                    <YAxis domain={[0, 100]} />\n                    <Tooltip />\n                    <Line\n                      type=\"monotone\"\n                      dataKey=\"성취율\"\n                      stroke=\"hsl(var(--chart-1))\"\n                      strokeWidth={3}\n                      dot={{ fill: \"hsl(var(--chart-1))\", r: 5 }}\n                    />\n                    <Legend />\n                  </LineChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n          )}\n        </TabsContent>\n\n        {/* 단원별 성적표 탭 */}\n        <TabsContent value=\"units\" className=\"space-y-4\">\n          <Card className=\"shadow-lg\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <BookOpen className=\"w-6 h-6\" />\n                단원별 성적표\n              </CardTitle>\n              <CardDescription>\n                각 단원별로 시험 결과를 확인하세요\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-6\">\n                {Object.values(unitData)\n                  .sort((a, b) => (b.totalScore / b.count) - (a.totalScore / a.count))\n                  .map((unit) => {\n                    const avgScore = Math.round(unit.totalScore / unit.count);\n                    const gradeColor = avgScore >= 90 ? \"text-green-600\" :\n                                      avgScore >= 80 ? \"text-blue-600\" :\n                                      avgScore >= 70 ? \"text-yellow-600\" :\n                                      avgScore >= 60 ? \"text-orange-600\" : \"text-red-600\";\n                    const gradeBg = avgScore >= 90 ? \"bg-green-500/10\" :\n                                   avgScore >= 80 ? \"bg-blue-500/10\" :\n                                   avgScore >= 70 ? \"bg-yellow-500/10\" :\n                                   avgScore >= 60 ? \"bg-orange-500/10\" : \"bg-red-500/10\";\n\n                    return (\n                      <div key={unit.unit} className={`p-6 rounded-xl border-2 ${gradeBg}`}>\n                        <div className=\"flex items-center justify-between mb-4\">\n                          <h3 className=\"text-2xl font-bold\">{unit.unit}</h3>\n                          <div className=\"flex items-center gap-4\">\n                            <Badge className={`text-xl px-4 py-1 ${gradeBg} ${gradeColor}`}>\n                              평균 {avgScore}점\n                            </Badge>\n                            <Badge variant=\"outline\">\n                              {unit.count}회 응시\n                            </Badge>\n                          </div>\n                        </div>\n                        <div className=\"space-y-2\">\n                          {unit.results\n                            .sort((a, b) => new Date(b.submittedAt).getTime() - new Date(a.submittedAt).getTime())\n                            .map((result, idx) => (\n                            <div key={idx} className=\"flex items-center justify-between p-4 rounded-lg bg-card border hover-elevate cursor-pointer\" onClick={() => setSelectedResult(result)}>\n                              <div className=\"flex-1\">\n                                <Calendar className=\"w-4 h-4 inline mr-2 text-muted-foreground\" />\n                                <span className=\"text-sm\">\n                                  {new Date(result.submittedAt).toLocaleString(\"ko-KR\", {\n                                    year: \"numeric\",\n                                    month: \"long\",\n                                    day: \"numeric\",\n                                    hour: \"2-digit\",\n                                    minute: \"2-digit\",\n                                  })}\n                                </span>\n                              </div>\n                              <div className=\"flex items-center gap-3\">\n                                <span className=\"text-sm text-muted-foreground\">\n                                  {result.correctAnswers} / {result.totalQuestions} 정답\n                                </span>\n                                <Badge className={`font-mono ${\n                                  result.achievementRate >= 90 ? \"bg-green-600\" :\n                                  result.achievementRate >= 80 ? \"bg-blue-600\" :\n                                  result.achievementRate >= 70 ? \"bg-yellow-600\" :\n                                  result.achievementRate >= 60 ? \"bg-orange-600\" : \"bg-red-600\"\n                                }`}>\n                                  {result.achievementRate}%\n                                </Badge>\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={(e) => {\n                                    e.stopPropagation();\n                                    setSelectedResult(result);\n                                  }}\n                                  data-testid={`button-view-detail-${idx}`}\n                                >\n                                  <Eye className=\"w-4 h-4 mr-1\" />\n                                  상세 보기\n                                </Button>\n                              </div>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    );\n                  })}\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n\n      {/* 시험 결과 상세 모달 */}\n      {renderResultDetail()}\n    </div>\n  );\n}\n","path":null,"size_bytes":31237,"size_tokens":null},"shared/schema.ts":{"content":"import { pgTable, text, varchar, integer, timestamp, serial, boolean, json, uniqueIndex } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\nimport { relations } from \"drizzle-orm\";\n\n// Schools table\nexport const schools = pgTable(\"schools\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull().unique(),\n});\n\n// Exams table (학교별 시험 정보)\nexport const exams = pgTable(\"exams\", {\n  id: serial(\"id\").primaryKey(),\n  schoolId: integer(\"school_id\").notNull().references(() => schools.id),\n  schoolName: text(\"school_name\").notNull(),\n  year: integer(\"year\").notNull(),\n  semester: text(\"semester\").notNull(), // \"2학기 중간\", \"2학기 기말\" 등\n  subject: text(\"subject\").notNull().default(\"통합과학\"),\n});\n\n// Questions table (문항별 정답 정보)\nexport const questions = pgTable(\"questions\", {\n  id: serial(\"id\").primaryKey(),\n  examId: integer(\"exam_id\").notNull().references(() => exams.id),\n  questionNumber: integer(\"question_number\").notNull(),\n  type: varchar(\"type\", { length: 20 }).notNull(), // \"객관식\" or \"주관식\"\n  category: text(\"category\").notNull(), // \"에너지\", \"화학\", \"생태계\" 등\n  unit: text(\"unit\").notNull(), // \"전자기 유도\", \"산화-환원\" 등\n  answer: text(\"answer\").notNull(), // 단일 정답 또는 복수 정답 (JSON array)\n  isMultipleAnswer: boolean(\"is_multiple_answer\").notNull().default(false),\n}, (table) => ({\n  uniqueQuestionPerExam: uniqueIndex(\"unique_question_per_exam\").on(table.examId, table.questionNumber),\n}));\n\n// Students table\nexport const students = pgTable(\"students\", {\n  id: serial(\"id\").primaryKey(),\n  studentId: varchar(\"student_id\", { length: 50 }).notNull().unique(),\n  studentName: text(\"student_name\").notNull(),\n  grade: text(\"grade\").notNull(),\n  phone: varchar(\"phone\", { length: 20 }),\n});\n\n// Submissions table (학생 답안 제출 기록)\nexport const submissions = pgTable(\"submissions\", {\n  id: serial(\"id\").primaryKey(),\n  studentId: varchar(\"student_id\", { length: 50 }).notNull(),\n  studentName: text(\"student_name\").notNull(),\n  examId: integer(\"exam_id\").notNull().references(() => exams.id),\n  submittedAt: timestamp(\"submitted_at\").notNull().defaultNow(),\n  answers: text(\"answers\").notNull(), // JSON string of student answers\n  score: integer(\"score\").notNull(),\n  totalQuestions: integer(\"total_questions\").notNull(),\n  answeredQuestions: integer(\"answered_questions\").notNull(),\n  correctAnswers: integer(\"correct_answers\").notNull(),\n  achievementRate: integer(\"achievement_rate\").notNull(),\n  unitResults: text(\"unit_results\").notNull(), // JSON string of unit-wise results\n});\n\n// Settings table for app configuration\nexport const settings = pgTable(\"settings\", {\n  id: serial(\"id\").primaryKey(),\n  key: varchar(\"key\", { length: 100 }).notNull().unique(),\n  value: text(\"value\").notNull(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\n// Relations - defined after all tables are declared\nexport const schoolsRelations = relations(schools, ({ many }) => ({\n  exams: many(exams),\n}));\n\nexport const examsRelations = relations(exams, ({ one, many }) => ({\n  school: one(schools, {\n    fields: [exams.schoolId],\n    references: [schools.id],\n  }),\n  questions: many(questions),\n  submissions: many(submissions),\n}));\n\nexport const questionsRelations = relations(questions, ({ one }) => ({\n  exam: one(exams, {\n    fields: [questions.examId],\n    references: [exams.id],\n  }),\n}));\n\nexport const studentsRelations = relations(students, ({ many }) => ({\n  submissions: many(submissions),\n}));\n\nexport const submissionsRelations = relations(submissions, ({ one }) => ({\n  student: one(students, {\n    fields: [submissions.studentId],\n    references: [students.studentId],\n  }),\n  exam: one(exams, {\n    fields: [submissions.examId],\n    references: [exams.id],\n  }),\n}));\n\n// Insert schemas\nexport const insertSchoolSchema = createInsertSchema(schools).omit({\n  id: true,\n});\n\nexport const insertExamSchema = createInsertSchema(exams).omit({\n  id: true,\n});\n\nexport const insertQuestionSchema = createInsertSchema(questions).omit({\n  id: true,\n});\n\nexport const insertStudentSchema = createInsertSchema(students).omit({\n  id: true,\n});\n\nexport const insertSubmissionSchema = createInsertSchema(submissions).omit({\n  id: true,\n  submittedAt: true,\n});\n\nexport const insertSettingSchema = createInsertSchema(settings).omit({\n  id: true,\n  updatedAt: true,\n});\n\n// Types\nexport type School = typeof schools.$inferSelect;\nexport type InsertSchool = z.infer<typeof insertSchoolSchema>;\n\nexport type Exam = typeof exams.$inferSelect;\nexport type InsertExam = z.infer<typeof insertExamSchema>;\n\nexport type Question = typeof questions.$inferSelect;\nexport type InsertQuestion = z.infer<typeof insertQuestionSchema>;\n\nexport type Student = typeof students.$inferSelect;\nexport type InsertStudent = z.infer<typeof insertStudentSchema>;\n\nexport type Submission = typeof submissions.$inferSelect;\nexport type InsertSubmission = z.infer<typeof insertSubmissionSchema>;\n\nexport type Setting = typeof settings.$inferSelect;\nexport type InsertSetting = z.infer<typeof insertSettingSchema>;\n\n// Additional schemas for API\nexport const studentAnswerSchema = z.object({\n  questionNumber: z.number(),\n  answer: z.string(),\n});\n\nexport type StudentAnswer = z.infer<typeof studentAnswerSchema>;\n\nexport const submitTestSchema = z.object({\n  studentId: z.string(),\n  studentName: z.string(),\n  examId: z.number(),\n  answers: z.array(studentAnswerSchema),\n});\n\nexport type SubmitTest = z.infer<typeof submitTestSchema>;\n\nexport const submitUnitTestSchema = z.object({\n  studentId: z.string().min(1, \"학생 ID가 필요합니다\"),\n  studentName: z.string().min(1, \"이름이 필요합니다\"),\n  unitName: z.string().min(1, \"단원명이 필요합니다\"),\n  answers: z.array(studentAnswerSchema),\n});\n\nexport type SubmitUnitTest = z.infer<typeof submitUnitTestSchema>;\n\nexport const loginSchema = z.object({\n  studentId: z.string().min(1, \"학생 ID를 입력해주세요\"),\n  studentName: z.string().min(1, \"이름을 입력해주세요\"),\n});\n\nexport type Login = z.infer<typeof loginSchema>;\n\n// Constants - 중등 통합과학 선행 단원 분류 (런지 교재)\nexport const categories = [\n  \"물질\",\n  \"생명\",\n  \"에너지\",\n] as const;\n\nexport type Category = typeof categories[number];\n\nexport const units = [\n  \"물질의 규칙성과 결합\",\n  \"생명체 구성 물질\",\n  \"물질의 전기적 성질\",\n  \"역학적 시스템\",\n  \"생명 시스템\",\n  \"화학 변화 (산화 환원)\",\n  \"화학 변화 (산과 염기)\",\n  \"발전과 신재생 에너지 (태양 에너지)\",\n  \"발전과 신재생 에너지 (전자기 유도)\",\n  \"발전과 신재생 에너지 (에너지 전환 및 신재생)\",\n] as const;\n\nexport type Unit = typeof units[number];\n\nexport const SUBJECT_NAME = \"중등 통합과학 선행\";\n\n// 단원별 문제 번호 범위 (런지 교재 기준)\nexport const unitQuestionRanges: Record<string, { start: number; end: number; excludes?: number[] }> = {\n  \"물질의 규칙성과 결합\": { start: 1, end: 37 },\n  \"생명체 구성 물질\": { start: 38, end: 55 },\n  \"물질의 전기적 성질\": { start: 56, end: 77 },\n  \"역학적 시스템\": { start: 78, end: 97, excludes: [91] },\n  \"생명 시스템\": { start: 98, end: 115 },\n  \"화학 변화 (산화 환원)\": { start: 116, end: 146 },\n  \"화학 변화 (산과 염기)\": { start: 147, end: 188 },\n  \"발전과 신재생 에너지 (태양 에너지)\": { start: 189, end: 214 },\n  \"발전과 신재생 에너지 (전자기 유도)\": { start: 215, end: 248 },\n  \"발전과 신재생 에너지 (에너지 전환 및 신재생)\": { start: 249, end: 312 },\n};\n\n// 단원별 카테고리 매핑\nexport const unitCategoryMap: Record<string, string> = {\n  \"물질의 규칙성과 결합\": \"물질\",\n  \"생명체 구성 물질\": \"생명\",\n  \"물질의 전기적 성질\": \"물질\",\n  \"역학적 시스템\": \"에너지\",\n  \"생명 시스템\": \"생명\",\n  \"화학 변화 (산화 환원)\": \"물질\",\n  \"화학 변화 (산과 염기)\": \"물질\",\n  \"발전과 신재생 에너지 (태양 에너지)\": \"에너지\",\n  \"발전과 신재생 에너지 (전자기 유도)\": \"에너지\",\n  \"발전과 신재생 에너지 (에너지 전환 및 신재생)\": \"에너지\",\n};\n\n// Unit result interface for detailed feedback\nexport interface UnitResult {\n  category: string;\n  unit: string;\n  total: number;\n  correct: number;\n  wrong: number;\n  unanswered: number;\n  achievementRate: number;\n}\n","path":null,"size_bytes":8545,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"client/src/pages/result.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { \n  CheckCircle2, XCircle, Home, BarChart3, Trophy, Target, GraduationCap, \n  User, TrendingUp, Award, Zap, AlertCircle, BookOpen, Star, Brain,\n  ChevronRight, Activity, FileText\n} from \"lucide-react\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { \n  BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, \n  Legend, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar,\n  LineChart, Line, Cell\n} from \"recharts\";\nimport type { UnitResult } from \"@shared/schema\";\n\ninterface ResultData {\n  submissionId: number;\n  score: number;\n  totalQuestions: number;\n  answeredQuestions: number;\n  correctAnswers: number;\n  achievementRate: number;\n  unitResults: UnitResult[];\n  examId: number;\n  details: Array<{\n    questionNumber: number;\n    studentAnswer: string;\n    correctAnswer: string;\n    isCorrect: boolean;\n    isMultipleAnswer: boolean;\n  }>;\n}\n\ninterface UnitStats {\n  category: string;\n  unit: string;\n  average: number;\n  highest: number;\n  studentCount: number;\n}\n\nexport default function ResultPage() {\n  const [, setLocation] = useLocation();\n  const [result, setResult] = useState<ResultData | null>(null);\n\n  useEffect(() => {\n    const resultData = sessionStorage.getItem(\"testResult\");\n    if (!resultData) {\n      setLocation(\"/schools\");\n      return;\n    }\n    setResult(JSON.parse(resultData));\n  }, [setLocation]);\n\n  // Fetch unit statistics\n  const { data: unitStats } = useQuery<UnitStats[]>({\n    queryKey: result ? [`/api/exams/${result.examId}/unit-stats`] : [],\n    enabled: !!result,\n  });\n\n  if (!result) {\n    return null;\n  }\n\n  const isPerfect = result.correctAnswers === result.answeredQuestions;\n  const incorrectAnswers = result.answeredQuestions - result.correctAnswers;\n  const unansweredQuestions = result.totalQuestions - result.answeredQuestions;\n  \n  const getGrade = (rate: number) => {\n    if (rate === 100) return { \n      grade: \"S\", \n      color: \"text-yellow-600 dark:text-yellow-400\", \n      bgColor: \"bg-yellow-500/20\", \n      borderColor: \"border-yellow-500\",\n      desc: \"완벽\" \n    };\n    if (rate >= 90) return { \n      grade: \"A+\", \n      color: \"text-green-600 dark:text-green-400\", \n      bgColor: \"bg-green-500/20\", \n      borderColor: \"border-green-500\",\n      desc: \"우수\" \n    };\n    if (rate >= 80) return { \n      grade: \"A\", \n      color: \"text-green-600 dark:text-green-500\", \n      bgColor: \"bg-green-500/20\", \n      borderColor: \"border-green-500\",\n      desc: \"우수\" \n    };\n    if (rate >= 70) return { \n      grade: \"B+\", \n      color: \"text-blue-600 dark:text-blue-400\", \n      bgColor: \"bg-blue-500/20\", \n      borderColor: \"border-blue-500\",\n      desc: \"양호\" \n    };\n    if (rate >= 60) return { \n      grade: \"B\", \n      color: \"text-blue-600 dark:text-blue-500\", \n      bgColor: \"bg-blue-500/20\", \n      borderColor: \"border-blue-500\",\n      desc: \"양호\" \n    };\n    if (rate >= 50) return { \n      grade: \"C\", \n      color: \"text-orange-600 dark:text-orange-400\", \n      bgColor: \"bg-orange-500/20\", \n      borderColor: \"border-orange-500\",\n      desc: \"보통\" \n    };\n    return { \n      grade: \"D\", \n      color: \"text-red-600 dark:text-red-400\", \n      bgColor: \"bg-red-500/20\", \n      borderColor: \"border-red-500\",\n      desc: \"노력 필요\" \n    };\n  };\n\n  const gradeInfo = getGrade(result.achievementRate);\n\n  const getDetailedStudentFeedback = (rate: number, unitResults: UnitResult[]) => {\n    const strongUnits = unitResults.filter(u => u.achievementRate >= 80 && u.total > 0);\n    const weakUnits = unitResults.filter(u => u.achievementRate < 60 && u.total > 0);\n    const moderateUnits = unitResults.filter(u => u.achievementRate >= 60 && u.achievementRate < 80 && u.total > 0);\n\n    let mainMessage = \"\";\n    let encouragement = \"\";\n    let specificAdvice: string[] = [];\n\n    if (rate === 100) {\n      mainMessage = \"완벽한 성적입니다! 모든 문제를 정확하게 풀었어요.\";\n      encouragement = \"탁월한 이해력과 문제 해결 능력을 보여주셨습니다. 이 실력을 계속 유지하세요!\";\n      specificAdvice = [\n        \"심화 문제나 올림피아드 문제에 도전해보세요\",\n        \"다른 학생들에게 개념을 설명해주며 리더십을 발휘해보세요\",\n        \"관련 과학 도서나 논문을 읽어 지식의 폭을 넓혀보세요\"\n      ];\n    } else if (rate >= 90) {\n      mainMessage = \"우수한 성적입니다! 대부분의 개념을 완벽하게 이해하고 있어요.\";\n      encouragement = \"거의 완벽에 가까운 실력입니다. 조금만 더 집중하면 만점도 가능해요!\";\n      specificAdvice = [\n        \"틀린 문제의 개념을 정확히 복습하세요\",\n        \"유사한 유형의 문제를 추가로 풀어보세요\",\n        \"실수를 줄이기 위해 문제를 꼼꼼히 읽는 습관을 기르세요\"\n      ];\n    } else if (rate >= 70) {\n      mainMessage = \"잘했습니다! 핵심 개념을 잘 이해하고 있어요.\";\n      encouragement = \"기본기가 탄탄합니다. 조금 더 노력하면 더 좋은 성적을 얻을 수 있어요!\";\n      specificAdvice = [\n        \"틀린 문제는 반드시 다시 풀어보세요\",\n        \"개념 노트를 만들어 정리하는 습관을 가지세요\",\n        \"선생님께 질문하여 부족한 부분을 보완하세요\"\n      ];\n    } else if (rate >= 50) {\n      mainMessage = \"기본 개념은 이해하고 있어요. 조금 더 노력이 필요합니다.\";\n      encouragement = \"포기하지 마세요! 꾸준히 공부하면 실력이 향상될 거예요.\";\n      specificAdvice = [\n        \"교과서를 정독하며 기본 개념을 확실히 이해하세요\",\n        \"핵심 용어와 공식을 정리하여 암기하세요\",\n        \"기출 문제를 반복해서 풀며 유형에 익숙해지세요\"\n      ];\n    } else {\n      mainMessage = \"기초부터 차근차근 다시 학습해봐요.\";\n      encouragement = \"어려워도 포기하지 마세요. 선생님과 함께 천천히 배워나가면 됩니다.\";\n      specificAdvice = [\n        \"선생님께 기초부터 다시 설명을 들으세요\",\n        \"교과서의 예제 문제부터 차근차근 풀어보세요\",\n        \"틀린 문제를 오답노트에 정리하고 반복 학습하세요\"\n      ];\n    }\n\n    return {\n      mainMessage,\n      encouragement,\n      specificAdvice,\n      strongUnits,\n      weakUnits,\n      moderateUnits\n    };\n  };\n\n  const getTeacherGuidance = (unitResults: UnitResult[], totalRate: number) => {\n    const weakUnits = unitResults.filter(u => u.achievementRate < 70 && u.total > 0);\n    const strongUnits = unitResults.filter(u => u.achievementRate >= 90 && u.total > 0);\n    const moderateUnits = unitResults.filter(u => u.achievementRate >= 70 && u.achievementRate < 90 && u.total > 0);\n\n    const guidance = [];\n\n    // Overall assessment\n    if (totalRate >= 90) {\n      guidance.push({\n        type: \"excellent\",\n        icon: Trophy,\n        title: \"종합 평가: 우수\",\n        content: \"학생이 전반적인 개념을 매우 잘 이해하고 있습니다.\",\n        action: \"심화 학습 자료를 제공하여 더 깊은 탐구 활동을 유도하세요.\"\n      });\n    } else if (totalRate >= 70) {\n      guidance.push({\n        type: \"good\",\n        icon: CheckCircle2,\n        title: \"종합 평가: 양호\",\n        content: \"핵심 개념은 이해하고 있으나 일부 보완이 필요합니다.\",\n        action: \"틀린 문제 위주로 개념을 재설명하고 유사 문제를 제공하세요.\"\n      });\n    } else if (totalRate >= 50) {\n      guidance.push({\n        type: \"needs-improvement\",\n        icon: AlertCircle,\n        title: \"종합 평가: 보완 필요\",\n        content: \"기본 개념 이해도가 부족합니다.\",\n        action: \"기초 개념부터 차근차근 재교육이 필요합니다. 1:1 면담을 권장합니다.\"\n      });\n    } else {\n      guidance.push({\n        type: \"critical\",\n        icon: XCircle,\n        title: \"종합 평가: 긴급 개입 필요\",\n        content: \"학습 결손이 심각합니다. 즉각적인 지도가 필요합니다.\",\n        action: \"학부모 상담과 함께 개별 맞춤 학습 계획을 수립하세요.\"\n      });\n    }\n\n    // Strong units\n    if (strongUnits.length > 0) {\n      guidance.push({\n        type: \"strength\",\n        icon: Star,\n        title: `우수 단원 (${strongUnits.length}개)`,\n        content: strongUnits.map(u => `${u.unit} (${u.achievementRate}%)`).join(\", \"),\n        action: \"이 단원들과 연계된 심화 활동이나 프로젝트 학습을 진행하세요.\"\n      });\n    }\n\n    // Moderate units\n    if (moderateUnits.length > 0) {\n      guidance.push({\n        type: \"moderate\",\n        icon: Activity,\n        title: `보완 가능 단원 (${moderateUnits.length}개)`,\n        content: moderateUnits.map(u => `${u.unit} (${u.achievementRate}%)`).join(\", \"),\n        action: \"개념 정리 시간을 갖고, 추가 연습 문제를 제공하세요.\"\n      });\n    }\n\n    // Weak units\n    if (weakUnits.length > 0) {\n      guidance.push({\n        type: \"weak\",\n        icon: AlertCircle,\n        title: `집중 지도 필요 단원 (${weakUnits.length}개)`,\n        content: weakUnits.map(u => `${u.unit} (${u.achievementRate}%)`).join(\", \"),\n        action: \"기본 개념부터 재교육하고, 시각 자료와 실험을 활용한 구체적 설명이 필요합니다.\"\n      });\n    }\n\n    // Time management\n    if (unansweredQuestions > 0) {\n      guidance.push({\n        type: \"time\",\n        icon: Target,\n        title: \"시험 범위 외 문제\",\n        content: `${unansweredQuestions}개 문제가 시험 범위에 포함되지 않았습니다.`,\n        action: \"학생에게 시험 범위를 명확히 안내했는지 확인하세요.\"\n      });\n    }\n\n    return guidance;\n  };\n\n  // Filter out units with no answered questions (응시하지 않은 단원 제외)\n  const answeredUnitResults = result.unitResults.filter(unit => {\n    const answered = unit.correct + unit.wrong;\n    return answered > 0;\n  });\n\n  const studentFeedback = getDetailedStudentFeedback(result.achievementRate, answeredUnitResults);\n  const teacherGuidance = getTeacherGuidance(answeredUnitResults, result.achievementRate);\n\n  // 단원명 축약 함수\n  const shortenUnitName = (name: string, maxLen: number = 6): string => {\n    // 괄호 내용 제거하고 축약\n    const withoutParens = name.replace(/\\s*\\([^)]*\\)/g, '');\n    if (withoutParens.length <= maxLen) return withoutParens;\n    return withoutParens.substring(0, maxLen) + '...';\n  };\n\n  // Prepare chart data\n  const chartData = answeredUnitResults.map(unit => ({\n    name: shortenUnitName(unit.unit),\n    fullName: unit.unit,\n    나의성적: unit.achievementRate,\n    평균: unitStats?.find(s => s.category === unit.category && s.unit === unit.unit)?.average || 0,\n    최고점: unitStats?.find(s => s.category === unit.category && s.unit === unit.unit)?.highest || 0,\n  }));\n\n  const radarData = answeredUnitResults.map(unit => ({\n    unit: shortenUnitName(unit.unit, 5),\n    fullName: unit.unit,\n    value: unit.achievementRate,\n    fullMark: 100,\n  }));\n\n  const wrongQuestions = result.details\n    .filter(d => !d.isCorrect && d.studentAnswer)\n    .map(d => d.questionNumber)\n    .sort((a, b) => a - b);\n\n  const unansweredList = result.details\n    .filter(d => !d.studentAnswer)\n    .map(d => d.questionNumber)\n    .sort((a, b) => a - b);\n\n  const COLORS = ['#10b981', '#3b82f6', '#f59e0b', '#ef4444', '#8b5cf6', '#ec4899'];\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-primary/5 to-accent/10\">\n      <div className=\"container mx-auto px-4 py-8 max-w-7xl\">\n        <div className=\"space-y-6\">\n          {/* Header Card - 성적 요약 */}\n          <Card className={`border-2 shadow-2xl ${gradeInfo.borderColor}`}>\n            <CardHeader className=\"text-center space-y-6 pb-8\">\n              <div className=\"flex justify-center\">\n                <div className={`w-40 h-40 rounded-full flex flex-col items-center justify-center ${gradeInfo.bgColor} border-4 ${gradeInfo.borderColor} shadow-xl`}>\n                  <Trophy className={`w-16 h-16 ${gradeInfo.color} mb-2`} />\n                  <span className={`text-5xl font-bold ${gradeInfo.color}`}>\n                    {gradeInfo.grade}\n                  </span>\n                  <span className={`text-sm ${gradeInfo.color} mt-1`}>\n                    {gradeInfo.desc}\n                  </span>\n                </div>\n              </div>\n              <div>\n                <CardTitle className=\"text-4xl font-bold mb-3\">\n                  시험 결과 분석\n                </CardTitle>\n                <div className=\"flex justify-center gap-4 text-lg flex-wrap\">\n                  <Badge variant=\"outline\" className=\"text-xl font-mono px-4 py-2\">\n                    <Award className=\"w-5 h-5 mr-2\" />\n                    {result.achievementRate}점\n                  </Badge>\n                  <Badge variant=\"secondary\" className=\"text-xl px-4 py-2\">\n                    <CheckCircle2 className=\"w-5 h-5 mr-2\" />\n                    {result.correctAnswers} / {result.answeredQuestions} 정답\n                  </Badge>\n                  {isPerfect && (\n                    <Badge className=\"text-xl px-4 py-2 bg-yellow-500 hover:bg-yellow-600\">\n                      <Star className=\"w-5 h-5 mr-2\" />\n                      Perfect Score!\n                    </Badge>\n                  )}\n                </div>\n              </div>\n            </CardHeader>\n\n            <CardContent className=\"space-y-8\">\n              {/* 통계 그리드 */}\n              <div className=\"grid grid-cols-3 gap-6\">\n                <div className=\"text-center p-6 bg-green-500/10 dark:bg-green-500/20 rounded-xl border-2 border-green-500/30 hover-elevate\">\n                  <CheckCircle2 className=\"w-12 h-12 text-green-600 dark:text-green-400 mx-auto mb-3\" />\n                  <div className=\"text-4xl font-bold text-green-600 dark:text-green-400 mb-1\">\n                    {result.correctAnswers}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground font-medium\">정답</div>\n                </div>\n\n                <div className=\"text-center p-6 bg-red-500/10 dark:bg-red-500/20 rounded-xl border-2 border-red-500/30 hover-elevate\">\n                  <XCircle className=\"w-12 h-12 text-red-600 dark:text-red-400 mx-auto mb-3\" />\n                  <div className=\"text-4xl font-bold text-red-600 dark:text-red-400 mb-1\">\n                    {incorrectAnswers}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground font-medium\">오답</div>\n                </div>\n\n                <div className=\"text-center p-6 bg-gray-500/10 dark:bg-gray-500/20 rounded-xl border-2 border-gray-500/30 hover-elevate\">\n                  <FileText className=\"w-12 h-12 text-gray-600 dark:text-gray-400 mx-auto mb-3\" />\n                  <div className=\"text-4xl font-bold text-gray-600 dark:text-gray-400 mb-1\">\n                    {unansweredQuestions}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground font-medium\">시험범위 외</div>\n                </div>\n              </div>\n\n              {/* 응답률 프로그레스 */}\n              <div className=\"space-y-3 p-6 bg-card/50 rounded-xl border\">\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"font-semibold flex items-center gap-2\">\n                    <Activity className=\"w-4 h-4\" />\n                    문제 응답률\n                  </span>\n                  <span className=\"text-muted-foreground font-mono\">\n                    {result.answeredQuestions} / {result.totalQuestions} ({Math.round((result.answeredQuestions / result.totalQuestions) * 100)}%)\n                  </span>\n                </div>\n                <Progress \n                  value={(result.answeredQuestions / result.totalQuestions) * 100} \n                  className=\"h-4\" \n                />\n              </div>\n\n              {/* 틀린 문제 & 시험범위 외 */}\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                {wrongQuestions.length > 0 && (\n                  <div className=\"p-6 bg-red-500/10 dark:bg-red-500/20 rounded-xl border-2 border-red-500/30\">\n                    <h3 className=\"font-bold text-red-700 dark:text-red-400 mb-3 flex items-center gap-2 text-lg\">\n                      <XCircle className=\"w-5 h-5\" />\n                      틀린 문제 번호 ({wrongQuestions.length}개)\n                    </h3>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {wrongQuestions.map(q => (\n                        <Badge key={q} variant=\"destructive\" className=\"text-base px-3 py-1 font-mono\">\n                          {q}번\n                        </Badge>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {unansweredList.length > 0 && (\n                  <div className=\"p-6 bg-gray-500/10 dark:bg-gray-500/20 rounded-xl border-2 border-gray-500/30\">\n                    <h3 className=\"font-bold text-gray-700 dark:text-gray-400 mb-3 flex items-center gap-2 text-lg\">\n                      <FileText className=\"w-5 h-5\" />\n                      시험범위 외 문제 ({unansweredList.length}개)\n                    </h3>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {unansweredList.map(q => (\n                        <Badge key={q} variant=\"secondary\" className=\"text-base px-3 py-1 font-mono\">\n                          {q}번\n                        </Badge>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Main Content Tabs */}\n          <Tabs defaultValue=\"student\" className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-2 h-14\">\n              <TabsTrigger value=\"student\" data-testid=\"tab-student-feedback\" className=\"text-lg\">\n                <User className=\"w-5 h-5 mr-2\" />\n                학생용 분석\n              </TabsTrigger>\n              <TabsTrigger value=\"teacher\" data-testid=\"tab-teacher-feedback\" className=\"text-lg\">\n                <GraduationCap className=\"w-5 h-5 mr-2\" />\n                선생님용 지도안\n              </TabsTrigger>\n            </TabsList>\n\n            {/* 학생용 탭 */}\n            <TabsContent value=\"student\" className=\"space-y-6 mt-6\">\n              {/* 종합 피드백 */}\n              <Card className=\"border-2\">\n                <CardHeader className=\"space-y-2\">\n                  <CardTitle className=\"flex items-center gap-2 text-2xl\">\n                    <Brain className=\"w-7 h-7 text-primary\" />\n                    종합 평가\n                  </CardTitle>\n                  <CardDescription className=\"text-base\">\n                    당신의 시험 결과에 대한 상세 분석입니다\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div className=\"p-6 bg-primary/10 dark:bg-primary/20 rounded-xl border-2 border-primary/30\">\n                    <p className=\"text-xl font-semibold mb-3\">{studentFeedback.mainMessage}</p>\n                    <p className=\"text-lg text-muted-foreground\">{studentFeedback.encouragement}</p>\n                  </div>\n\n                  <div className=\"space-y-3\">\n                    <h4 className=\"font-bold text-lg flex items-center gap-2\">\n                      <Zap className=\"w-5 h-5 text-yellow-600\" />\n                      맞춤 학습 조언\n                    </h4>\n                    <div className=\"grid gap-3\">\n                      {studentFeedback.specificAdvice.map((tip, i) => (\n                        <div key={i} className=\"flex items-start gap-3 p-4 bg-card/50 rounded-lg border hover-elevate\">\n                          <div className=\"flex-shrink-0 w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center font-bold\">\n                            {i + 1}\n                          </div>\n                          <span className=\"text-base pt-1\">{tip}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n\n                  {/* 단원별 성취도 요약 */}\n                  {studentFeedback.strongUnits.length > 0 && (\n                    <div className=\"p-5 bg-green-500/10 dark:bg-green-500/20 rounded-xl border border-green-500/30\">\n                      <h4 className=\"font-bold text-green-700 dark:text-green-400 mb-3 flex items-center gap-2\">\n                        <Star className=\"w-5 h-5\" />\n                        우수한 단원 ({studentFeedback.strongUnits.length}개)\n                      </h4>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {studentFeedback.strongUnits.map((unit, i) => (\n                          <Badge key={i} className=\"bg-green-600 hover:bg-green-700 text-base px-3 py-1\">\n                            {unit.unit} {unit.achievementRate}%\n                          </Badge>\n                        ))}\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mt-3\">\n                        이 단원들은 완벽하게 이해하고 있어요!\n                      </p>\n                    </div>\n                  )}\n\n                  {studentFeedback.weakUnits.length > 0 && (\n                    <div className=\"p-5 bg-orange-500/10 dark:bg-orange-500/20 rounded-xl border border-orange-500/30\">\n                      <h4 className=\"font-bold text-orange-700 dark:text-orange-400 mb-3 flex items-center gap-2\">\n                        <BookOpen className=\"w-5 h-5\" />\n                        복습이 필요한 단원 ({studentFeedback.weakUnits.length}개)\n                      </h4>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {studentFeedback.weakUnits.map((unit, i) => (\n                          <Badge key={i} variant=\"destructive\" className=\"text-base px-3 py-1\">\n                            {unit.unit} {unit.achievementRate}%\n                          </Badge>\n                        ))}\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mt-3\">\n                        이 단원들을 집중적으로 복습하면 성적이 크게 향상될 거예요!\n                      </p>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* 단원별 성취도 비교 차트 */}\n              <Card className=\"border-2\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-2xl\">\n                    <BarChart3 className=\"w-7 h-7 text-primary\" />\n                    단원별 성취도 비교\n                  </CardTitle>\n                  <CardDescription>\n                    내 성적과 전체 평균, 최고 성적을 비교해보세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-96\">\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\n                      <BarChart data={chartData} margin={{ top: 20, right: 30, left: 20, bottom: 80 }}>\n                        <CartesianGrid strokeDasharray=\"3 3\" opacity={0.3} />\n                        <XAxis \n                          dataKey=\"name\" \n                          angle={-45} \n                          textAnchor=\"end\" \n                          height={100}\n                          tick={{ fontSize: 12 }}\n                        />\n                        <YAxis domain={[0, 100]} />\n                        <Tooltip \n                          contentStyle={{ \n                            backgroundColor: 'var(--background)', \n                            border: '1px solid var(--border)',\n                            borderRadius: '8px'\n                          }}\n                          labelFormatter={(label, payload) => {\n                            if (payload && payload[0]) {\n                              return payload[0].payload.fullName;\n                            }\n                            return label;\n                          }}\n                        />\n                        <Legend />\n                        <Bar dataKey=\"나의성적\" fill=\"#10b981\" name=\"나의 성적\" radius={[8, 8, 0, 0]} />\n                        <Bar dataKey=\"평균\" fill=\"#3b82f6\" name=\"전체 평균\" radius={[8, 8, 0, 0]} />\n                        <Bar dataKey=\"최고점\" fill=\"#f59e0b\" name=\"최고 점수\" radius={[8, 8, 0, 0]} />\n                      </BarChart>\n                    </ResponsiveContainer>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* 레이더 차트 */}\n              <Card className=\"border-2\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-2xl\">\n                    <Target className=\"w-7 h-7 text-primary\" />\n                    영역별 밸런스 분석\n                  </CardTitle>\n                  <CardDescription>\n                    각 단원의 균형 잡힌 학습 정도를 시각화했습니다\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-96\">\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\n                      <RadarChart data={radarData} cx=\"50%\" cy=\"50%\" outerRadius=\"70%\">\n                        <PolarGrid stroke=\"var(--border)\" />\n                        <PolarAngleAxis \n                          dataKey=\"unit\" \n                          tick={{ fontSize: 10, fill: 'var(--foreground)' }}\n                        />\n                        <PolarRadiusAxis angle={90} domain={[0, 100]} tick={{ fontSize: 10 }} />\n                        <Radar \n                          name=\"나의 성취도\" \n                          dataKey=\"value\" \n                          stroke=\"#10b981\" \n                          fill=\"#10b981\" \n                          fillOpacity={0.6} \n                        />\n                        <Tooltip \n                          contentStyle={{ \n                            backgroundColor: 'var(--background)', \n                            border: '1px solid var(--border)',\n                            borderRadius: '8px'\n                          }}\n                          labelFormatter={(label, payload) => {\n                            if (payload && payload[0]) {\n                              return payload[0].payload.fullName;\n                            }\n                            return label;\n                          }}\n                        />\n                      </RadarChart>\n                    </ResponsiveContainer>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* 단원별 상세 정보 with 통계 */}\n              <Card className=\"border-2\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-2xl\">\n                    <TrendingUp className=\"w-7 h-7 text-primary\" />\n                    단원별 상세 분석\n                  </CardTitle>\n                  <CardDescription>\n                    각 단원의 세부 성적과 전체 통계를 확인하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {answeredUnitResults.map((unit, i) => {\n                      const stats = unitStats?.find(s => s.unit === unit.unit);\n                      const myScore = unit.achievementRate;\n                      const avgScore = stats?.average || 0;\n                      const highScore = stats?.highest || 0;\n                      \n                      const isAboveAvg = myScore >= avgScore;\n                      const isTopScore = myScore === highScore && myScore === 100;\n\n                      return (\n                        <div key={i} className=\"p-5 rounded-xl border-2 hover-elevate bg-card/50\">\n                          <div className=\"flex items-center justify-between mb-4\">\n                            <div className=\"flex items-center gap-3\">\n                              <Badge variant=\"outline\" className=\"text-base px-3 py-1\">\n                                {unit.category}\n                              </Badge>\n                              <span className=\"font-bold text-lg\">{unit.unit}</span>\n                              {isTopScore && (\n                                <Badge className=\"bg-yellow-500 hover:bg-yellow-600\">\n                                  <Trophy className=\"w-3 h-3 mr-1\" />\n                                  최고점\n                                </Badge>\n                              )}\n                            </div>\n                            <Badge \n                              variant={unit.achievementRate >= 70 ? \"default\" : \"destructive\"}\n                              className=\"text-lg px-4 py-2 font-mono\"\n                            >\n                              {unit.achievementRate}%\n                            </Badge>\n                          </div>\n\n                          {/* 성적 비교 */}\n                          {stats && (\n                            <div className=\"mb-4 p-4 bg-muted/50 rounded-lg\">\n                              <div className=\"grid grid-cols-3 gap-4 text-sm\">\n                                <div className=\"text-center\">\n                                  <div className=\"text-xs text-muted-foreground mb-1\">나의 성적</div>\n                                  <div className={`text-xl font-bold ${isAboveAvg ? 'text-green-600 dark:text-green-400' : 'text-orange-600 dark:text-orange-400'}`}>\n                                    {myScore}%\n                                  </div>\n                                </div>\n                                <div className=\"text-center\">\n                                  <div className=\"text-xs text-muted-foreground mb-1\">전체 평균</div>\n                                  <div className=\"text-xl font-bold text-blue-600 dark:text-blue-400\">\n                                    {avgScore}%\n                                  </div>\n                                </div>\n                                <div className=\"text-center\">\n                                  <div className=\"text-xs text-muted-foreground mb-1\">최고 성적</div>\n                                  <div className=\"text-xl font-bold text-yellow-600 dark:text-yellow-400\">\n                                    {highScore}%\n                                  </div>\n                                </div>\n                              </div>\n                              <div className=\"mt-3 text-xs text-center text-muted-foreground\">\n                                {isAboveAvg \n                                  ? \"평균보다 높은 성적이에요!\" \n                                  : \"평균보다 조금 더 노력이 필요해요!\"}\n                              </div>\n                            </div>\n                          )}\n\n                          {/* 문제 통계 */}\n                          <div className=\"grid grid-cols-4 gap-3\">\n                            <div className=\"text-center p-3 bg-gray-100 dark:bg-gray-800 rounded-lg\">\n                              <div className=\"font-bold text-lg\">{unit.total}</div>\n                              <div className=\"text-xs text-muted-foreground\">총 문항</div>\n                            </div>\n                            <div className=\"text-center p-3 bg-green-100 dark:bg-green-900/30 rounded-lg\">\n                              <div className=\"font-bold text-lg text-green-700 dark:text-green-400\">{unit.correct}</div>\n                              <div className=\"text-xs text-muted-foreground\">정답</div>\n                            </div>\n                            <div className=\"text-center p-3 bg-red-100 dark:bg-red-900/30 rounded-lg\">\n                              <div className=\"font-bold text-lg text-red-700 dark:text-red-400\">{unit.wrong}</div>\n                              <div className=\"text-xs text-muted-foreground\">오답</div>\n                            </div>\n                            <div className=\"text-center p-3 bg-gray-100 dark:bg-gray-800 rounded-lg\">\n                              <div className=\"font-bold text-lg\">{unit.unanswered}</div>\n                              <div className=\"text-xs text-muted-foreground\">범위 외</div>\n                            </div>\n                          </div>\n\n                          <Progress value={unit.achievementRate} className=\"h-3 mt-4\" />\n                        </div>\n                      );\n                    })}\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n\n            {/* 선생님용 탭 */}\n            <TabsContent value=\"teacher\" className=\"space-y-6 mt-6\">\n              {/* 종합 지도안 */}\n              {teacherGuidance.map((guide, i) => (\n                <Card key={i} className=\"border-2\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-3 text-2xl\">\n                      <guide.icon className=\"w-7 h-7\" />\n                      {guide.title}\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"p-5 bg-muted/50 rounded-xl\">\n                      <p className=\"text-lg mb-2 font-medium\">관찰 내용</p>\n                      <p className=\"text-base text-muted-foreground\">{guide.content}</p>\n                    </div>\n                    <div className=\"p-5 bg-primary/10 dark:bg-primary/20 rounded-xl border-2 border-primary/30\">\n                      <p className=\"text-lg mb-2 font-medium flex items-center gap-2\">\n                        <ChevronRight className=\"w-5 h-5 text-primary\" />\n                        추천 지도 방안\n                      </p>\n                      <p className=\"text-base\">{guide.action}</p>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n\n              {/* 단원별 상세 지도 가이드 */}\n              <Card className=\"border-2\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-2xl\">\n                    <BookOpen className=\"w-7 h-7 text-primary\" />\n                    단원별 지도 가이드\n                  </CardTitle>\n                  <CardDescription>\n                    각 단원에 대한 맞춤형 교육 방안\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-5\">\n                    {answeredUnitResults.map((unit, i) => {\n                      const stats = unitStats?.find(s => s.unit === unit.unit);\n                      let teachingTips: string[] = [];\n                      let urgency = \"\";\n\n                      if (unit.achievementRate >= 90) {\n                        urgency = \"심화\";\n                        teachingTips = [\n                          \"심화 문제와 응용 문제를 제공하세요\",\n                          \"실험 설계나 프로젝트 활동을 진행하세요\",\n                          \"다른 학생의 멘토 역할을 맡겨보세요\"\n                        ];\n                      } else if (unit.achievementRate >= 70) {\n                        urgency = \"보완\";\n                        teachingTips = [\n                          \"틀린 문제 위주로 개념을 재정리하세요\",\n                          \"유사 문제를 추가로 제공하세요\",\n                          \"소그룹 활동으로 개념을 강화하세요\"\n                        ];\n                      } else if (unit.achievementRate >= 50) {\n                        urgency = \"집중\";\n                        teachingTips = [\n                          \"기본 개념부터 차근차근 재설명하세요\",\n                          \"시각 자료와 실험을 활용하세요\",\n                          \"1:1 보충 학습을 진행하세요\"\n                        ];\n                      } else {\n                        urgency = \"긴급\";\n                        teachingTips = [\n                          \"학부모 상담이 필요합니다\",\n                          \"개별 맞춤 학습 계획을 수립하세요\",\n                          \"기초부터 완전히 재교육하세요\"\n                        ];\n                      }\n\n                      return (\n                        <div \n                          key={i} \n                          className={`p-5 rounded-xl border-2 ${\n                            unit.achievementRate >= 90 ? 'bg-green-500/10 border-green-500/30' :\n                            unit.achievementRate >= 70 ? 'bg-blue-500/10 border-blue-500/30' :\n                            unit.achievementRate >= 50 ? 'bg-orange-500/10 border-orange-500/30' :\n                            'bg-red-500/10 border-red-500/30'\n                          }`}\n                        >\n                          <div className=\"flex items-center justify-between mb-4\">\n                            <div className=\"flex items-center gap-3\">\n                              <Badge variant=\"outline\" className=\"text-base px-3 py-1\">\n                                {unit.category}\n                              </Badge>\n                              <span className=\"font-bold text-lg\">{unit.unit}</span>\n                              <Badge variant={\n                                urgency === \"심화\" ? \"default\" :\n                                urgency === \"보완\" ? \"secondary\" :\n                                urgency === \"집중\" ? \"outline\" :\n                                \"destructive\"\n                              }>\n                                {urgency} 필요\n                              </Badge>\n                            </div>\n                            <div className=\"text-right\">\n                              <div className=\"text-2xl font-bold\">{unit.achievementRate}%</div>\n                              {stats && (\n                                <div className=\"text-xs text-muted-foreground\">\n                                  평균: {stats.average}% | 최고: {stats.highest}%\n                                </div>\n                              )}\n                            </div>\n                          </div>\n\n                          <div className=\"space-y-2\">\n                            <p className=\"font-semibold text-sm\">지도 방안:</p>\n                            {teachingTips.map((tip, j) => (\n                              <div key={j} className=\"flex items-start gap-2 text-sm pl-4\">\n                                <ChevronRight className=\"w-4 h-4 mt-0.5 flex-shrink-0 text-primary\" />\n                                <span>{tip}</span>\n                              </div>\n                            ))}\n                          </div>\n\n                          <div className=\"mt-4 grid grid-cols-4 gap-2 text-xs\">\n                            <div className=\"text-center p-2 bg-background/50 rounded\">\n                              <div className=\"font-semibold\">{unit.total}</div>\n                              <div className=\"text-muted-foreground\">총</div>\n                            </div>\n                            <div className=\"text-center p-2 bg-background/50 rounded\">\n                              <div className=\"font-semibold text-green-600 dark:text-green-400\">{unit.correct}</div>\n                              <div className=\"text-muted-foreground\">정답</div>\n                            </div>\n                            <div className=\"text-center p-2 bg-background/50 rounded\">\n                              <div className=\"font-semibold text-red-600 dark:text-red-400\">{unit.wrong}</div>\n                              <div className=\"text-muted-foreground\">오답</div>\n                            </div>\n                            <div className=\"text-center p-2 bg-background/50 rounded\">\n                              <div className=\"font-semibold\">{unit.unanswered}</div>\n                              <div className=\"text-muted-foreground\">범위외</div>\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n          </Tabs>\n\n          {/* Action Buttons */}\n          <div className=\"flex justify-center gap-4 pb-8\">\n            <Button\n              variant=\"outline\"\n              size=\"lg\"\n              onClick={() => setLocation(\"/reports\")}\n              data-testid=\"button-view-reports\"\n              className=\"text-lg px-6 py-6\"\n            >\n              <BarChart3 className=\"w-5 h-5 mr-2\" />\n              전체 성적 기록\n            </Button>\n            <Button\n              size=\"lg\"\n              onClick={() => setLocation(\"/units\")}\n              data-testid=\"button-home\"\n              className=\"text-lg px-6 py-6\"\n            >\n              <Home className=\"w-5 h-5 mr-2\" />\n              단원 선택으로\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":42308,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"앱_기능설명서_홍보용.md":{"content":"# 목동에이원과학학원 OMR 평가 시스템\n\n## 📚 개요\n\n목동에이원과학학원의 **물리학 프리미엄 OMR 평가 시스템**은 학생들의 학습 성취도를 정확하게 측정하고, 즉각적인 피드백을 제공하는 차세대 학습 관리 플랫폼입니다.\n\n---\n\n## ✨ 주요 특징\n\n### 1. 🎯 즉시 채점 시스템\n- **실시간 성적 확인**: 시험 제출 즉시 점수와 성취율 확인\n- **정확한 오답 분석**: 틀린 문제를 바로 확인하고 복습 가능\n- **맞춤형 피드백**: 성취도에 따른 구체적인 학습 조언 제공\n\n### 2. 📊 종합 성적 분석\n- **전체 성적 분석**: 모든 단원의 평균 성취율과 학습 추이 확인\n- **단원별 성적표**: 각 단원별 상세 성적과 오답 리스트\n- **성적 추이 그래프**: 시간에 따른 성적 변화를 시각적으로 확인\n- **강점/약점 파악**: 잘하는 단원과 보완이 필요한 단원을 한눈에 파악\n\n### 3. 🔍 편리한 OMR 방식\n- **한 페이지에 모든 문제**: 스크롤 없이 전체 문제를 한눈에 확인\n- **직관적인 답안 입력**: 클릭 한 번으로 답안 선택 및 수정\n- **진행 상황 표시**: 풀지 않은 문제를 실시간으로 확인\n- **안전한 제출**: 미완성 답안 경고로 실수 방지\n\n### 4. 📖 16개 물리학 단원 완벽 커버\n물리학 프리미엄 교재의 모든 단원을 체계적으로 학습:\n\n**역학 영역**\n- 운동의 기술\n- 운동 법칙\n- 돌림힘 평형과 안정성\n- 운동량과 충격량\n- 일과 에너지\n- 에너지 보존\n\n**열과 파동**\n- 열역학\n- 파동의 성질\n- 파동의 간섭과 회절\n\n**전자기**\n- 전기장과 전위\n- 물질의 자성 & 전류의 자기작용\n- 전자기 유도\n\n**현대물리**\n- 에너지 준위와 스펙트럼\n- 빛과 물질의 이중성\n- 상대성 원리\n- 핵반응과 핵에너지\n\n---\n\n## 👨‍🎓 학생 기능\n\n### 로그인\n- 학생 ID와 이름으로 간편하게 로그인\n- 개인 정보 보호 및 성적 관리\n\n### 단원 선택 및 시험 응시\n- 16개 단원 중 원하는 단원 선택\n- 단원별 문제 수 확인 (26~60문제)\n- OMR 방식으로 편리한 답안 작성\n\n### 즉시 결과 확인\n- 제출 즉시 점수, 성취율, 등급 확인\n- 틀린 문제 번호와 정답 확인\n- 성취도별 맞춤 피드백\n\n### 성적 리포트\n- **전체 성적 분석**\n  - 평균 성취율 및 시험 응시 횟수\n  - 최고/최저 점수 확인\n  - 성적 추이 그래프\n  \n- **단원별 성적표**\n  - 각 단원의 모든 시험 기록 조회\n  - 상세 결과 확인 (점수, 등급, 오답)\n  - 학습 패턴 분석\n\n---\n\n## 👨‍💼 관리자 기능\n\n### 학생 관리\n- 전체 학생 목록 조회\n- 학생별 평균 성적 및 응시 횟수 확인\n- 구글 시트 연동으로 학생 정보 자동 동기화\n\n### 학생 성적 조회\n- 학생 이름/ID로 빠른 검색\n- 개별 학생의 전체 성적 분석\n- 단원별 상세 성적 확인\n- 학생 리포트와 동일한 화면으로 상담 자료 활용\n\n### 단원별 오답 분석\n- **문제별 오답률 분석**\n  - 각 문제의 총 응시 인원 및 오답자 수\n  - 오답률 높은 순으로 자동 정렬\n  - 오답률에 따른 시각적 표시 (빨강/주황/노랑/초록)\n\n- **답안 분포 분석**\n  - 1~5번 각 선택지별 선택 인원 통계\n  - 정답과 오답 시각적 구분\n  - 학생들의 오개념 파악 가능\n\n### 구글 시트 연동\n- 학생 정보와 시험 결과 자동 저장\n- 문제별 통계 데이터 집계\n- 어디서나 구글 시트로 데이터 확인 가능\n\n### 시스템 설정\n- 구글 시트 ID 설정 (UI에서 직접 설정)\n- 개발/배포 환경 별도 관리\n- 설정 상태 실시간 확인\n\n---\n\n## 🎓 학습 효과\n\n### 학생 입장\n✅ **즉각적인 피드백**으로 학습 동기 부여  \n✅ **오답 분석**을 통한 효율적인 복습  \n✅ **성적 추이 확인**으로 학습 계획 수립  \n✅ **단원별 성적**으로 약점 보완  \n\n### 학원 입장\n✅ **자동 채점**으로 시간 절약  \n✅ **데이터 기반 학습 지도**  \n✅ **학생별 맞춤 상담 자료 확보**  \n✅ **문제별 난이도 분석**으로 수업 개선  \n✅ **구글 시트 연동**으로 데이터 관리 간편화  \n\n### 학부모 입장\n✅ **투명한 성적 관리**  \n✅ **자녀의 학습 현황 파악**  \n✅ **객관적인 평가 지표**  \n\n---\n\n## 🔒 보안 및 안정성\n\n- 관리자 페이지 비밀번호 보호 (비밀번호: 3721)\n- 학생 개인 정보 안전 관리\n- 안정적인 데이터베이스 시스템\n- 구글 시트 자동 백업\n\n---\n\n## 💡 차별화 포인트\n\n### 1. 최적화된 데이터 관리\n- **99% 데이터 감소**: 96,000행 → 960행 (문항별 집계 방식)\n- 빠른 성능과 효율적인 저장 공간\n\n### 2. 실전 같은 OMR 경험\n- 실제 OMR 카드와 유사한 UI\n- 한 페이지에 모든 문제 표시\n- 편리한 답안 수정\n\n### 3. 강력한 분석 도구\n- 개인별, 단원별, 문제별 다층 분석\n- 시각적 차트와 그래프\n- 오답률 기반 학습 가이드\n\n### 4. 클라우드 기반 시스템\n- 언제 어디서나 접속 가능\n- 구글 시트 연동\n- 데이터 안전 보관\n\n---\n\n## 📱 사용 환경\n\n- **PC, 태블릿, 모바일** 모든 기기 지원\n- 최신 웹 브라우저에서 작동\n- 별도 앱 설치 불필요\n\n---\n\n## 🚀 시작하기\n\n### 학생\n1. 웹사이트 접속\n2. 학생 ID와 이름으로 로그인\n3. 단원 선택 후 시험 응시\n4. 즉시 결과 확인 및 성적 리포트 조회\n\n### 관리자\n1. 관리자 페이지 접속 (`/admin/login`)\n2. 비밀번호 입력 (3721)\n3. 시스템 설정 탭에서 구글 시트 ID 설정\n4. 학생 동기화 버튼으로 학생 정보 불러오기\n5. 학생 검색 및 성적 조회, 오답 분석 활용\n\n---\n\n## 📞 문의\n\n**목동에이원과학학원**  \n체계적인 물리학 학습, 과학적인 성적 관리\n\n---\n\n*본 시스템은 목동에이원과학학원의 물리학 프리미엄 과정 학생들을 위해 특별히 제작되었습니다.*\n","path":null,"size_bytes":6093,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"client/src/pages/admin.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Input } from \"@/components/ui/input\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { ShieldCheck, Users, BarChart3, AlertCircle, TrendingDown, LogOut, Search, Calendar, RefreshCw, Settings2, Link as LinkIcon, Database } from \"lucide-react\";\nimport { Progress } from \"@/components/ui/progress\";\nimport type { Student, TestResult } from \"@shared/schema\";\nimport { units } from \"@shared/schema\";\nimport { StudentReportView } from \"@/components/student-report-view\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\n\ninterface SheetResult {\n  studentId: string;\n  studentName: string;\n  textbook: string;\n  unit: string;\n  submittedAt: string;\n  achievementRate: number;\n  feedback: string;\n}\n\ninterface QuestionStat {\n  questionId: string;\n  correctAnswer: string;\n  totalAttempts: number;\n  wrongAttempts: number;\n  answerDistribution: Record<string, number>;\n  wrongRate: number;\n}\n\ninterface UnitStats {\n  unit: string;\n  totalQuestions: number;\n  totalStudents: number;\n  questionStats: QuestionStat[];\n}\n\nexport default function AdminPage() {\n  const [, setLocation] = useLocation();\n  const [selectedUnit, setSelectedUnit] = useState(units[0]);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedStudent, setSelectedStudent] = useState<Student | null>(null);\n  const [spreadsheetIdInput, setSpreadsheetIdInput] = useState(\"\");\n  const { toast } = useToast();\n\n  useEffect(() => {\n    const isAdmin = sessionStorage.getItem(\"admin\");\n    if (!isAdmin) {\n      setLocation(\"/admin/login\");\n    }\n  }, [setLocation]);\n\n  const { data: allResults, isLoading: resultsLoading } = useQuery<SheetResult[]>({\n    queryKey: [\"/api/admin/all-results\"],\n  });\n\n  const { data: students, isLoading: studentsLoading } = useQuery<Student[]>({\n    queryKey: [\"/api/admin/students\"],\n  });\n\n  const { data: unitStats, isLoading: statsLoading } = useQuery<UnitStats>({\n    queryKey: [\"/api/admin/unit-stats\", selectedUnit],\n    enabled: !!selectedUnit,\n  });\n\n  const { data: spreadsheetSettings } = useQuery<{ value: string; source: string }>({\n    queryKey: [\"/api/admin/settings/spreadsheet-id\"],\n  });\n\n  useEffect(() => {\n    if (spreadsheetSettings?.value && !spreadsheetIdInput) {\n      setSpreadsheetIdInput(spreadsheetSettings.value);\n    }\n  }, [spreadsheetSettings]);\n\n  const saveSpreadsheetIdMutation = useMutation({\n    mutationFn: async (value: string) => {\n      return await apiRequest<{ success: boolean; message: string }>(\n        \"POST\",\n        \"/api/admin/settings/spreadsheet-id\",\n        { value }\n      );\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/settings/spreadsheet-id\"] });\n      toast({\n        title: \"저장 완료\",\n        description: data.message,\n        variant: \"default\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"저장 실패\",\n        description: error.message || \"설정을 저장하는 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const syncStudentsMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest<{ message: string; added: number; skipped: number; total: number }>(\n        \"POST\",\n        \"/api/sync-students\",\n        {}\n      );\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/students\"] });\n      toast({\n        title: \"동기화 완료\",\n        description: data.message,\n        variant: \"default\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"동기화 실패\",\n        description: error.message || \"학생 정보를 동기화하는 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const initDataMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest<{ message: string; questionCount: number }>(\n        \"POST\",\n        \"/api/init-data\",\n        {}\n      );\n    },\n    onSuccess: (data) => {\n      toast({\n        title: \"초기화 완료\",\n        description: `${data.questionCount}개의 문제가 데이터베이스에 저장되었습니다.`,\n        variant: \"default\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"초기화 실패\",\n        description: error.message || \"문제 데이터를 초기화하는 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleLogout = () => {\n    sessionStorage.removeItem(\"admin\");\n    setLocation(\"/admin/login\");\n  };\n\n  const handleSyncStudents = () => {\n    syncStudentsMutation.mutate();\n  };\n\n  const handleInitData = () => {\n    initDataMutation.mutate();\n  };\n\n  const handleSaveSpreadsheetId = () => {\n    if (!spreadsheetIdInput.trim()) {\n      toast({\n        title: \"입력 오류\",\n        description: \"구글 시트 ID를 입력해주세요.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    saveSpreadsheetIdMutation.mutate(spreadsheetIdInput.trim());\n  };\n\n  if (resultsLoading || studentsLoading) {\n    return (\n      <div className=\"min-h-screen bg-background p-4\">\n        <div className=\"container mx-auto max-w-7xl space-y-6\">\n          <Skeleton className=\"h-16 w-full\" />\n          <div className=\"grid md:grid-cols-3 gap-6\">\n            <Skeleton className=\"h-32\" />\n            <Skeleton className=\"h-32\" />\n            <Skeleton className=\"h-32\" />\n          </div>\n          <Skeleton className=\"h-96\" />\n        </div>\n      </div>\n    );\n  }\n\n  const totalTests = allResults?.length || 0;\n  const totalStudents = students?.length || 0;\n  const averageScore = totalTests > 0\n    ? Math.round(allResults!.reduce((sum, r) => sum + r.achievementRate, 0) / totalTests)\n    : 0;\n\n  // 학생 검색 필터\n  const filteredStudents = students?.filter(student =>\n    student.studentName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    student.studentId.toLowerCase().includes(searchQuery.toLowerCase())\n  ) || [];\n\n  // 선택된 학생의 모든 성적\n  const selectedStudentResults = selectedStudent\n    ? allResults?.filter(r => r.studentId === selectedStudent.studentId) || []\n    : [];\n\n  const selectedStudentAvg = selectedStudentResults.length > 0\n    ? Math.round(selectedStudentResults.reduce((sum, r) => sum + r.achievementRate, 0) / selectedStudentResults.length)\n    : 0;\n\n  // 학생별 통계 (검색 결과용)\n  const studentStats = filteredStudents.map(student => {\n    const studentResults = allResults?.filter(r => r.studentId === student.studentId) || [];\n    const avgScore = studentResults.length > 0\n      ? Math.round(studentResults.reduce((sum, r) => sum + r.achievementRate, 0) / studentResults.length)\n      : 0;\n    \n    return {\n      ...student,\n      totalTests: studentResults.length,\n      averageScore: avgScore,\n      bestScore: studentResults.length > 0 ? Math.max(...studentResults.map(r => r.achievementRate)) : 0,\n    };\n  }).sort((a, b) => b.averageScore - a.averageScore);\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-primary/5 to-accent/10\">\n      <header className=\"sticky top-0 z-50 border-b bg-card/95 backdrop-blur\">\n        <div className=\"container mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <ShieldCheck className=\"w-8 h-8 text-primary\" />\n              <h1 className=\"text-2xl font-bold\">관리자 대시보드</h1>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Button\n                variant=\"default\"\n                onClick={handleSyncStudents}\n                disabled={syncStudentsMutation.isPending}\n                data-testid=\"button-sync-students\"\n              >\n                <RefreshCw className={`w-4 h-4 mr-2 ${syncStudentsMutation.isPending ? 'animate-spin' : ''}`} />\n                {syncStudentsMutation.isPending ? \"동기화 중...\" : \"학생 동기화\"}\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={handleLogout}\n                data-testid=\"button-logout\"\n              >\n                <LogOut className=\"w-4 h-4 mr-2\" />\n                로그아웃\n              </Button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"container mx-auto px-4 py-8 max-w-7xl\">\n        <div className=\"space-y-8\">\n          {/* 전체 통계 */}\n          <div className=\"grid md:grid-cols-3 gap-6\">\n            <Card className=\"border-2 border-primary/20 shadow-lg hover-elevate\">\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <CardTitle className=\"text-sm font-medium\">전체 학생 수</CardTitle>\n                <Users className=\"h-5 w-5 text-primary\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-4xl font-bold font-mono text-primary\">{totalStudents}</div>\n                <p className=\"text-xs text-muted-foreground mt-2\">등록된 학생</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-2 border-blue-500/20 shadow-lg hover-elevate\">\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <CardTitle className=\"text-sm font-medium\">총 응시 횟수</CardTitle>\n                <BarChart3 className=\"h-5 w-5 text-blue-600\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-4xl font-bold font-mono text-blue-600\">{totalTests}</div>\n                <p className=\"text-xs text-muted-foreground mt-2\">전체 시험 응시</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-2 border-green-500/20 shadow-lg hover-elevate\">\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n                <CardTitle className=\"text-sm font-medium\">전체 평균 성취율</CardTitle>\n                <TrendingDown className=\"h-5 w-5 text-green-600\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-4xl font-bold font-mono text-green-600\">{averageScore}%</div>\n                <Progress value={averageScore} className=\"mt-2 h-2\" />\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* 탭 메뉴 */}\n          <Tabs defaultValue=\"students\" className=\"space-y-6\">\n            <TabsList className=\"grid w-full grid-cols-3\">\n              <TabsTrigger value=\"students\">학생 검색 및 성적</TabsTrigger>\n              <TabsTrigger value=\"questions\">단원별 오답 분석</TabsTrigger>\n              <TabsTrigger value=\"settings\">시스템 설정</TabsTrigger>\n            </TabsList>\n\n            {/* 학생 검색 및 성적 */}\n            <TabsContent value=\"students\" className=\"space-y-4\">\n              {/* 검색 바 */}\n              <Card className=\"shadow-lg\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Search className=\"w-6 h-6\" />\n                    학생 검색\n                  </CardTitle>\n                  <CardDescription>\n                    학생 이름 또는 ID를 검색하여 성적을 확인하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <Input\n                    placeholder=\"학생 이름 또는 ID로 검색...\"\n                    value={searchQuery}\n                    onChange={(e) => {\n                      setSearchQuery(e.target.value);\n                      setSelectedStudent(null);\n                    }}\n                    className=\"text-lg\"\n                    data-testid=\"input-student-search\"\n                  />\n                </CardContent>\n              </Card>\n\n              {/* 검색 결과 (검색어가 있을 때만 표시) */}\n              {!selectedStudent && searchQuery && (\n                <Card className=\"shadow-lg\">\n                  <CardHeader>\n                    <CardTitle>\n                      검색 결과 ({studentStats.length}명)\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-2\">\n                      {studentStats.length === 0 ? (\n                        <p className=\"text-center text-muted-foreground py-8\">\n                          검색 결과가 없습니다\n                        </p>\n                      ) : (\n                        studentStats.map((student, index) => {\n                          const gradeColor = student.averageScore >= 90 ? \"text-green-600\" :\n                                            student.averageScore >= 80 ? \"text-blue-600\" :\n                                            student.averageScore >= 70 ? \"text-yellow-600\" :\n                                            student.averageScore >= 60 ? \"text-orange-600\" : \"text-red-600\";\n                          const gradeBg = student.averageScore >= 90 ? \"bg-green-500/10\" :\n                                         student.averageScore >= 80 ? \"bg-blue-500/10\" :\n                                         student.averageScore >= 70 ? \"bg-yellow-500/10\" :\n                                         student.averageScore >= 60 ? \"bg-orange-500/10\" : \"bg-red-500/10\";\n\n                          return (\n                            <Button\n                              key={student.studentId}\n                              variant=\"outline\"\n                              className=\"w-full justify-start p-4 h-auto hover-elevate\"\n                              onClick={() => setSelectedStudent(student)}\n                            >\n                              <div className=\"flex items-center gap-4 w-full\">\n                                <div className=\"flex items-center justify-center w-12 h-12 rounded-full bg-primary/10 font-bold text-primary flex-shrink-0\">\n                                  {index + 1}\n                                </div>\n                                <div className=\"flex-1 grid md:grid-cols-4 gap-4 text-left\">\n                                  <div>\n                                    <p className=\"text-sm text-muted-foreground\">이름</p>\n                                    <p className=\"font-semibold\">{student.studentName}</p>\n                                  </div>\n                                  <div>\n                                    <p className=\"text-sm text-muted-foreground\">학생 ID</p>\n                                    <p className=\"font-mono text-sm\">{student.studentId}</p>\n                                  </div>\n                                  <div>\n                                    <p className=\"text-sm text-muted-foreground\">응시 횟수</p>\n                                    <p className=\"font-semibold\">{student.totalTests}회</p>\n                                  </div>\n                                  <div>\n                                    <p className=\"text-sm text-muted-foreground\">평균 성취율</p>\n                                    <Badge className={`${gradeBg} ${gradeColor} font-mono text-base`}>\n                                      {student.averageScore}%\n                                    </Badge>\n                                  </div>\n                                </div>\n                              </div>\n                            </Button>\n                          );\n                        })\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* 검색 안내 메시지 (검색어가 없고 학생도 선택하지 않았을 때) */}\n              {!selectedStudent && !searchQuery && (\n                <Card className=\"shadow-lg\">\n                  <CardContent className=\"py-16 text-center\">\n                    <Search className=\"w-20 h-20 mx-auto mb-6 text-muted-foreground opacity-30\" />\n                    <h3 className=\"text-2xl font-bold mb-3\">학생을 검색하세요</h3>\n                    <p className=\"text-muted-foreground text-lg\">\n                      위의 검색창에 학생 이름 또는 ID를 입력하여<br />\n                      개별 학생의 성적을 확인할 수 있습니다\n                    </p>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* 선택된 학생의 상세 성적 */}\n              {selectedStudent && selectedStudentResults.length > 0 && (\n                <Card className=\"shadow-lg border-2 border-primary/30\">\n                  <CardContent className=\"pt-6\">\n                    <StudentReportView\n                      results={selectedStudentResults.map(r => ({\n                        id: 0,\n                        studentId: r.studentId,\n                        studentName: r.studentName,\n                        textbook: r.textbook,\n                        unit: r.unit,\n                        submittedAt: new Date(r.submittedAt),\n                        achievementRate: r.achievementRate,\n                        score: r.achievementRate,\n                        totalQuestions: 0,\n                        correctAnswers: Math.round(r.achievementRate / 100),\n                        feedback: r.feedback,\n                        answers: \"[]\",\n                      }))}\n                      studentName={selectedStudent.studentName}\n                      studentId={selectedStudent.studentId}\n                      showBackButton={true}\n                      onBack={() => setSelectedStudent(null)}\n                    />\n                  </CardContent>\n                </Card>\n              )}\n              \n              {selectedStudent && selectedStudentResults.length === 0 && (\n                <Card className=\"shadow-lg\">\n                  <CardContent className=\"py-12 text-center\">\n                    <p className=\"text-lg font-semibold text-muted-foreground\">\n                      {selectedStudent.studentName} 학생의 응시 기록이 없습니다\n                    </p>\n                    <Button\n                      variant=\"outline\"\n                      className=\"mt-4\"\n                      onClick={() => setSelectedStudent(null)}\n                    >\n                      목록으로\n                    </Button>\n                  </CardContent>\n                </Card>\n              )}\n            </TabsContent>\n\n            {/* 단원별 오답 분석 */}\n            <TabsContent value=\"questions\" className=\"space-y-4\">\n              <Card className=\"shadow-lg\">\n                <CardHeader>\n                  <CardTitle>단원 선택</CardTitle>\n                  <CardDescription>\n                    분석할 단원을 선택하세요 (구글 시트 데이터 기반)\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3\">\n                    {units.map((unit) => (\n                      <Button\n                        key={unit}\n                        variant={selectedUnit === unit ? \"default\" : \"outline\"}\n                        onClick={() => setSelectedUnit(unit)}\n                        className=\"h-auto py-3 text-sm\"\n                      >\n                        {unit}\n                      </Button>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {statsLoading ? (\n                <Skeleton className=\"h-96\" />\n              ) : unitStats && unitStats.questionStats.length > 0 ? (\n                <Card className=\"shadow-lg border-2 border-red-500/20\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <AlertCircle className=\"w-6 h-6 text-red-600\" />\n                      {selectedUnit} - 오답률 분석\n                    </CardTitle>\n                    <CardDescription>\n                      총 {unitStats.totalStudents}명이 응시한 {unitStats.totalQuestions}문제 중 오답률이 높은 순서\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-4\">\n                      {unitStats.questionStats.map((stat, index) => (\n                        <div\n                          key={stat.questionId}\n                          className={`p-5 rounded-xl border-2 ${\n                            stat.wrongRate >= 70 ? \"bg-red-500/10 border-red-500/30\" :\n                            stat.wrongRate >= 50 ? \"bg-orange-500/10 border-orange-500/30\" :\n                            stat.wrongRate >= 30 ? \"bg-yellow-500/10 border-yellow-500/30\" :\n                            \"bg-green-500/10 border-green-500/30\"\n                          }`}\n                        >\n                          <div className=\"flex items-start gap-4 mb-4\">\n                            <div className={`flex items-center justify-center w-16 h-16 rounded-full font-bold text-2xl ${\n                              stat.wrongRate >= 70 ? \"bg-red-600 text-white\" :\n                              stat.wrongRate >= 50 ? \"bg-orange-600 text-white\" :\n                              stat.wrongRate >= 30 ? \"bg-yellow-600 text-white\" :\n                              \"bg-green-600 text-white\"\n                            }`}>\n                              {index + 1}\n                            </div>\n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center justify-between mb-2\">\n                                <h3 className=\"text-2xl font-bold\">{stat.questionId}번</h3>\n                                <Badge variant=\"outline\" className=\"text-lg px-3 py-1 border-2 border-green-600 text-green-700\">\n                                  정답: {stat.correctAnswer}번\n                                </Badge>\n                              </div>\n                              <div className=\"grid grid-cols-2 gap-4 mb-3\">\n                                <div>\n                                  <p className=\"text-sm text-muted-foreground\">총 응시</p>\n                                  <p className=\"text-xl font-bold\">{stat.totalAttempts}명</p>\n                                </div>\n                                <div>\n                                  <p className=\"text-sm text-muted-foreground\">오답 학생</p>\n                                  <p className=\"text-xl font-bold text-red-600\">{stat.wrongAttempts}명</p>\n                                </div>\n                              </div>\n                              <div className=\"mb-3\">\n                                <div className=\"flex items-center justify-between mb-1\">\n                                  <span className=\"text-sm font-medium\">오답률</span>\n                                  <span className=\"text-xl font-bold\">{stat.wrongRate}%</span>\n                                </div>\n                                <Progress value={stat.wrongRate} className=\"h-3\" />\n                              </div>\n                              <div className=\"pt-3 border-t\">\n                                <p className=\"text-sm font-semibold mb-2\">학생 답안 분포:</p>\n                                <div className=\"grid grid-cols-5 gap-2\">\n                                  {[1, 2, 3, 4, 5].map((option) => {\n                                    const count = stat.answerDistribution[option.toString()] || 0;\n                                    const isCorrect = option.toString() === stat.correctAnswer;\n                                    return (\n                                      <div\n                                        key={option}\n                                        className={`p-3 rounded-lg text-center ${\n                                          isCorrect\n                                            ? \"bg-green-600 text-white border-2 border-green-700\"\n                                            : count > 0\n                                            ? \"bg-red-500/20 border-2 border-red-500/50\"\n                                            : \"bg-muted border\"\n                                        }`}\n                                      >\n                                        <p className=\"text-xs mb-1\">{option}번</p>\n                                        <p className=\"text-lg font-bold\">{count}명</p>\n                                      </div>\n                                    );\n                                  })}\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              ) : (\n                <Card className=\"shadow-lg\">\n                  <CardContent className=\"py-12 text-center\">\n                    <AlertCircle className=\"w-16 h-16 mx-auto mb-4 text-muted-foreground\" />\n                    <p className=\"text-lg font-semibold text-muted-foreground\">\n                      {selectedUnit}에 대한 응시 기록이 없습니다\n                    </p>\n                  </CardContent>\n                </Card>\n              )}\n            </TabsContent>\n\n            {/* 시스템 설정 */}\n            <TabsContent value=\"settings\" className=\"space-y-4\">\n              <Card className=\"shadow-lg border-2 border-primary/20\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Settings2 className=\"w-6 h-6\" />\n                    구글 시트 연동 설정\n                  </CardTitle>\n                  <CardDescription>\n                    학생 정보와 시험 결과를 동기화할 구글 시트 ID를 설정하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <label htmlFor=\"spreadsheet-id\" className=\"text-sm font-medium\">\n                      구글 시트 ID\n                    </label>\n                    <div className=\"flex gap-2\">\n                      <Input\n                        id=\"spreadsheet-id\"\n                        placeholder=\"예: 1Abc2Def3Ghi4Jkl5Mno6Pqr7Stu8Vwx9Yz0\"\n                        value={spreadsheetIdInput}\n                        onChange={(e) => setSpreadsheetIdInput(e.target.value)}\n                        data-testid=\"input-spreadsheet-id\"\n                        className=\"flex-1 font-mono text-sm\"\n                      />\n                      <Button\n                        onClick={handleSaveSpreadsheetId}\n                        disabled={saveSpreadsheetIdMutation.isPending}\n                        data-testid=\"button-save-spreadsheet-id\"\n                      >\n                        {saveSpreadsheetIdMutation.isPending ? \"저장 중...\" : \"저장\"}\n                      </Button>\n                    </div>\n                    {spreadsheetSettings?.source && (\n                      <p className=\"text-sm text-muted-foreground\">\n                        <LinkIcon className=\"w-3 h-3 inline mr-1\" />\n                        현재 설정 위치: {\n                          spreadsheetSettings.source === \"database\" ? \"데이터베이스 (이 화면에서 설정됨)\" :\n                          spreadsheetSettings.source === \"environment\" ? \"환경 변수 (개발 환경)\" :\n                          \"설정되지 않음\"\n                        }\n                      </p>\n                    )}\n                  </div>\n\n                  <div className=\"pt-4 border-t space-y-2\">\n                    <h4 className=\"font-semibold\">📖 구글 시트 ID 찾는 방법:</h4>\n                    <ol className=\"list-decimal list-inside space-y-1 text-sm text-muted-foreground\">\n                      <li>구글 시트를 엽니다</li>\n                      <li>URL에서 /d/ 와 /edit 사이의 문자열을 복사합니다</li>\n                      <li>예: https://docs.google.com/spreadsheets/d/<strong className=\"text-foreground\">여기가_ID</strong>/edit</li>\n                    </ol>\n                  </div>\n\n                  <div className=\"pt-4 border-t space-y-2\">\n                    <h4 className=\"font-semibold\">✅ 설정 완료 후:</h4>\n                    <ol className=\"list-decimal list-inside space-y-1 text-sm text-muted-foreground\">\n                      <li>상단의 <strong className=\"text-foreground\">\"학생 동기화\"</strong> 버튼을 클릭하세요</li>\n                      <li>구글 시트의 학생 정보가 데이터베이스로 복사됩니다</li>\n                      <li>학생들이 로그인할 수 있습니다!</li>\n                    </ol>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"shadow-lg border-2 border-orange-500/20\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Database className=\"w-6 h-6\" />\n                    문제 데이터 초기화\n                  </CardTitle>\n                  <CardDescription>\n                    데이터베이스에 물리학 프리미엄 16개 단원의 모든 문제를 저장합니다\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"p-4 bg-orange-500/10 border border-orange-500/30 rounded-lg\">\n                    <p className=\"text-sm font-medium mb-2\">⚠️ 언제 사용하나요?</p>\n                    <ul className=\"list-disc list-inside space-y-1 text-sm text-muted-foreground\">\n                      <li>배포 직후 데이터베이스가 비어있을 때</li>\n                      <li>학생들이 시험을 볼 수 없다고 할 때</li>\n                      <li>\"문제를 불러올 수 없습니다\" 오류가 발생할 때</li>\n                    </ul>\n                  </div>\n\n                  <div className=\"flex gap-2\">\n                    <Button\n                      onClick={handleInitData}\n                      disabled={initDataMutation.isPending}\n                      variant=\"default\"\n                      className=\"flex-1\"\n                      data-testid=\"button-init-data\"\n                    >\n                      <Database className={`w-4 h-4 mr-2 ${initDataMutation.isPending ? 'animate-pulse' : ''}`} />\n                      {initDataMutation.isPending ? \"초기화 중...\" : \"문제 데이터 초기화\"}\n                    </Button>\n                  </div>\n\n                  <div className=\"pt-4 border-t space-y-2\">\n                    <h4 className=\"font-semibold\">📝 초기화 내용:</h4>\n                    <ul className=\"list-disc list-inside space-y-1 text-sm text-muted-foreground\">\n                      <li>16개 단원의 모든 객관식/주관식 문제</li>\n                      <li>각 문제의 정답 및 메타데이터</li>\n                      <li>총 960개의 문제 데이터</li>\n                    </ul>\n                  </div>\n\n                  <div className=\"pt-4 border-t space-y-2\">\n                    <h4 className=\"font-semibold\">✅ 초기화 완료 후:</h4>\n                    <ol className=\"list-decimal list-inside space-y-1 text-sm text-muted-foreground\">\n                      <li>학생들이 모든 단원의 시험을 볼 수 있습니다</li>\n                      <li>OMR 답안 입력 화면이 정상 표시됩니다</li>\n                      <li>즉시 채점 및 성적 분석이 가능합니다</li>\n                    </ol>\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n          </Tabs>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":32589,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1592,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"'Noto Sans KR'\", \"'Inter'\", \"sans-serif\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"'JetBrains Mono'\", \"monospace\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":4086,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"client/src/pages/exams.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useLocation, useParams } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { GraduationCap, LogOut, ChevronLeft, FileText, Calendar } from \"lucide-react\";\nimport { useEffect } from \"react\";\nimport type { Exam } from \"@shared/schema\";\n\nexport default function ExamsPage() {\n  const [, setLocation] = useLocation();\n  const params = useParams();\n  const schoolId = params.schoolId ? parseInt(params.schoolId) : null;\n  \n  const studentData = sessionStorage.getItem(\"student\");\n  const student = studentData ? JSON.parse(studentData) : null;\n\n  useEffect(() => {\n    if (!student) {\n      setLocation(\"/\");\n    }\n  }, [student, setLocation]);\n\n  const { data: exams, isLoading } = useQuery<Exam[]>({\n    queryKey: [`/api/schools/${schoolId}/exams`],\n    enabled: !!student && !!schoolId,\n  });\n\n  const handleLogout = () => {\n    sessionStorage.removeItem(\"student\");\n    setLocation(\"/\");\n  };\n\n  const handleBack = () => {\n    setLocation(\"/schools\");\n  };\n\n  const handleExamSelect = (examId: number) => {\n    setLocation(`/test/${examId}`);\n  };\n\n  if (!student || !schoolId) {\n    return null;\n  }\n\n  const schoolName = exams?.[0]?.schoolName || \"\";\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"sticky top-0 z-50 border-b bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60\">\n        <div className=\"container mx-auto px-4 py-4 flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center\">\n              <GraduationCap className=\"w-5 h-5 text-primary\" />\n            </div>\n            <div>\n              <h1 className=\"text-lg font-bold\">목동에이원과학학원</h1>\n              <p className=\"text-xs font-semibold text-primary\">프리미엄 학습관리 시스템</p>\n              {schoolName && <p className=\"text-xs text-muted-foreground\">{schoolName}</p>}\n            </div>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <div className=\"text-right hidden sm:block\">\n              <p className=\"text-sm font-medium\">{student.studentName}</p>\n              <p className=\"text-xs text-muted-foreground font-mono\">{student.studentId}</p>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              data-testid=\"button-logout\"\n              onClick={handleLogout}\n            >\n              <LogOut className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"container mx-auto px-4 py-8\">\n        <div className=\"max-w-5xl mx-auto space-y-8\">\n          <div className=\"flex items-center gap-4\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setLocation(\"/units\")}\n              data-testid=\"button-back\"\n            >\n              <ChevronLeft className=\"w-4 h-4 mr-1\" />\n              단원 선택\n            </Button>\n          </div>\n\n          <div className=\"text-center space-y-2\">\n            <h2 className=\"text-3xl font-bold\">시험 선택</h2>\n            <p className=\"text-muted-foreground\">\n              풀고 싶은 기출문제를 선택해주세요\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {isLoading ? (\n              Array.from({ length: 6 }).map((_, i) => (\n                <Card key={i} className=\"p-6\">\n                  <Skeleton className=\"h-32 w-full\" />\n                </Card>\n              ))\n            ) : exams && exams.length > 0 ? (\n              exams.map((exam) => (\n                <Card\n                  key={exam.id}\n                  className=\"hover-elevate active-elevate-2 transition-all cursor-pointer group\"\n                  onClick={() => handleExamSelect(exam.id)}\n                  data-testid={`card-exam-${exam.id}`}\n                >\n                  <CardHeader className=\"space-y-4\">\n                    <div className=\"flex items-center justify-center\">\n                      <div className=\"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center\">\n                        <FileText className=\"w-8 h-8 text-primary\" />\n                      </div>\n                    </div>\n                    <CardTitle className=\"text-lg text-center leading-tight\">\n                      {exam.year}년 {exam.semester}\n                    </CardTitle>\n                    <CardDescription className=\"text-center\">\n                      <Badge variant=\"secondary\">{exam.subject}</Badge>\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <Button\n                      className=\"w-full\"\n                      data-testid={`button-start-exam-${exam.id}`}\n                    >\n                      <Calendar className=\"w-4 h-4 mr-2\" />\n                      시험 시작\n                    </Button>\n                  </CardContent>\n                </Card>\n              ))\n            ) : (\n              <div className=\"col-span-full text-center py-12\">\n                <p className=\"text-muted-foreground\">등록된 시험이 없습니다.</p>\n                <p className=\"text-sm text-muted-foreground mt-2\">\n                  관리자에게 문의해주세요.\n                </p>\n              </div>\n            )}\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":5777,"size_tokens":null},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.11\"\ndependencies = [\n    \"numpy>=2.3.4\",\n    \"opencv-python>=4.11.0.86\",\n    \"pdfplumber>=0.11.8\",\n    \"pillow>=12.0.0\",\n    \"pypdf2>=3.0.1\",\n]\n","path":null,"size_bytes":265,"size_tokens":null},"client/src/pages/schools.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { GraduationCap, LogOut, Building2, BarChart3 } from \"lucide-react\";\nimport { useEffect } from \"react\";\nimport type { School } from \"@shared/schema\";\n\nexport default function SchoolsPage() {\n  const [, setLocation] = useLocation();\n  const studentData = sessionStorage.getItem(\"student\");\n  const student = studentData ? JSON.parse(studentData) : null;\n\n  useEffect(() => {\n    if (!student) {\n      setLocation(\"/\");\n    }\n  }, [student, setLocation]);\n\n  const { data: schools, isLoading } = useQuery<School[]>({\n    queryKey: [\"/api/schools\"],\n    enabled: !!student,\n  });\n\n  const handleLogout = () => {\n    sessionStorage.removeItem(\"student\");\n    setLocation(\"/\");\n  };\n\n  const handleSchoolSelect = (schoolId: number) => {\n    setLocation(`/exams/${schoolId}`);\n  };\n\n  const handleViewReports = () => {\n    setLocation(\"/reports\");\n  };\n\n  if (!student) {\n    return null;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"sticky top-0 z-50 border-b bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60\">\n        <div className=\"container mx-auto px-4 py-4 flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center\">\n              <GraduationCap className=\"w-5 h-5 text-primary\" />\n            </div>\n            <div>\n              <h1 className=\"text-lg font-bold\">목동에이원과학학원</h1>\n              <p className=\"text-xs font-semibold text-primary\">프리미엄 학습관리 시스템</p>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <div className=\"text-right hidden sm:block\">\n              <p className=\"text-sm font-medium\">{student.studentName}</p>\n              <p className=\"text-xs text-muted-foreground font-mono\">{student.studentId}</p>\n            </div>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              data-testid=\"button-view-reports\"\n              onClick={handleViewReports}\n            >\n              <BarChart3 className=\"w-4 h-4 mr-2\" />\n              성적 확인\n            </Button>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              data-testid=\"button-logout\"\n              onClick={handleLogout}\n            >\n              <LogOut className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"container mx-auto px-4 py-8\">\n        <div className=\"max-w-5xl mx-auto space-y-8\">\n          <div className=\"text-center space-y-2\">\n            <h2 className=\"text-3xl font-bold\">학교 선택</h2>\n            <p className=\"text-muted-foreground\">\n              기출문제를 풀 학교를 선택해주세요\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {isLoading ? (\n              Array.from({ length: 6 }).map((_, i) => (\n                <Card key={i} className=\"p-6\">\n                  <Skeleton className=\"h-24 w-full\" />\n                </Card>\n              ))\n            ) : schools && schools.length > 0 ? (\n              schools.map((school) => (\n                <Card\n                  key={school.id}\n                  className=\"hover-elevate active-elevate-2 transition-all cursor-pointer group\"\n                  onClick={() => handleSchoolSelect(school.id)}\n                  data-testid={`card-school-${school.id}`}\n                >\n                  <CardHeader className=\"space-y-4\">\n                    <div className=\"flex items-center justify-center\">\n                      <div className=\"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center\">\n                        <Building2 className=\"w-8 h-8 text-primary\" />\n                      </div>\n                    </div>\n                    <CardTitle className=\"text-xl text-center leading-tight\">\n                      {school.name}\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <Button\n                      className=\"w-full\"\n                      data-testid={`button-select-school-${school.id}`}\n                    >\n                      기출문제 보기\n                    </Button>\n                  </CardContent>\n                </Card>\n              ))\n            ) : (\n              <div className=\"col-span-full text-center py-12\">\n                <p className=\"text-muted-foreground\">등록된 학교가 없습니다.</p>\n                <p className=\"text-sm text-muted-foreground mt-2\">\n                  관리자에게 문의해주세요.\n                </p>\n              </div>\n            )}\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":5190,"size_tokens":null},"scripts/loadAllExams.ts":{"content":"import { neon } from '@neondatabase/serverless';\nimport * as fs from 'fs';\n\nconst sql = neon(process.env.DATABASE_URL!);\n\ninterface Question {\n  number: number;\n  type: string;\n  category: string;\n  unit: string;\n  answer: string[];\n}\n\ninterface ExamData {\n  school_name: string;\n  year: number | null;\n  semester: string;\n  questions: Question[];\n}\n\nfunction parseAnswerFile(filePath: string): ExamData[] {\n  const content = fs.readFileSync(filePath, 'utf-8');\n  const exams: ExamData[] = [];\n  \n  // Split by school sections\n  const sections = content.split(/---\\s*\\n+###\\s+\\d+\\.\\s+/);\n  console.log(`  File: ${filePath} -> ${sections.length - 1} sections`);\n  \n  for (const section of sections.slice(1)) {  // Skip intro\n    // Extract school name and exam info\n    const headerMatch = section.match(/^([^(]+)\\s+\\(([^)]+)\\)/);\n    if (!headerMatch) {\n      console.log(`    No header match for section starting: \"${section.substring(0, 50)}...\"`);\n      continue;\n    }\n    \n    const schoolName = headerMatch[1].trim();\n    const examInfo = headerMatch[2].trim();\n    \n    // Parse year and semester\n    const yearMatch = examInfo.match(/(\\d{4})/);\n    const semesterMatch = examInfo.match(/(\\d+학기|1학년\\s*\\d+학기)\\s*(중간|기말)/);\n    \n    const year = yearMatch ? parseInt(yearMatch[1]) : null;\n    const semester = semesterMatch ? semesterMatch[0] : examInfo;\n    \n    // Extract questions\n    const questions: Question[] = [];\n    \n    // Find 선택형 section\n    const multipleChoiceMatch = section.match(/#### 선택형\\s*\\n+(.*?)(?=####|---|\\n\\n### |\\Z)/s);\n    if (multipleChoiceMatch) {\n      const mcContent = multipleChoiceMatch[1];\n      // Parse each question with category/unit info\n      // Pattern: * 1번 🧬생명(물질) 정답 ③\n      const questionPattern = /\\*\\s+(\\d+)번\\s+(⚡️|🧪|🌍|🌎|🧬|⚛️|💡)\\s*([^(]+)\\(([^)]+)\\)\\s+정답\\s+([①②③④⑤,\\s]+)/g;\n      let match;\n      \n      // Debug: Check if content has the expected format\n      const firstLine = mcContent.split('\\n')[0];\n      if (schoolName === '구로고등학교' && year === 2024) {\n        console.log(`      구로고등학교 첫 줄: \"${firstLine}\"`);\n        console.log(`      첫 200자: \"${mcContent.substring(0, 200)}\"`);\n      }\n      \n      while ((match = questionPattern.exec(mcContent)) !== null) {\n        const qNum = parseInt(match[1]);\n        const emoji = match[2];\n        const categoryRaw = match[3].trim();\n        const unitRaw = match[4].trim();\n        const answerText = match[5].trim();\n        \n        // Map emoji to category\n        const categoryMap: Record<string, string> = {\n          '⚡️': '에너지',\n          '🧪': '화학',\n          '🌍': '생태계',\n          '🌎': '지구',\n          '🧬': '생명',\n          '⚛️': '화학',\n          '💡': '신소재'\n        };\n        \n        const category = categoryMap[emoji] || '에너지';\n        \n        // Extract unit - take first part before any slash\n        const unit = unitRaw.split('/')[0].trim();\n        \n        // Handle multiple answers\n        const answers: string[] = [];\n        const answerChars = answerText.match(/[①②③④⑤]/g);\n        if (answerChars) {\n          answers.push(...answerChars);\n        }\n        \n        if (answers.length > 0) {\n          questions.push({\n            number: qNum,\n            type: '객관식',\n            category,\n            unit,\n            answer: answers\n          });\n        }\n      }\n    }\n    \n    if (questions.length > 0) {\n      exams.push({\n        school_name: schoolName,\n        year,\n        semester,\n        questions\n      });\n    } else {\n      console.log(`    Skipping ${schoolName} (${year} ${semester}) - no questions parsed`);\n    }\n  }\n  \n  return exams;\n}\n\nasync function loadAllExams() {\n  console.log('Parsing answer files...');\n  \n  const file1 = 'attached_assets/Pasted--cite--1763100515683_1763100515683.txt';\n  const file2 = 'attached_assets/Pasted---1763100538213_1763100538214.txt';\n  \n  const allExams: ExamData[] = [];\n  allExams.push(...parseAnswerFile(file1));\n  allExams.push(...parseAnswerFile(file2));\n  \n  console.log(`Found ${allExams.length} exams`);\n  \n  let totalQuestions = 0;\n  \n  for (const examData of allExams) {\n    const { school_name, year, semester, questions } = examData;\n    \n    if (questions.length === 0) {\n      console.log(`Skipping ${school_name} (${year} ${semester}) - no questions found`);\n      continue;\n    }\n    \n    // Check if school exists\n    let schoolResult = await sql`SELECT id FROM schools WHERE name = ${school_name}`;\n    let schoolId: number;\n    \n    if (schoolResult.length === 0) {\n      // Insert school\n      const newSchool = await sql`\n        INSERT INTO schools (name) \n        VALUES (${school_name}) \n        RETURNING id\n      `;\n      schoolId = newSchool[0].id;\n      console.log(`Created school: ${school_name} (ID: ${schoolId})`);\n    } else {\n      schoolId = schoolResult[0].id;\n    }\n    \n    // Check if exam exists\n    const examResult = await sql`\n      SELECT id FROM exams \n      WHERE school_id = ${schoolId} AND year = ${year} AND semester = ${semester}\n    `;\n    \n    let examId: number;\n    \n    if (examResult.length > 0) {\n      examId = examResult[0].id;\n      console.log(`Exam already exists: ${school_name} (${year} ${semester}) - updating questions`);\n      // Delete existing questions\n      await sql`DELETE FROM questions WHERE exam_id = ${examId}`;\n    } else {\n      // Create exam\n      const newExam = await sql`\n        INSERT INTO exams (school_id, school_name, year, semester)\n        VALUES (${schoolId}, ${school_name}, ${year}, ${semester})\n        RETURNING id\n      `;\n      examId = newExam[0].id;\n      console.log(`Created exam: ${school_name} (${year} ${semester}) - ID: ${examId}`);\n    }\n    \n    // Insert questions\n    for (const q of questions) {\n      // Convert answer array to sorted JSON string\n      const answerJson = JSON.stringify(q.answer.sort());\n      const isMultiple = q.answer.length > 1;\n      \n      await sql`\n        INSERT INTO questions (exam_id, question_number, type, category, unit, answer, is_multiple_answer)\n        VALUES (${examId}, ${q.number}, ${q.type}, ${q.category}, ${q.unit}, ${answerJson}, ${isMultiple})\n      `;\n      totalQuestions++;\n    }\n    \n    console.log(`  Added ${questions.length} questions`);\n  }\n  \n  console.log(`\\nTotal: ${allExams.length} exams, ${totalQuestions} questions loaded`);\n}\n\nloadAllExams().catch(console.error);\n","path":null,"size_bytes":6535,"size_tokens":null},"main.py":{"content":"def main():\n    print(\"Hello from repl-nix-workspace!\")\n\n\nif __name__ == \"__main__\":\n    main()\n","path":null,"size_bytes":96,"size_tokens":null},"server/omr_process.py":{"content":"#!/usr/bin/env python3\n\"\"\"\nOMR 이미지 처리 스크립트\nNode.js에서 호출되어 이미지를 처리하고 결과를 JSON으로 반환합니다.\n\"\"\"\n\nimport sys\nimport json\nfrom omr_scanner import process_omr_image\n\ndef main():\n    if len(sys.argv) < 2:\n        print(json.dumps({\"error\": \"이미지 경로가 제공되지 않았습니다\"}))\n        sys.exit(1)\n    \n    image_path = sys.argv[1]\n    total_questions = int(sys.argv[2]) if len(sys.argv) > 2 else 30\n    \n    try:\n        # 이미지 파일 읽기\n        with open(image_path, 'rb') as f:\n            image_data = f.read()\n        \n        # OMR 처리\n        answers = process_omr_image(image_data, total_questions)\n        \n        # 결과를 JSON으로 출력\n        result = {\n            \"success\": True,\n            \"answers\": answers,\n            \"message\": f\"{len(answers)}개 답안을 인식했습니다\"\n        }\n        print(json.dumps(result, ensure_ascii=False))\n        \n    except Exception as e:\n        error_result = {\n            \"success\": False,\n            \"error\": str(e),\n            \"message\": f\"OMR 처리 중 오류 발생: {str(e)}\"\n        }\n        print(json.dumps(error_result, ensure_ascii=False))\n        sys.exit(1)\n\nif __name__ == \"__main__\":\n    main()\n","path":null,"size_bytes":1269,"size_tokens":null},"server/omr_scanner.py":{"content":"import cv2\nimport numpy as np\nfrom typing import Dict, List, Tuple, Optional\nimport base64\nfrom io import BytesIO\nfrom PIL import Image\n\nclass OMRScanner:\n    \"\"\"\n    OMR 답안지 이미지를 처리하여 학생이 체크한 답안을 자동으로 인식하는 클래스\n    \"\"\"\n    \n    def __init__(self, total_questions: int = 30, choices_per_question: int = 5):\n        self.total_questions = total_questions\n        self.choices_per_question = choices_per_question\n        \n    def process_image(self, image_data: bytes) -> Dict[int, str]:\n        \"\"\"\n        OMR 이미지를 처리하여 답안을 추출합니다.\n        \n        Args:\n            image_data: 이미지 바이트 데이터\n            \n        Returns:\n            Dict[int, str]: {문제번호: 답안} 형식의 딕셔너리\n            예: {1: \"1\", 2: \"3\", 5: \"2,4\"}  (복수 정답은 쉼표로 구분)\n        \"\"\"\n        try:\n            # 이미지 로드\n            nparr = np.frombuffer(image_data, np.uint8)\n            image = cv2.imdecode(nparr, cv2.IMREAD_COLOR)\n            \n            if image is None:\n                raise ValueError(\"이미지를 로드할 수 없습니다\")\n            \n            # 이미지 전처리\n            processed = self._preprocess_image(image)\n            \n            # 답안지 영역 감지 및 변환\n            warped = self._detect_and_warp_paper(image, processed)\n            \n            if warped is None:\n                raise ValueError(\"답안지를 감지할 수 없습니다. 4개 모서리가 모두 보이는지 확인하세요.\")\n            \n            # 버블 감지 및 답안 추출\n            answers = self._extract_answers(warped)\n            \n            return answers\n            \n        except Exception as e:\n            raise Exception(f\"OMR 처리 중 오류 발생: {str(e)}\")\n    \n    def _preprocess_image(self, image: np.ndarray) -> np.ndarray:\n        \"\"\"이미지 전처리: 그레이스케일, 블러, 이진화\"\"\"\n        gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)\n        blurred = cv2.GaussianBlur(gray, (5, 5), 0)\n        edged = cv2.Canny(blurred, 75, 200)\n        return edged\n    \n    def _detect_and_warp_paper(self, image: np.ndarray, edged: np.ndarray) -> Optional[np.ndarray]:\n        \"\"\"\n        답안지 영역을 감지하고 원근 변환을 적용하여 정면 뷰를 얻습니다.\n        4개 모서리의 검은 마커를 찾아 답안지를 인식합니다.\n        \"\"\"\n        # 윤곽선 찾기\n        contours, _ = cv2.findContours(edged.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)\n        \n        if len(contours) == 0:\n            return None\n        \n        # 가장 큰 사각형 윤곽선 찾기 (답안지)\n        contours = sorted(contours, key=cv2.contourArea, reverse=True)\n        \n        paper_contour = None\n        for contour in contours[:10]:\n            perimeter = cv2.arcLength(contour, True)\n            approx = cv2.approxPolyDP(contour, 0.02 * perimeter, True)\n            \n            # 사각형 (4개 꼭지점) 찾기\n            if len(approx) == 4:\n                paper_contour = approx\n                break\n        \n        if paper_contour is None:\n            return None\n        \n        # 원근 변환 적용\n        warped = self._four_point_transform(image, paper_contour.reshape(4, 2))\n        return warped\n    \n    def _four_point_transform(self, image: np.ndarray, pts: np.ndarray) -> np.ndarray:\n        \"\"\"4점 원근 변환\"\"\"\n        # 점들을 정렬: [top-left, top-right, bottom-right, bottom-left]\n        rect = self._order_points(pts)\n        (tl, tr, br, bl) = rect\n        \n        # 새로운 이미지의 너비 계산\n        widthA = np.sqrt(((br[0] - bl[0]) ** 2) + ((br[1] - bl[1]) ** 2))\n        widthB = np.sqrt(((tr[0] - tl[0]) ** 2) + ((tr[1] - tl[1]) ** 2))\n        maxWidth = max(int(widthA), int(widthB))\n        \n        # 새로운 이미지의 높이 계산\n        heightA = np.sqrt(((tr[0] - br[0]) ** 2) + ((tr[1] - br[1]) ** 2))\n        heightB = np.sqrt(((tl[0] - bl[0]) ** 2) + ((tl[1] - bl[1]) ** 2))\n        maxHeight = max(int(heightA), int(heightB))\n        \n        # 변환될 좌표\n        dst = np.array([\n            [0, 0],\n            [maxWidth - 1, 0],\n            [maxWidth - 1, maxHeight - 1],\n            [0, maxHeight - 1]\n        ], dtype=\"float32\")\n        \n        # 원근 변환 매트릭스 계산 및 적용\n        M = cv2.getPerspectiveTransform(rect, dst)\n        warped = cv2.warpPerspective(image, M, (maxWidth, maxHeight))\n        \n        return warped\n    \n    def _order_points(self, pts: np.ndarray) -> np.ndarray:\n        \"\"\"4개 점을 [top-left, top-right, bottom-right, bottom-left] 순서로 정렬\"\"\"\n        rect = np.zeros((4, 2), dtype=\"float32\")\n        \n        # 합이 가장 작은 점이 top-left, 가장 큰 점이 bottom-right\n        s = pts.sum(axis=1)\n        rect[0] = pts[np.argmin(s)]\n        rect[2] = pts[np.argmax(s)]\n        \n        # 차이가 가장 작은 점이 top-right, 가장 큰 점이 bottom-left\n        diff = np.diff(pts, axis=1)\n        rect[1] = pts[np.argmin(diff)]\n        rect[3] = pts[np.argmax(diff)]\n        \n        return rect\n    \n    def _extract_answers(self, warped_image: np.ndarray) -> Dict[int, str]:\n        \"\"\"\n        변환된 답안지 이미지에서 버블을 감지하고 답안을 추출합니다.\n        \"\"\"\n        # 그레이스케일 및 이진화\n        gray = cv2.cvtColor(warped_image, cv2.COLOR_BGR2GRAY)\n        thresh = cv2.threshold(gray, 0, 255, cv2.THRESH_BINARY_INV | cv2.THRESH_OTSU)[1]\n        \n        # 버블 윤곽선 찾기\n        contours, _ = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)\n        \n        # 버블로 보이는 윤곽선 필터링\n        bubble_contours = []\n        for contour in contours:\n            (x, y, w, h) = cv2.boundingRect(contour)\n            aspect_ratio = w / float(h)\n            \n            # 원형에 가까운 것만 선택 (aspect ratio가 1에 가까움)\n            # 크기도 적절한 범위 내에 있어야 함\n            if w >= 15 and h >= 15 and w <= 50 and h <= 50 and aspect_ratio >= 0.7 and aspect_ratio <= 1.3:\n                bubble_contours.append(contour)\n        \n        if len(bubble_contours) == 0:\n            raise ValueError(\"버블을 찾을 수 없습니다. 이미지 품질을 확인하세요.\")\n        \n        # 버블을 위에서 아래로, 왼쪽에서 오른쪽으로 정렬\n        bubble_contours = self._sort_contours(bubble_contours)\n        \n        # 답안 추출\n        answers = {}\n        bubbles_per_question = self.choices_per_question\n        \n        # 각 문제별로 버블 그룹핑\n        for question_idx in range(0, len(bubble_contours), bubbles_per_question):\n            if question_idx + bubbles_per_question > len(bubble_contours):\n                break\n            \n            question_bubbles = bubble_contours[question_idx:question_idx + bubbles_per_question]\n            question_num = (question_idx // bubbles_per_question) + 1\n            \n            if question_num > self.total_questions:\n                break\n            \n            # 각 버블의 채워진 정도 확인\n            filled_choices = []\n            for choice_idx, bubble in enumerate(question_bubbles):\n                # 마스크 생성\n                mask = np.zeros(thresh.shape, dtype=\"uint8\")\n                cv2.drawContours(mask, [bubble], -1, 255, -1)\n                \n                # 버블 영역 내의 흰색 픽셀 수 계산\n                mask = cv2.bitwise_and(thresh, thresh, mask=mask)\n                total = cv2.countNonZero(mask)\n                \n                # 임계값 이상이면 체크된 것으로 판단\n                (x, y, w, h) = cv2.boundingRect(bubble)\n                bubble_area = w * h\n                fill_ratio = total / float(bubble_area) if bubble_area > 0 else 0\n                \n                # 채움 비율이 25% 이상이면 체크된 것으로 간주\n                if fill_ratio > 0.25:\n                    filled_choices.append(str(choice_idx + 1))\n            \n            # 답안 저장 (복수 정답은 쉼표로 구분)\n            if filled_choices:\n                answers[question_num] = \",\".join(filled_choices)\n        \n        return answers\n    \n    def _sort_contours(self, contours: List, method: str = \"top-to-bottom\") -> List:\n        \"\"\"윤곽선을 정렬합니다\"\"\"\n        # 경계 박스 계산\n        bounding_boxes = [cv2.boundingRect(c) for c in contours]\n        \n        # Y 좌표로 먼저 정렬 (위에서 아래로)\n        # 같은 행에 있는 것들은 X 좌표로 정렬 (왼쪽에서 오른쪽으로)\n        sorted_items = []\n        for i, (x, y, w, h) in enumerate(bounding_boxes):\n            sorted_items.append((y, x, contours[i]))\n        \n        sorted_items.sort(key=lambda item: (item[0] // 30, item[1]))  # Y를 30으로 나눈 몫으로 행 구분\n        \n        return [item[2] for item in sorted_items]\n\n\ndef process_omr_image(image_data: bytes, total_questions: int = 30) -> Dict[int, str]:\n    \"\"\"\n    OMR 이미지를 처리하는 헬퍼 함수\n    \n    Args:\n        image_data: 이미지 바이트 데이터\n        total_questions: 전체 문제 수\n        \n    Returns:\n        Dict[int, str]: 문제번호와 답안 딕셔너리\n    \"\"\"\n    scanner = OMRScanner(total_questions=total_questions)\n    return scanner.process_image(image_data)\n","path":null,"size_bytes":9504,"size_tokens":null},"사용설명서.md":{"content":"# 목동에이원과학학원 프리미엄내신관리 시스템\n## 사용 설명서\n\n---\n\n## 🎯 시스템 소개\n\n**목동에이원과학학원 프리미엄내신관리 시스템**은 학생 개개인의 학습 효율을 극대화하기 위해 개발된 차세대 학습 분석 플랫폼입니다.\n\n단순한 채점을 넘어, **16개 학교의 실제 기출문제 579문항**을 기반으로 학생의 강점과 약점을 정밀하게 분석하여 맞춤형 학습 가이드를 제공합니다.\n\n---\n\n## ✨ 시스템의 6가지 핵심 특징\n\n### 1. 📱 스마트폰 OMR 스캔 (NEW!)\n- **종이 답안지 자동 인식**: 연필로 작성한 OMR 답안지를 스마트폰으로 촬영하면 자동 인식\n- **복수 정답 지원**: 여러 개 칠한 답안도 정확하게 인식\n- **하이브리드 입력**: OMR 스캔 + 화면 수정 병행 가능\n- **컴퓨터 비전 기술**: Python OpenCV로 정밀한 버블 인식\n\n### 2. 📊 실시간 성적 분석 시스템\n- **즉각적인 채점**: 답안 제출 즉시 자동 채점 및 결과 확인\n- **단원별 성취도 분석**: 각 단원(물질과 규칙성, 시스템과 상호작용, 변화와 다양성, 환경과 에너지)별 정답률 실시간 제공\n- **전체 학생 평균 비교**: 나의 점수와 전체 평균을 비교하여 객관적 위치 파악\n\n### 3. 🎨 화려한 데이터 시각화\n- **다중 차트 시스템**: 바 차트, 레이더 차트, 라인 차트를 활용한 입체적 분석\n- **색상 코드 피드백**: 성취도에 따른 직관적 색상 시스템 (90점 이상 초록, 70점 이상 파랑, 50점 이상 주황, 50점 미만 빨강)\n- **애니메이션 효과**: 성적 표시 시 동적 효과로 성취감 극대화\n\n### 4. 🏆 단원별 비교 우위 분석\n학생이 제출한 시험의 각 단원별로:\n- **전체 학생 평균점수** 자동 계산\n- **전체 최고점수** 실시간 갱신\n- **응시 학생 수** 표시로 신뢰도 확인\n- 나의 점수와 비교하여 **강점 단원**과 **보완 필요 단원** 한눈에 파악\n\n### 5. 💡 스마트 부분 제출 시스템\n- **유연한 시험 응시**: 모든 문제를 풀지 않아도 제출 가능\n- **시험범위 외 처리**: 답하지 않은 문제는 \"시험범위 외\"로 자동 분류 (학생 실수가 아닌 의도적 제외로 간주)\n- **복수 정답 지원**: 복수 정답 문제 완벽 대응 (여러 선택지 동시 선택 가능)\n\n### 6. 📈 누적 학습 이력 관리\n- **전체 응시 기록**: 학생이 제출한 모든 시험 결과 영구 보관\n- **구글 시트 자동 연동**: 모든 시험 결과가 구글 시트에 자동 기록되어 학원과 학생이 언제든 확인 가능\n- **성장 추적**: 시간에 따른 성적 변화 추이 분석\n\n---\n\n## 🚀 시스템 사용 방법\n\n### STEP 1: 로그인\n1. 첫 화면에서 **학생 ID**와 **이름**을 입력합니다\n2. \"로그인\" 버튼을 클릭하여 시스템에 접속합니다\n\n**💡 TIP**: 학생 정보는 학원 데이터베이스에 사전 등록되어 있어 안전하게 관리됩니다.\n\n---\n\n### STEP 2: 학교 선택\n로그인 후 나타나는 학교 목록에서 **내가 다니는 학교** 또는 **풀고 싶은 학교의 기출문제**를 선택합니다.\n\n**현재 지원 학교**: 16개 학교\n- 각 학교별로 실제 기출문제 데이터 완비\n\n---\n\n### STEP 3: 시험 선택\n선택한 학교의 기출문제 목록에서 원하는 시험을 고릅니다.\n\n각 시험 카드에는:\n- **시험 연도**\n- **학기** (1학기 중간고사, 1학기 기말고사 등)\n- **과목** (통합과학)\n\n정보가 표시되어 원하는 시험을 쉽게 찾을 수 있습니다.\n\n---\n\n### STEP 4: OMR 답안 작성 (2가지 방법)\n\n#### 📱 방법 1: OMR 답안지 스캔 (NEW!)\n\n시스템에서 제공하는 **OMR 답안지**를 출력하여 연필로 작성한 후 스마트폰으로 촬영하면 자동으로 답안이 인식됩니다!\n\n**스캔 준비:**\n1. 시스템에서 **OMR 답안지 템플릿** 다운로드 (A4 용지)\n2. 출력 후 연필이나 볼펜으로 동그라미 선택지를 **진하게 칠하기**\n3. 복수 정답은 여러 개 칠하면 자동 인식\n\n**스캔 방법:**\n1. 시험 페이지 상단의 **📷 카메라로 스캔** 버튼 클릭 (스마트폰의 경우)\n2. 또는 **📁 파일 업로드** 버튼으로 촬영한 사진 선택\n3. 답안지를 **평평하게** 놓고 **네 모서리**가 모두 보이도록 촬영\n4. 자동으로 답안이 인식되어 화면에 체크됩니다!\n\n**💡 스캔 TIP**:\n- 조명이 밝은 곳에서 촬영\n- 그림자가 생기지 않도록 정면에서 촬영\n- 네 모서리 마커(●)가 모두 보이게 촬영\n- 스캔 후에도 수동으로 수정 가능\n\n#### 🖱️ 방법 2: 화면에서 직접 선택\n\n**4-1. 진행률 확인**\n화면 상단에 **답변한 문제 수 / 전체 문제 수**와 **진행률 바**가 표시됩니다.\n\n**4-2. 답안 선택**\n- 각 문제 번호 아래 선택지(①, ②, ③, ④, ⑤)를 클릭하여 답안 선택\n- **복수 정답 문제**: 여러 개 선택 가능 (클릭할 때마다 선택/해제 토글)\n- 선택한 답안은 **파란색**으로 표시됩니다\n\n**4-3. 부분 제출**\n- 모든 문제를 풀지 않아도 **\"제출하기\"** 버튼 활성화\n- 최소 1문제 이상만 답하면 제출 가능\n- 답하지 않은 문제는 **시험범위 외**로 자동 처리 (0점 처리되지 않음)\n\n**💡 TIP**: \n- OMR 스캔 + 수동 입력 **병행 가능** (스캔 후 일부 문제만 수정)\n- 시간이 부족할 때는 아는 문제만 먼저 제출 가능\n- 나중에 다시 응시하여 전체 범위 학습 가능\n\n---\n\n### STEP 5: 결과 확인 - 화려한 분석 화면\n\n제출 즉시 **프리미엄 성적 분석 페이지**로 이동합니다.\n\n#### 📊 메인 대시보드\n상단에 큰 성적 카드가 나타나며:\n- **성취율 점수** (0-100점)\n- **등급 표시** (S, A, B, C, D)\n- **성취도에 따른 색상 및 아이콘**\n\n#### 📈 상세 통계 (3개 카드)\n1. **정답 수**: 맞힌 문제 개수\n2. **응답한 문제 수**: 실제로 답한 문제 수\n3. **정답률**: 백분율로 표시\n\n#### 🎯 단원별 성취도 분석 (핵심 기능!)\n\n**탭 1: 바 차트**\n- 각 단원별 나의 정답 개수를 막대 그래프로 표시\n- 단원별 색상 구분으로 한눈에 비교\n\n**탭 2: 레이더 차트**\n- 5개 영역(4개 단원 + 전체)의 균형을 시각화\n- 약한 단원이 어디인지 즉시 파악 가능\n\n**탭 3: 상세 분석표**\n각 단원별로:\n- 📚 **정답/전체 문제 수**\n- 📊 **정답률 진행 바**\n- 💯 **내 점수**\n- 📈 **전체 평균** (이 시험을 푼 모든 학생의 평균)\n- 🏆 **최고점** (이 시험을 푼 학생 중 최고 점수)\n- 👥 **응시자 수**\n\n**✅ 나보다 높으면**: 초록색 화살표 (↗) - \"평균보다 높음\"  \n**⚠️ 나보다 낮으면**: 빨간색 화살표 (↘) - \"평균보다 낮음\"\n\n#### 📝 문제별 상세 결과\n\n각 문제마다:\n- **문제 번호**\n- **내 답안** vs **정답**\n- **정/오답 표시** (✓ 초록색 / ✗ 빨간색)\n- **복수 정답 여부** 뱃지\n- **무응답 문제**: \"시험범위 외\" 표시\n\n---\n\n### STEP 6: 학습 기록 조회\n우측 상단 **\"성적 기록\"** 버튼을 클릭하면:\n- 지금까지 제출한 **모든 시험 결과** 확인\n- 각 시험별 **점수, 응답 수, 정답 수, 단원별 분석** 보관\n- **시간순 정렬**로 학습 성장 추적\n\n---\n\n## 🎓 학습 효과\n\n### 1️⃣ 즉각적인 피드백\n제출 즉시 결과를 확인하여 **기억이 생생할 때** 오답을 복습할 수 있습니다.\n\n### 2️⃣ 맞춤형 학습 계획\n단원별 분석을 통해 **어느 영역을 집중 학습**해야 하는지 명확히 알 수 있습니다.\n\n### 3️⃣ 객관적 위치 파악\n전체 평균 및 최고점과 비교하여 **나의 실력을 객관적으로 평가**할 수 있습니다.\n\n### 4️⃣ 동기 부여\n화려한 차트와 색상 피드백으로 **학습 성취감**을 극대화하고 **지속적인 학습 동기**를 제공합니다.\n\n### 5️⃣ 효율적 시간 관리\n부분 제출 기능으로 **시간이 부족할 때도 아는 문제부터** 풀고 제출할 수 있어 효율적입니다.\n\n---\n\n## 🔒 데이터 보안 및 관리\n\n- **학생 정보 보호**: 학생 ID와 이름만으로 안전하게 로그인\n- **자동 백업**: 모든 시험 결과가 구글 시트에 자동 저장\n- **영구 보관**: 제출한 모든 기록이 데이터베이스에 영구 저장\n- **언제든 조회**: 과거 시험 결과를 언제든 다시 확인 가능\n\n---\n\n## 📞 문의 및 지원\n\n시스템 사용 중 문제가 발생하거나 궁금한 점이 있으면:\n\n**목동에이원과학학원**에 문의해주세요.\n\n---\n\n## 🌟 시스템의 차별점\n\n### 일반 OMR 채점 시스템\n✗ 단순 점수만 확인  \n✗ 오답 확인 어려움  \n✗ 학습 방향성 제시 없음  \n✗ 과거 기록 조회 불가\n\n### 목동에이원 프리미엄내신관리 시스템\n✓ **📱 스마트폰 OMR 스캔 기능** (종이 답안지를 사진 찍으면 자동 인식!)  \n✓ **즉각적인 채점 + 화려한 시각화**  \n✓ **문제별 상세 해설 (정답/오답 비교)**  \n✓ **단원별 약점 분석 + 전체 평균 비교**  \n✓ **영구 보관 + 성장 추적**  \n✓ **부분 제출 + 복수 정답 완벽 지원**  \n✓ **구글 시트 자동 연동**\n\n---\n\n## 💪 학습 극대화 활용 팁\n\n### TIP 1: 약점 집중 공략\n단원별 분석에서 **평균보다 낮은 단원**을 찾아 해당 단원 문제를 반복 학습하세요.\n\n### TIP 2: 반복 학습\n같은 시험을 여러 번 풀어보며 **100점 달성**을 목표로 하세요. 성장 과정이 모두 기록됩니다.\n\n### TIP 3: 학교별 경향 파악\n여러 학교의 기출문제를 풀어보며 **출제 경향**을 파악하세요.\n\n### TIP 4: 꾸준한 기록 확인\n정기적으로 **성적 기록 페이지**를 확인하여 나의 성장을 점검하세요.\n\n### TIP 5: 시험 전 모의고사\n실제 시험 전, 시스템을 활용해 **실전 연습**을 하고 약점을 보완하세요.\n\n---\n\n## 📚 지원하는 데이터 규모\n\n- **학교 수**: 16개교\n- **시험 수**: 26개 시험\n- **문제 수**: 579문항\n- **단원 분류**: 4개 주요 단원\n- **실시간 통계**: 모든 학생 데이터 실시간 집계\n\n---\n\n## 🎉 마치며\n\n**목동에이원과학학원 프리미엄내신관리 시스템**은 단순한 채점 도구가 아닙니다.\n\n학생 여러분의 **학습 효율을 극대화**하고, **약점을 정밀하게 분석**하며, **성장을 시각화**하는 **종합 학습 관리 플랫폼**입니다.\n\n과학적인 데이터 분석과 화려한 시각화를 통해 **학습의 재미**를 느끼고, **목표를 달성**하는 여정에 함께하겠습니다.\n\n**목동에이원과학학원과 함께라면, 내신 관리가 달라집니다.**\n\n---\n\n*본 시스템은 목동에이원과학학원의 교육 철학과 학생 중심 사고를 바탕으로 개발되었습니다.*\n","path":null,"size_bytes":11067,"size_tokens":null},"docs/APP_BLUEPRINT.md":{"content":"# 본과학학원 프리미엄 내신관리 시스템\n\n## 앱 재생성을 위한 완전 가이드\n\n이 문서는 동일한 시스템을 다른 Replit에서 재생성하기 위한 완전한 프롬프트, 아키텍처, 기능 명세서입니다.\n\n---\n\n## 1. Replit Agent 프롬프트 (복사해서 사용)\n\n```\n통합과학 시험 평가 시스템을 만들어주세요.\n\n### 앱 이름\n\"본과학학원 프리미엄 내신관리 시스템\"\n\n### 핵심 기능\n\n1. **학생 로그인**\n   - 학생ID + 이름으로 로그인\n   - 세션 스토리지로 로그인 상태 유지\n\n2. **학교/시험 선택**\n   - 학교 목록 표시 (대일고, 구로고, 한가람고 등)\n   - 학교별 시험 선택 (2024년 2학기 중간 등)\n\n3. **시험 응시**\n   - 객관식 답안 입력 (①②③④⑤ 선택)\n   - 복수 정답 지원 (체크박스)\n   - OMR 카드 촬영 인식 기능\n\n4. **성적 확인**\n   - 전체 점수 표시\n   - 단원별 성취도 분석 (에너지, 화학, 생태계 등)\n   - 차트로 시각화\n   - 학생/교사 피드백 제공\n\n5. **관리자 기능**\n   - 비밀번호: 3721\n   - 학생 목록 조회\n   - 전체 성적 통계\n   - Google Sheets 연동 설정\n\n### 점수 계산 방식 (중요!)\n- 점수 = (맞은 문제 수 / 답한 문제 수) × 100\n- 예: 5문제 중 4문제 맞음 = 80점 (20문제 기준 아님)\n- 응시하지 않은 단원은 성취도에 표시하지 않음\n\n### 기술 스택\n- Frontend: React + TypeScript + Vite + TailwindCSS + shadcn/ui\n- Backend: Express.js + TypeScript\n- Database: PostgreSQL (Drizzle ORM)\n- 차트: Recharts\n- Google Sheets API 연동 (Replit 커넥터 사용)\n\n### Google Sheets 연동\n- 학생 정보 읽기\n- 시험 결과 저장 (시트2: 요약, 시트3: 단원별 상세)\n- 정답 데이터 불러오기\n\n### OMR 인식\n- Python OpenCV 사용\n- 4개 모서리 마커 인식\n- 30문제 5지선다 지원\n\n### 페이지 구성\n1. / - 로그인 페이지\n2. /schools - 학교 선택\n3. /exams/:schoolId - 시험 선택\n4. /test/:examId - 시험 응시\n5. /result - 결과 확인\n6. /reports - 성적 이력\n7. /admin-login - 관리자 로그인\n8. /admin - 관리자 대시보드\n```\n\n---\n\n## 2. 데이터베이스 스키마\n\n### schools 테이블\n| 컬럼 | 타입 | 설명 |\n|------|------|------|\n| id | serial | PK |\n| name | text | 학교명 (unique) |\n\n### exams 테이블\n| 컬럼 | 타입 | 설명 |\n|------|------|------|\n| id | serial | PK |\n| schoolId | integer | FK → schools.id |\n| schoolName | text | 학교명 |\n| year | integer | 연도 |\n| semester | text | \"2학기 중간\", \"2학기 기말\" 등 |\n| subject | text | \"통합과학\" |\n\n### questions 테이블\n| 컬럼 | 타입 | 설명 |\n|------|------|------|\n| id | serial | PK |\n| examId | integer | FK → exams.id |\n| questionNumber | integer | 문제 번호 |\n| type | varchar(20) | \"객관식\" 또는 \"주관식\" |\n| category | text | \"에너지\", \"화학\", \"생태계\" 등 |\n| unit | text | \"전자기 유도\", \"산화-환원\" 등 |\n| answer | text | 정답 (JSON 배열 또는 단일 문자) |\n| isMultipleAnswer | boolean | 복수 정답 여부 |\n\n### students 테이블\n| 컬럼 | 타입 | 설명 |\n|------|------|------|\n| id | serial | PK |\n| studentId | varchar(50) | 학생 ID (unique) |\n| studentName | text | 학생 이름 |\n| grade | text | 학년 |\n| phone | varchar(20) | 전화번호 |\n\n### submissions 테이블\n| 컬럼 | 타입 | 설명 |\n|------|------|------|\n| id | serial | PK |\n| studentId | varchar(50) | 학생 ID |\n| studentName | text | 학생 이름 |\n| examId | integer | FK → exams.id |\n| submittedAt | timestamp | 제출 시간 |\n| answers | text | 학생 답안 (JSON) |\n| score | integer | 점수 |\n| totalQuestions | integer | 전체 문제 수 |\n| answeredQuestions | integer | 답한 문제 수 |\n| correctAnswers | integer | 맞은 문제 수 |\n| achievementRate | integer | 성취율 |\n| unitResults | text | 단원별 결과 (JSON) |\n\n### settings 테이블\n| 컬럼 | 타입 | 설명 |\n|------|------|------|\n| id | serial | PK |\n| key | varchar(100) | 설정 키 (unique) |\n| value | text | 설정 값 |\n| updatedAt | timestamp | 수정 시간 |\n\n---\n\n## 3. Google Sheets 구조\n\n### 시트1: 학생정보\n| A | B | C | D |\n|---|---|---|---|\n| 학생ID | 이름 | 학년 | 전화번호 |\n| h01001 | 김철수 | 고1 | 010-1234-5678 |\n\n### 시트2: 학생별 요약 결과\n| A | B | C | D | E | F | G |\n|---|---|---|---|---|---|---|\n| 학생ID | 이름 | 학교 | 시험 | 점수 | 성취도 | 제출일시 |\n| h01001 | 김철수 | 대일고등학교 | 2024년 2학기 중간 | 85점 | 85% | 2024-11-15 |\n\n### 시트3: 단원별 상세 분석\n| A | B | C | D | E | F | G | H | I |\n|---|---|---|---|---|---|---|---|---|\n| 학생ID | 이름 | 시험 | 단원 | 정답수 | 오답수 | 미응시 | 성취도 | 제출일시 |\n| h01001 | 김철수 | 2024년 2학기 중간 | 전자기 유도 | 3 | 1 | 0 | 75% | 2024-11-15 |\n\n### 기출문제 시트 (정답 데이터)\n| A | B | C | D | E | F | G | H |\n|---|---|---|---|---|---|---|---|\n| 학교 | 연도 | 학기 | 문제번호 | 분류 | 단원 | 정답 | 복수정답 |\n| 대일고등학교 | 2024 | 2학기 중간 | 1 | 에너지 | 전자기 유도 | ③ | FALSE |\n\n---\n\n## 4. API 엔드포인트\n\n### 인증\n- `POST /api/auth/login` - 학생 로그인\n- `POST /api/admin/login` - 관리자 로그인 (비번: 3721)\n\n### 학교/시험\n- `GET /api/schools` - 학교 목록\n- `GET /api/schools/:schoolId/exams` - 학교별 시험\n- `GET /api/exams/:examId` - 시험 정보\n- `GET /api/exams/:examId/questions` - 시험 문제\n\n### 시험 제출\n- `POST /api/test/submit` - 답안 제출\n- `GET /api/submissions/:studentId` - 학생 제출 기록\n\n### 통계\n- `GET /api/exams/:examId/unit-stats` - 단원별 통계\n\n### OMR\n- `POST /api/omr/scan` - OMR 이미지 스캔\n\n### 관리자\n- `GET /api/admin/students` - 학생 목록\n- `GET /api/admin/submissions` - 전체 제출 기록\n- `GET /api/admin/all-results` - Google Sheets 결과 읽기\n- `GET /api/admin/settings/spreadsheet-id` - 스프레드시트 ID 조회\n- `POST /api/admin/settings/spreadsheet-id` - 스프레드시트 ID 설정\n\n### 데이터 동기화\n- `POST /api/init-data` - 초기 데이터 로드\n- `POST /api/upload-to-sheets` - Sheets에 업로드\n- `POST /api/load-from-sheets` - Sheets에서 로드\n\n---\n\n## 5. 통합과학 단원 분류\n\n### 카테고리\n- 에너지\n- 화학\n- 생태계\n- 지구\n- 생명\n- 신소재\n\n### 세부 단원\n| 카테고리 | 단원 |\n|----------|------|\n| 에너지 | 전자기 유도, 발전, 전력 수송, 전력 손실, 에너지 효율 |\n| 화학 | 산화-환원, 산-염기, 원소 주기성, 화학 결합 |\n| 생태계 | 생태계 구성, 생태계 평형, 진화와 변이, 생물 다양성 |\n| 지구 | 지구 시스템, 지권 변동, 지질 시대, 대기 순환 |\n| 생명 | 생명체 구성 물질, 물질대사, 유전 정보 |\n| 신소재 | 반도체, 초전도체, 신소재 |\n\n---\n\n## 6. 점수 계산 로직 (핵심!)\n\n```typescript\n// 전체 점수 계산\nconst answeredQuestions = answers.length; // 답한 문제 수\nconst correctAnswers = /* 맞은 문제 수 */;\nconst score = Math.round((correctAnswers * 100) / answeredQuestions);\n\n// 단원별 성취도 계산\nconst unitAnswered = unit.correct + unit.wrong;\nconst achievementRate = Math.round((unit.correct * 100) / unitAnswered);\n\n// 응시하지 않은 단원 필터링\nconst answeredUnitResults = unitResults.filter(unit => {\n  return (unit.correct + unit.wrong) > 0;\n});\n```\n\n**중요:** 전체 문제 수가 아닌 **답한 문제 수** 기준으로 점수 계산!\n\n---\n\n## 7. OMR 템플릿\n\nOMR 인식을 위해서는 특정 템플릿이 필요합니다:\n- 4개 모서리에 검정 원형 마커 (●)\n- 30문제 × 5지선다 그리드\n- A4 크기 권장\n\n---\n\n## 8. 설정 방법\n\n### 1단계: Replit 프로젝트 생성\n1. Replit에서 새 프로젝트 생성\n2. Template: Node.js 선택\n3. 위의 프롬프트 입력\n\n### 2단계: 데이터베이스 설정\n1. Replit의 PostgreSQL 데이터베이스 생성\n2. 자동으로 DATABASE_URL 환경변수 설정됨\n\n### 3단계: Google Sheets 연동\n1. Replit Connectors에서 Google Sheets 추가\n2. Google 계정 연결\n3. 스프레드시트 ID 입력 (관리자 페이지에서)\n\n### 4단계: 데이터 초기화\n1. 학생 정보를 Google Sheets 시트1에 입력\n2. 기출문제 정답을 기출문제 시트에 입력\n3. 관리자 페이지에서 \"Sheets에서 불러오기\" 클릭\n\n---\n\n## 9. 필요한 패키지\n\n```json\n{\n  \"dependencies\": {\n    \"@tanstack/react-query\": \"^5.x\",\n    \"drizzle-orm\": \"^0.x\",\n    \"express\": \"^4.x\",\n    \"googleapis\": \"^140.x\",\n    \"multer\": \"^1.x\",\n    \"react\": \"^18.x\",\n    \"react-dom\": \"^18.x\",\n    \"recharts\": \"^2.x\",\n    \"wouter\": \"^3.x\",\n    \"zod\": \"^3.x\"\n  }\n}\n```\n\n### Python 패키지 (OMR용)\n```\nopencv-python\nnumpy\npillow\n```\n\n---\n\n## 10. 브랜딩 변경 포인트\n\n\"본과학학원\"으로 변경 시 수정할 파일:\n1. `client/src/pages/login.tsx` - 로고, 학원명\n2. `client/src/pages/result.tsx` - 결과 페이지 헤더\n3. `client/src/pages/admin.tsx` - 관리자 페이지 헤더\n4. `replit.md` - 프로젝트 설명\n\n---\n\n## 11. 주의사항\n\n1. **점수 계산**: 반드시 \"답한 문제 수\" 기준으로 계산\n2. **응시하지 않은 단원**: 성취도에 표시하지 않음\n3. **복수 정답**: JSON 배열 형식으로 저장 (예: [\"③\", \"④\"])\n4. **OMR 인식**: 커스텀 템플릿 필요\n5. **Google Sheets**: 헤더 행 필수\n\n---\n\n이 문서를 사용하여 다른 Replit에서 동일한 시스템을 재생성할 수 있습니다.\n","path":null,"size_bytes":9605,"size_tokens":null},"client/src/pages/unit-test.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useLocation, useParams } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { ChevronLeft, Send, AlertCircle, Camera } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Question } from \"@shared/schema\";\n\nexport default function UnitTestPage() {\n  const { unit } = useParams();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const decodedUnit = unit ? decodeURIComponent(unit) : null;\n  \n  const studentData = sessionStorage.getItem(\"student\");\n  const student = studentData ? JSON.parse(studentData) : null;\n\n  const [answers, setAnswers] = useState<Record<number, string>>({});\n  const [isScanning, setIsScanning] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    if (!student) {\n      setLocation(\"/\");\n    }\n  }, [student, setLocation]);\n\n  const { data: questions, isLoading: questionsLoading } = useQuery<Question[]>({\n    queryKey: [`/api/units/${encodeURIComponent(decodedUnit || \"\")}/questions`],\n    enabled: !!decodedUnit && !!student,\n  });\n\n  const submitMutation = useMutation({\n    mutationFn: async (data: { studentId: string; studentName: string; unitName: string; answers: { questionNumber: number; answer: string }[] }) => {\n      return await apiRequest(\"POST\", \"/api/unit-tests/submit\", data);\n    },\n    onSuccess: (result: any) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/submissions\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/questions/counts\"] });\n      sessionStorage.setItem(\"testResult\", JSON.stringify(result));\n      setLocation(\"/result\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"제출 실패\",\n        description: error.message || \"과제 제출 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const multipleChoiceQuestions = questions?.filter(q => q.type === \"객관식\") || [];\n  const answeredCount = Object.keys(answers).length;\n  const totalQuestions = multipleChoiceQuestions.length;\n  const progress = totalQuestions > 0 ? (answeredCount / totalQuestions) * 100 : 0;\n\n  const handleAnswer = (questionNumber: number, option: string) => {\n    const currentAnswer = answers[questionNumber] || \"\";\n    const answerList = currentAnswer ? currentAnswer.split(',').map(a => a.trim()) : [];\n    const optionIndex = answerList.indexOf(option);\n    \n    if (optionIndex >= 0) {\n      answerList.splice(optionIndex, 1);\n    } else {\n      answerList.push(option);\n    }\n    \n    if (answerList.length > 0) {\n      setAnswers(prev => ({ ...prev, [questionNumber]: answerList.join(',') }));\n    } else {\n      const { [questionNumber]: _, ...rest } = answers;\n      setAnswers(rest);\n    }\n  };\n\n  const isOptionSelected = (questionNumber: number, option: string) => {\n    const currentAnswer = answers[questionNumber] || \"\";\n    const answerList = currentAnswer.split(',').map(a => a.trim());\n    return answerList.includes(option);\n  };\n\n  const handleOMRScan = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    if (file.size > 10 * 1024 * 1024) {\n      toast({\n        title: \"파일 크기 초과\",\n        description: \"10MB 이하의 이미지만 업로드 가능합니다.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsScanning(true);\n\n    try {\n      const formData = new FormData();\n      formData.append(\"image\", file);\n      if (decodedUnit) {\n        formData.append(\"unitName\", decodedUnit);\n      }\n\n      const response = await fetch(\"/api/omr/scan\", {\n        method: \"POST\",\n        body: formData,\n      });\n\n      const result = await response.json();\n\n      if (!result.success) {\n        throw new Error(result.message || \"OMR 스캔에 실패했습니다\");\n      }\n\n      const convertToCircledNumber = (num: string): string => {\n        const map: Record<string, string> = { \"1\": \"①\", \"2\": \"②\", \"3\": \"③\", \"4\": \"④\", \"5\": \"⑤\" };\n        return map[num] || num;\n      };\n\n      const scannedAnswers: Record<number, string> = {};\n      result.answers.forEach((answer: { questionNumber: number; answer: string }) => {\n        const convertedAnswer = answer.answer\n          .split(',')\n          .map(a => convertToCircledNumber(a.trim()))\n          .join(',');\n        scannedAnswers[answer.questionNumber] = convertedAnswer;\n      });\n\n      setAnswers(prev => ({ ...prev, ...scannedAnswers }));\n\n      toast({\n        title: \"OMR 스캔 완료\",\n        description: result.message || `${Object.keys(scannedAnswers).length}개 답안이 인식되었습니다`,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"OMR 스캔 실패\",\n        description: error.message || \"이미지 처리 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsScanning(false);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = \"\";\n      }\n    }\n  };\n\n  const handleSubmit = () => {\n    if (answeredCount === 0) {\n      toast({\n        title: \"답안 없음\",\n        description: \"최소 1개 이상의 문제에 답해주세요.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const submitData = {\n      studentId: student.studentId,\n      studentName: student.studentName,\n      unitName: decodedUnit!,\n      answers: Object.entries(answers).map(([questionNumber, answer]) => ({\n        questionNumber: parseInt(questionNumber),\n        answer,\n      })),\n    };\n\n    submitMutation.mutate(submitData);\n  };\n\n  if (!student || !decodedUnit) {\n    return null;\n  }\n\n  if (questionsLoading) {\n    return (\n      <div className=\"min-h-screen bg-background p-4\">\n        <div className=\"container mx-auto max-w-6xl space-y-6\">\n          <Skeleton className=\"h-16 w-full\" />\n          <Skeleton className=\"h-96 w-full\" />\n        </div>\n      </div>\n    );\n  }\n\n  if (multipleChoiceQuestions.length === 0) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n        <Card className=\"max-w-md\">\n          <CardContent className=\"pt-6 text-center space-y-4\">\n            <p>문제를 불러올 수 없습니다.</p>\n            <Button onClick={() => setLocation(\"/units\")}>단원 선택으로 돌아가기</Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"sticky top-0 z-50 border-b bg-card/95 backdrop-blur\">\n        <div className=\"container mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"flex items-center gap-3\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setLocation(\"/units\")}\n                data-testid=\"button-back\"\n              >\n                <ChevronLeft className=\"w-4 h-4 mr-2\" />\n                단원 선택\n              </Button>\n              <div>\n                <h1 className=\"text-sm font-bold\">목동에이원과학학원</h1>\n                <p className=\"text-xs font-semibold text-primary\">프리미엄 학습관리 시스템</p>\n              </div>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Badge variant=\"outline\" className=\"font-mono\">\n                {student.studentName}\n              </Badge>\n            </div>\n          </div>\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center justify-between text-sm\">\n              <span className=\"font-medium\">{decodedUnit}</span>\n              <span className=\"text-muted-foreground font-mono\">\n                {answeredCount} / {totalQuestions}\n              </span>\n            </div>\n            <Progress value={progress} className=\"h-2\" />\n          </div>\n        </div>\n      </header>\n\n      <main className=\"container mx-auto px-4 py-8\">\n        <div className=\"max-w-5xl mx-auto space-y-8\">\n          <Card className=\"bg-amber-50 dark:bg-amber-950/20 border-amber-200 dark:border-amber-800\">\n            <CardContent className=\"p-4 flex items-start gap-3\">\n              <AlertCircle className=\"w-5 h-5 text-amber-600 dark:text-amber-500 mt-0.5\" />\n              <div className=\"text-sm text-amber-900 dark:text-amber-100\">\n                <p className=\"font-medium mb-1\">부분 제출 가능</p>\n                <p className=\"text-amber-800 dark:text-amber-200\">\n                  모든 문제를 풀지 않아도 제출할 수 있습니다. 답하지 않은 문제는 0점 처리됩니다.\n                  복수 정답 문제는 여러 개를 선택할 수 있습니다.\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"shadow-lg\">\n            <CardContent className=\"p-8\">\n              <div className=\"text-center space-y-4 mb-8\">\n                <h1 className=\"text-3xl font-bold\">OMR 답안지</h1>\n                <p className=\"text-muted-foreground\">\n                  객관식 문제의 정답을 선택하세요\n                </p>\n                \n                <div className=\"flex flex-col sm:flex-row items-center justify-center gap-3 pt-2\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleOMRScan}\n                    className=\"hidden\"\n                    data-testid=\"input-omr-file\"\n                  />\n                  <Button\n                    variant=\"outline\"\n                    size=\"default\"\n                    onClick={() => fileInputRef.current?.click()}\n                    disabled={isScanning}\n                    className=\"gap-2\"\n                    data-testid=\"button-omr-scan\"\n                  >\n                    {isScanning ? (\n                      <>\n                        <div className=\"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\n                        처리 중...\n                      </>\n                    ) : (\n                      <>\n                        <Camera className=\"w-4 h-4\" />\n                        OMR 사진 찍기\n                      </>\n                    )}\n                  </Button>\n                  <p className=\"text-xs text-muted-foreground\">\n                    종이 답안지를 사진으로 찍어 자동으로 입력하세요\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"space-y-6\">\n                {multipleChoiceQuestions.map((question) => (\n                  <div\n                    key={question.questionNumber}\n                    className=\"flex items-center gap-4 py-3 border-b last:border-b-0\"\n                    data-testid={`question-row-${question.questionNumber}`}\n                  >\n                    <div className=\"w-12 text-center font-mono font-bold text-lg text-muted-foreground\">\n                      {question.questionNumber}\n                    </div>\n                    <div className=\"flex gap-2 flex-wrap\">\n                      {[\"①\", \"②\", \"③\", \"④\", \"⑤\"].map((option, idx) => (\n                        <Button\n                          key={option}\n                          variant={isOptionSelected(question.questionNumber, option) ? \"default\" : \"outline\"}\n                          size=\"sm\"\n                          className={`w-10 h-10 rounded-full font-bold text-lg ${\n                            isOptionSelected(question.questionNumber, option)\n                              ? \"\"\n                              : \"hover:bg-primary/10\"\n                          }`}\n                          onClick={() => handleAnswer(question.questionNumber, option)}\n                          data-testid={`button-answer-${question.questionNumber}-${idx + 1}`}\n                        >\n                          {option}\n                        </Button>\n                      ))}\n                    </div>\n                    {question.isMultipleAnswer && (\n                      <Badge variant=\"secondary\" className=\"text-xs\">\n                        복수정답\n                      </Badge>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          <div className=\"flex justify-center pt-4\">\n            <Button\n              size=\"lg\"\n              onClick={handleSubmit}\n              disabled={submitMutation.isPending}\n              className=\"gap-2 px-8\"\n              data-testid=\"button-submit\"\n            >\n              {submitMutation.isPending ? (\n                <>\n                  <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                  제출 중...\n                </>\n              ) : (\n                <>\n                  <Send className=\"w-4 h-4\" />\n                  과제 제출하기\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":13559,"size_tokens":null}},"version":2}